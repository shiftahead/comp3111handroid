<HTML><HEAD><META CONTENT="text/html; charset=UTF-8" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Sun May 04 22:10:52 HKT 2014)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="5.html">com.facebook</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">Session.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>Session.java</TD><TD CLASS="h">11%  (2/19)</TD><TD CLASS="h">8%   (14/170)</TD><TD CLASS="h">8%   (230/2984)</TD><TD CLASS="h">9%   (60.8/693)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">Session$2</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#0">Session$2 (Session): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">onCompleted (AuthorizationClient$Result): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3">Session$3</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/51)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#3">Session$3 (Session, SessionState, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/39)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#6">Session$3$1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#6">Session$3$1 (Session$3, Session$StatusCallback): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/13)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#9">Session$4</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/54)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#9">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/54)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#b">Session$AuthorizationRequest</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/33)</TD><TD CLASS="h">0%   (0/285)</TD><TD CLASS="h">0%   (0/59)</TD></TR><TR><TD CLASS="f"><A HREF="#c">Session$AuthorizationRequest (Activity): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#d">Session$AuthorizationRequest (Fragment): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#e">Session$AuthorizationRequest (SessionLoginBehavior, int, List, String, boolea...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/55)</TD><TD CLASS="h">0%   (0/17)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b">Session$AuthorizationRequest (SessionLoginBehavior, int, List, String, boolea...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b">access$100 (Session$AuthorizationRequest): Map</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b">access$1500 (Session$AuthorizationRequest): Session$StartActivityDelegate</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b">access$200 (Session$AuthorizationRequest): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b">access$300 (Session$AuthorizationRequest): SessionLoginBehavior</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b">access$400 (Session$AuthorizationRequest): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b">access$500 (Session$AuthorizationRequest): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b">access$600 (Session$AuthorizationRequest): SessionDefaultAudience</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#17">getApplicationId (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#18">getAuthId (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#19">getAuthorizationClientRequest (): AuthorizationClient$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#1a">getCallback (): Session$StatusCallback</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1b">getDefaultAudience (): SessionDefaultAudience</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1c">getLoginBehavior (): SessionLoginBehavior</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1d">getPermissions (): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1e">getRequestCode (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1f">getStartActivityDelegate (): Session$StartActivityDelegate</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#20">getValidateSameFbidAsToken (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#21">isLegacy (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#22">readObject (ObjectInputStream): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#23">setApplicationId (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#24">setCallback (Session$StatusCallback): Session$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#25">setDefaultAudience (SessionDefaultAudience): Session$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#26">setIsLegacy (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#27">setLoginBehavior (SessionLoginBehavior): Session$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#28">setPermissions (List): Session$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#29">setPermissions (String []): Session$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#2a">setRequestCode (int): Session$AuthorizationRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2b">setValidateSameFbidAsToken (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#2c">writeReplace (): Object</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#2d">Session$AuthorizationRequest$1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#2d">Session$AuthorizationRequest$1 (Session$AuthorizationRequest, Activity): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2f">getActivityContext (): Activity</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#30">startActivityForResult (Intent, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#31">Session$AuthorizationRequest$2</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/19)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#31">Session$AuthorizationRequest$2 (Session$AuthorizationRequest, Fragment): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#33">getActivityContext (): Activity</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#34">startActivityForResult (Intent, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#35">Session$AuthorizationRequest$3</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#35">Session$AuthorizationRequest$3 (Session$AuthorizationRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#37">getActivityContext (): Activity</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#38">startActivityForResult (Intent, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#19">Session$AuthorizationRequest$4</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#19">Session$AuthorizationRequest$4 (Session$AuthorizationRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3b">getActivityContext (): Activity</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#3c">startActivityForResult (Intent, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3d">Session$AuthorizationRequest$AuthRequestSerializationProxyV1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/53)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR><TD CLASS="f"><A HREF="#3e">Session$AuthorizationRequest$AuthRequestSerializationProxyV1 (SessionLoginBeh...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/24)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3d">Session$AuthorizationRequest$AuthRequestSerializationProxyV1 (SessionLoginBeh...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#40">readResolve (): Object</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/19)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#41">Session$AutoPublishAsyncTask</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/46)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#41">Session$AutoPublishAsyncTask (Session, String, Context): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/13)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#43">doInBackground (Void []): Void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="f"><A HREF="#44">onPostExecute (Void): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/19)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#45">Session$Builder</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#45">Session$Builder (Context): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#47">build (): Session</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#48">setApplicationId (String): Session$Builder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#49">setTokenCachingStrategy (TokenCachingStrategy): Session$Builder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#4a">Session$NewPermissionsRequest</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/56)</TD><TD CLASS="h">0%   (0/20)</TD></TR><TR><TD CLASS="f"><A HREF="#4a">Session$NewPermissionsRequest (Activity, List): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4c">Session$NewPermissionsRequest (Activity, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#4d">Session$NewPermissionsRequest (Fragment, List): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4e">Session$NewPermissionsRequest (Fragment, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#4f">setCallback (Session$StatusCallback): Session$NewPermissionsRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#50">setDefaultAudience (SessionDefaultAudience): Session$NewPermissionsRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#51">setLoginBehavior (SessionLoginBehavior): Session$NewPermissionsRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#52">setRequestCode (int): Session$NewPermissionsRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#53">Session$OpenRequest</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/44)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR><TD CLASS="f"><A HREF="#53">Session$OpenRequest (Activity): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#55">Session$OpenRequest (Fragment): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#56">setCallback (Session$StatusCallback): Session$OpenRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#57">setDefaultAudience (SessionDefaultAudience): Session$OpenRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#58">setLoginBehavior (SessionLoginBehavior): Session$OpenRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#59">setPermissions (List): Session$OpenRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#5a">setPermissions (String []): Session$OpenRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5b">setRequestCode (int): Session$OpenRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#5c">Session$SerializationProxyV1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/38)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#5c">Session$SerializationProxyV1 (String, SessionState, AccessToken, Date, boolea...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5e">readResolve (): Object</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#5f">Session$TokenRefreshRequest</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/99)</TD><TD CLASS="h">0%   (0/27)</TD></TR><TR><TD CLASS="f"><A HREF="#5f">Session$TokenRefreshRequest (Session): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5f">access$1300 (Session$TokenRefreshRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#62">bind (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#63">cleanup (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#64">onServiceConnected (ComponentName, IBinder): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#65">onServiceDisconnected (ComponentName): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#66">refreshToken (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/29)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#67">Session$TokenRefreshRequestHandler</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/47)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#67">Session$TokenRefreshRequestHandler (Session, Session$TokenRefreshRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#69">handleMessage (Message): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/31)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#6a">Session</A></TD><TD>100% (1/1)</TD><TD CLASS="h">16%  (13/80)</TD><TD CLASS="h">10%  (215/2056)</TD><TD CLASS="h">12%  (56.8/488)</TD></TR><TR><TD CLASS="f"><A HREF="#6b">Session (Context, String, TokenCachingStrategy): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6c">Session (String, SessionState, AccessToken, Date, boolean, Session$Authorizat...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/46)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#6a">Session (String, SessionState, AccessToken, Date, boolean, Session$Authorizat...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6a">access$1000 (Handler, Runnable): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#6a">access$1100 (): Context</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6a">access$1200 (Session): Session$TokenRefreshRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#6a">access$1202 (Session, Session$TokenRefreshRequest): Session$TokenRefreshRequest</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6a">access$1402 (Session, Session$AutoPublishAsyncTask): Session$AutoPublishAsync...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#6a">access$700 (Session, int, AuthorizationClient$Result): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6a">access$800 (Session): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#6a">access$900 (Session): Handler</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#76">areEqual (Object, Object): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#77">authorize (Session$AuthorizationRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/89)</TD><TD CLASS="h">0%   (0/21)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#78">autoPublishAsync (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/42)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#79">close (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/46)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7a">closeAndClearTokenInformation (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/13)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#7b">equals (Object): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/36)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7c">extendAccessToken (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/31)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#7d">extendAccessTokenIfNeeded (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7e">extendTokenCompleted (Bundle): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/64)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#7f">finishAuthOrReauth (AccessToken, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/54)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#80">finishAuthorization (AccessToken, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/30)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#81">finishReauthorization (AccessToken, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/24)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#82">getAccessToken (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#83">getAppEventsLogger (): AppEventsLogger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/24)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#84">getApplicationId (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#85">getAuthorizationBundle (): Bundle</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#86">getExpirationDate (): Date</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#87">getLastAttemptedTokenExtendDate (): Date</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#88">getLoginActivityIntent (Session$AuthorizationRequest): Intent</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/27)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#89">getPermissions (): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8a">getTokenInfo (): AccessToken</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#8b">handleAuthorizationResult (int, AuthorizationClient$Result): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/45)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8c">hashCode (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#8d">isPublishPermission (String): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8e">logAuthorizationComplete (AuthorizationClient$Result$Code, Map, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/104)</TD><TD CLASS="h">0%   (0/27)</TD></TR><TR><TD CLASS="f"><A HREF="#8f">logAuthorizationStart (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/68)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#90">onActivityResult (Activity, int, int, Intent): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/89)</TD><TD CLASS="h">0%   (0/24)</TD></TR><TR><TD CLASS="f"><A HREF="#91">open (AccessToken, Session$StatusCallback): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/74)</TD><TD CLASS="h">0%   (0/18)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#92">open (Session$OpenRequest, SessionAuthorizationType): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/114)</TD><TD CLASS="h">0%   (0/28)</TD></TR><TR><TD CLASS="f"><A HREF="#93">openActiveSession (Activity, boolean, Session$StatusCallback): Session</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#94">openActiveSession (Context, Fragment, boolean, Session$StatusCallback): Session</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#95">openActiveSession (Context, boolean, Session$OpenRequest): Session</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#96">openActiveSessionFromCache (Context): Session</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#97">openActiveSessionWithAccessToken (Context, AccessToken, Session$StatusCallbac...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#98">openForPublish (Session$OpenRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#99">openForRead (Session$OpenRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9a">postStateChange (SessionState, SessionState, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/44)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR><TD CLASS="f"><A HREF="#9b">readObject (ObjectInputStream): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9c">requestNewPermissions (Session$NewPermissionsRequest, SessionAuthorizationTyp...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/64)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR><TD CLASS="f"><A HREF="#9d">requestNewPublishPermissions (Session$NewPermissionsRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9e">requestNewReadPermissions (Session$NewPermissionsRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#9f">resolveIntent (Intent): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a0">restoreSession (Context, TokenCachingStrategy, Session$StatusCallback, Bundle...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/63)</TD><TD CLASS="h">0%   (0/20)</TD></TR><TR><TD CLASS="f"><A HREF="#a1">runWithHandlerOrExecutor (Handler, Runnable): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a2">saveSession (Session, Bundle): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/37)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#a3">saveTokenToCache (AccessToken): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a4">setCurrentTokenRefreshRequest (Session$TokenRefreshRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#a5">setLastAttemptedTokenExtendDate (Date): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a6">setTokenInfo (AccessToken): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#a7">shouldExtendAccessToken (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/43)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a8">toString (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#a9">tryLegacyAuth (Session$AuthorizationRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#aa">tryLoginActivity (Session$AuthorizationRequest): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#ab">validateLoginBehavior (Session$AuthorizationRequest): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/37)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ac">validatePermissions (Session$AuthorizationRequest, SessionAuthorizationType):...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/63)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR><TD CLASS="f"><A HREF="#ad">writeReplace (): Object</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ae">getActiveSession (): Session</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">62%  (8/13)</TD><TD CLASS="h">67%  (2/3)</TD></TR><TR><TD CLASS="f"><A HREF="#af">getState (): SessionState</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">67%  (10/15)</TD><TD CLASS="h">67%  (2/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b0">isClosed (): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">69%  (11/16)</TD><TD CLASS="h">67%  (2/3)</TD></TR><TR><TD CLASS="f"><A HREF="#b1">isOpened (): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">69%  (11/16)</TD><TD CLASS="h">67%  (2/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b2">Session (Context, String, TokenCachingStrategy, boolean): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">70%  (69/99)</TD><TD CLASS="h">70%  (19/27)</TD></TR><TR><TD CLASS="f"><A HREF="#b3">setActiveSession (Session): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">70%  (26/37)</TD><TD CLASS="h">74%  (10.4/14)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b4">removeCallback (Session$StatusCallback): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">74%  (14/19)</TD><TD>93%  (3.7/4)</TD></TR><TR><TD CLASS="f"><A HREF="#b5">addCallback (Session$StatusCallback): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>81%  (21/26)</TD><TD>87%  (4.4/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b6">initializeStaticContext (Context): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>93%  (13/14)</TD><TD>97%  (3.9/4)</TD></TR><TR><TD CLASS="f"><A HREF="#b7">&lt;static initializer&gt;</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (12/12)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b8">Session (Context): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (7/7)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#b9">getStaticContext (): Context</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ba">postActiveSessionAction (String): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (11/11)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#bb">Session$1</A></TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD><TD>100% (15/15)</TD><TD>100% (5/5)</TD></TR><TR><TD CLASS="f"><A HREF="#bb">Session$1 (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (15/15)</TD><TD>100% (5/5)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>/**</TD></TR><TR><TD CLASS="l">2</TD><TD> * Copyright 2010-present Facebook.</TD></TR><TR><TD CLASS="l">3</TD><TD> *</TD></TR><TR><TD CLASS="l">4</TD><TD> * Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);</TD></TR><TR><TD CLASS="l">5</TD><TD> * you may not use this file except in compliance with the License.</TD></TR><TR><TD CLASS="l">6</TD><TD> * You may obtain a copy of the License at</TD></TR><TR><TD CLASS="l">7</TD><TD> *</TD></TR><TR><TD CLASS="l">8</TD><TD> *    http://www.apache.org/licenses/LICENSE-2.0</TD></TR><TR><TD CLASS="l">9</TD><TD> *</TD></TR><TR><TD CLASS="l">10</TD><TD> * Unless required by applicable law or agreed to in writing, software</TD></TR><TR><TD CLASS="l">11</TD><TD> * distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</TD></TR><TR><TD CLASS="l">12</TD><TD> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</TD></TR><TR><TD CLASS="l">13</TD><TD> * See the License for the specific language governing permissions and</TD></TR><TR><TD CLASS="l">14</TD><TD> * limitations under the License.</TD></TR><TR><TD CLASS="l">15</TD><TD> */</TD></TR><TR><TD CLASS="l">16</TD><TD> </TD></TR><TR><TD CLASS="l">17</TD><TD>package com.facebook;</TD></TR><TR><TD CLASS="l">18</TD><TD> </TD></TR><TR><TD CLASS="l">19</TD><TD>import android.app.Activity;</TD></TR><TR><TD CLASS="l">20</TD><TD>import android.content.*;</TD></TR><TR><TD CLASS="l">21</TD><TD>import android.content.pm.ResolveInfo;</TD></TR><TR><TD CLASS="l">22</TD><TD>import android.os.*;</TD></TR><TR><TD CLASS="l">23</TD><TD>import android.support.v4.app.Fragment;</TD></TR><TR><TD CLASS="l">24</TD><TD>import android.support.v4.content.LocalBroadcastManager;</TD></TR><TR><TD CLASS="l">25</TD><TD>import android.text.TextUtils;</TD></TR><TR><TD CLASS="l">26</TD><TD>import android.util.Log;</TD></TR><TR><TD CLASS="l">27</TD><TD>import com.facebook.internal.*;</TD></TR><TR><TD CLASS="l">28</TD><TD>import org.json.JSONException;</TD></TR><TR><TD CLASS="l">29</TD><TD>import org.json.JSONObject;</TD></TR><TR><TD CLASS="l">30</TD><TD> </TD></TR><TR><TD CLASS="l">31</TD><TD>import java.io.*;</TD></TR><TR><TD CLASS="l">32</TD><TD>import java.lang.ref.WeakReference;</TD></TR><TR><TD CLASS="l">33</TD><TD>import java.util.*;</TD></TR><TR><TD CLASS="l">34</TD><TD> </TD></TR><TR><TD CLASS="l">35</TD><TD>/**</TD></TR><TR><TD CLASS="l">36</TD><TD> * &lt;p&gt;</TD></TR><TR><TD CLASS="l">37</TD><TD> * Session is used to authenticate a user and manage the user's session with</TD></TR><TR><TD CLASS="l">38</TD><TD> * Facebook.</TD></TR><TR><TD CLASS="l">39</TD><TD> * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">40</TD><TD> * &lt;p&gt;</TD></TR><TR><TD CLASS="l">41</TD><TD> * Sessions must be opened before they can be used to make a Request. When a</TD></TR><TR><TD CLASS="l">42</TD><TD> * Session is created, it attempts to initialize itself from a TokenCachingStrategy.</TD></TR><TR><TD CLASS="l">43</TD><TD> * Closing the session can optionally clear this cache.  The Session lifecycle</TD></TR><TR><TD CLASS="l">44</TD><TD> * uses {@link SessionState SessionState} to indicate its state. Once a Session has</TD></TR><TR><TD CLASS="l">45</TD><TD> * been closed, it can't be re-opened; a new Session must be created.</TD></TR><TR><TD CLASS="l">46</TD><TD> * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">47</TD><TD> * &lt;p&gt;</TD></TR><TR><TD CLASS="l"><A NAME="6a">48</A></TD><TD> * Instances of Session provide state change notification via a callback</TD></TR><TR><TD CLASS="l">49</TD><TD> * interface, {@link Session.StatusCallback StatusCallback}.</TD></TR><TR><TD CLASS="l">50</TD><TD> * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">51</TD><TD> */</TD></TR><TR CLASS="z"><TD CLASS="l">52</TD><TD>public class Session implements Serializable {</TD></TR><TR><TD CLASS="l">53</TD><TD>    private static final long serialVersionUID = 1L;</TD></TR><TR><TD CLASS="l"><A NAME="b7">54</A></TD><TD> </TD></TR><TR><TD CLASS="l">55</TD><TD>    /**</TD></TR><TR><TD CLASS="l">56</TD><TD>     * The logging tag used by Session.</TD></TR><TR><TD CLASS="l">57</TD><TD>     */</TD></TR><TR CLASS="c"><TD CLASS="l">58</TD><TD>    public static final String TAG = Session.class.getCanonicalName();</TD></TR><TR><TD CLASS="l">59</TD><TD> </TD></TR><TR><TD CLASS="l">60</TD><TD>    /**</TD></TR><TR><TD CLASS="l">61</TD><TD>     * The default activity code used for authorization.</TD></TR><TR><TD CLASS="l">62</TD><TD>     *</TD></TR><TR><TD CLASS="l">63</TD><TD>     * @see #openForRead(OpenRequest)</TD></TR><TR><TD CLASS="l">64</TD><TD>     *      open</TD></TR><TR><TD CLASS="l">65</TD><TD>     */</TD></TR><TR><TD CLASS="l">66</TD><TD>    public static final int DEFAULT_AUTHORIZE_ACTIVITY_CODE = 0xface;</TD></TR><TR><TD CLASS="l">67</TD><TD> </TD></TR><TR><TD CLASS="l">68</TD><TD>    /**</TD></TR><TR><TD CLASS="l">69</TD><TD>     * If Session authorization fails and provides a web view error code, the</TD></TR><TR><TD CLASS="l">70</TD><TD>     * web view error code is stored in the Bundle returned from</TD></TR><TR><TD CLASS="l">71</TD><TD>     * {@link #getAuthorizationBundle getAuthorizationBundle} under this key.</TD></TR><TR><TD CLASS="l">72</TD><TD>     */</TD></TR><TR><TD CLASS="l">73</TD><TD>    public static final String WEB_VIEW_ERROR_CODE_KEY = &#34;com.facebook.sdk.WebViewErrorCode&#34;;</TD></TR><TR><TD CLASS="l">74</TD><TD> </TD></TR><TR><TD CLASS="l">75</TD><TD>    /**</TD></TR><TR><TD CLASS="l">76</TD><TD>     * If Session authorization fails and provides a failing url, the failing</TD></TR><TR><TD CLASS="l">77</TD><TD>     * url is stored in the Bundle returned from {@link #getAuthorizationBundle</TD></TR><TR><TD CLASS="l">78</TD><TD>     * getAuthorizationBundle} under this key.</TD></TR><TR><TD CLASS="l">79</TD><TD>     */</TD></TR><TR><TD CLASS="l">80</TD><TD>    public static final String WEB_VIEW_FAILING_URL_KEY = &#34;com.facebook.sdk.FailingUrl&#34;;</TD></TR><TR><TD CLASS="l">81</TD><TD> </TD></TR><TR><TD CLASS="l">82</TD><TD>    /**</TD></TR><TR><TD CLASS="l">83</TD><TD>     * The action used to indicate that the active session has been set. This should</TD></TR><TR><TD CLASS="l">84</TD><TD>     * be used as an action in an IntentFilter and BroadcastReceiver registered with</TD></TR><TR><TD CLASS="l">85</TD><TD>     * the {@link android.support.v4.content.LocalBroadcastManager}.</TD></TR><TR><TD CLASS="l">86</TD><TD>     */</TD></TR><TR><TD CLASS="l">87</TD><TD>    public static final String ACTION_ACTIVE_SESSION_SET = &#34;com.facebook.sdk.ACTIVE_SESSION_SET&#34;;</TD></TR><TR><TD CLASS="l">88</TD><TD> </TD></TR><TR><TD CLASS="l">89</TD><TD>    /**</TD></TR><TR><TD CLASS="l">90</TD><TD>     * The action used to indicate that the active session has been set to null. This should</TD></TR><TR><TD CLASS="l">91</TD><TD>     * be used as an action in an IntentFilter and BroadcastReceiver registered with</TD></TR><TR><TD CLASS="l">92</TD><TD>     * the {@link android.support.v4.content.LocalBroadcastManager}.</TD></TR><TR><TD CLASS="l">93</TD><TD>     */</TD></TR><TR><TD CLASS="l">94</TD><TD>    public static final String ACTION_ACTIVE_SESSION_UNSET = &#34;com.facebook.sdk.ACTIVE_SESSION_UNSET&#34;;</TD></TR><TR><TD CLASS="l">95</TD><TD> </TD></TR><TR><TD CLASS="l">96</TD><TD>    /**</TD></TR><TR><TD CLASS="l">97</TD><TD>     * The action used to indicate that the active session has been opened. This should</TD></TR><TR><TD CLASS="l">98</TD><TD>     * be used as an action in an IntentFilter and BroadcastReceiver registered with</TD></TR><TR><TD CLASS="l">99</TD><TD>     * the {@link android.support.v4.content.LocalBroadcastManager}.</TD></TR><TR><TD CLASS="l">100</TD><TD>     */</TD></TR><TR><TD CLASS="l">101</TD><TD>    public static final String ACTION_ACTIVE_SESSION_OPENED = &#34;com.facebook.sdk.ACTIVE_SESSION_OPENED&#34;;</TD></TR><TR><TD CLASS="l">102</TD><TD> </TD></TR><TR><TD CLASS="l">103</TD><TD>    /**</TD></TR><TR><TD CLASS="l">104</TD><TD>     * The action used to indicate that the active session has been closed. This should</TD></TR><TR><TD CLASS="l">105</TD><TD>     * be used as an action in an IntentFilter and BroadcastReceiver registered with</TD></TR><TR><TD CLASS="l">106</TD><TD>     * the {@link android.support.v4.content.LocalBroadcastManager}.</TD></TR><TR><TD CLASS="l">107</TD><TD>     */</TD></TR><TR><TD CLASS="l">108</TD><TD>    public static final String ACTION_ACTIVE_SESSION_CLOSED = &#34;com.facebook.sdk.ACTIVE_SESSION_CLOSED&#34;;</TD></TR><TR><TD CLASS="l">109</TD><TD> </TD></TR><TR><TD CLASS="l">110</TD><TD>    /**</TD></TR><TR><TD CLASS="l">111</TD><TD>     * Session takes application id as a constructor parameter. If this is null,</TD></TR><TR><TD CLASS="l">112</TD><TD>     * Session will attempt to load the application id from</TD></TR><TR><TD CLASS="l">113</TD><TD>     * application/meta-data using this String as the key.</TD></TR><TR><TD CLASS="l">114</TD><TD>     */</TD></TR><TR><TD CLASS="l">115</TD><TD>    public static final String APPLICATION_ID_PROPERTY = &#34;com.facebook.sdk.ApplicationId&#34;;</TD></TR><TR><TD CLASS="l">116</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">117</TD><TD>    private static final Object STATIC_LOCK = new Object();</TD></TR><TR><TD CLASS="l">118</TD><TD>    private static Session activeSession;</TD></TR><TR><TD CLASS="l">119</TD><TD>    private static volatile Context staticContext;</TD></TR><TR><TD CLASS="l">120</TD><TD> </TD></TR><TR><TD CLASS="l">121</TD><TD>    // Token extension constants</TD></TR><TR><TD CLASS="l">122</TD><TD>    private static final int TOKEN_EXTEND_THRESHOLD_SECONDS = 24 * 60 * 60; // 1</TD></TR><TR><TD CLASS="l">123</TD><TD>    // day</TD></TR><TR><TD CLASS="l">124</TD><TD>    private static final int TOKEN_EXTEND_RETRY_SECONDS = 60 * 60; // 1 hour</TD></TR><TR><TD CLASS="l">125</TD><TD> </TD></TR><TR><TD CLASS="l">126</TD><TD>    private static final String SESSION_BUNDLE_SAVE_KEY = &#34;com.facebook.sdk.Session.saveSessionKey&#34;;</TD></TR><TR><TD CLASS="l">127</TD><TD>    private static final String AUTH_BUNDLE_SAVE_KEY = &#34;com.facebook.sdk.Session.authBundleKey&#34;;</TD></TR><TR><TD CLASS="l"><A NAME="bb">128</A></TD><TD>    private static final String PUBLISH_PERMISSION_PREFIX = &#34;publish&#34;;</TD></TR><TR><TD CLASS="l">129</TD><TD>    private static final String MANAGE_PERMISSION_PREFIX = &#34;manage&#34;;</TD></TR><TR><TD CLASS="l">130</TD><TD> </TD></TR><TR><TD CLASS="l">131</TD><TD>    @SuppressWarnings(&#34;serial&#34;)</TD></TR><TR CLASS="c"><TD CLASS="l">132</TD><TD>    private static final Set&lt;String&gt; OTHER_PUBLISH_PERMISSIONS = new HashSet&lt;String&gt;() {{</TD></TR><TR CLASS="c"><TD CLASS="l">133</TD><TD>        add(&#34;ads_management&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">134</TD><TD>        add(&#34;create_event&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">135</TD><TD>        add(&#34;rsvp_event&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">136</TD><TD>    }};</TD></TR><TR><TD CLASS="l">137</TD><TD> </TD></TR><TR><TD CLASS="l">138</TD><TD>    private String applicationId;</TD></TR><TR><TD CLASS="l">139</TD><TD>    private SessionState state;</TD></TR><TR><TD CLASS="l">140</TD><TD>    private AccessToken tokenInfo;</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="25% line coverage (15 out of 61 instructions)">141</TD><TD TITLE="25% line coverage (15 out of 61 instructions)">    private Date lastAttemptedTokenExtendDate = new Date(0);</TD></TR><TR><TD CLASS="l">142</TD><TD> </TD></TR><TR><TD CLASS="l">143</TD><TD>    private AuthorizationRequest pendingAuthorizationRequest;</TD></TR><TR><TD CLASS="l">144</TD><TD>    private AuthorizationClient authorizationClient;</TD></TR><TR><TD CLASS="l">145</TD><TD> </TD></TR><TR><TD CLASS="l">146</TD><TD>    // The following are not serialized with the Session object</TD></TR><TR><TD CLASS="l">147</TD><TD>    private volatile Bundle authorizationBundle;</TD></TR><TR><TD CLASS="l">148</TD><TD>    private final List&lt;StatusCallback&gt; callbacks;</TD></TR><TR><TD CLASS="l">149</TD><TD>    private Handler handler;</TD></TR><TR><TD CLASS="l">150</TD><TD>    private AutoPublishAsyncTask autoPublishAsyncTask;</TD></TR><TR><TD CLASS="l">151</TD><TD>    // This is the object that synchronizes access to state and tokenInfo</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="25% line coverage (15 out of 61 instructions)">152</TD><TD TITLE="25% line coverage (15 out of 61 instructions)">    private final Object lock = new Object();</TD></TR><TR><TD CLASS="l">153</TD><TD>    private TokenCachingStrategy tokenCachingStrategy;</TD></TR><TR><TD CLASS="l">154</TD><TD>    private volatile TokenRefreshRequest currentTokenRefreshRequest;</TD></TR><TR><TD CLASS="l">155</TD><TD>    private AppEventsLogger appEventsLogger;</TD></TR><TR><TD CLASS="l">156</TD><TD> </TD></TR><TR><TD CLASS="l">157</TD><TD>    /**</TD></TR><TR><TD CLASS="l">158</TD><TD>     * Serialization proxy for the Session class. This is version 1 of</TD></TR><TR><TD CLASS="l">159</TD><TD>     * serialization. Future serializations may differ in format. This</TD></TR><TR><TD CLASS="l">160</TD><TD>     * class should not be modified. If serializations formats change,</TD></TR><TR><TD CLASS="l">161</TD><TD>     * create a new class SerializationProxyVx.</TD></TR><TR><TD CLASS="l">162</TD><TD>     */</TD></TR><TR><TD CLASS="l">163</TD><TD>    private static class SerializationProxyV1 implements Serializable {</TD></TR><TR><TD CLASS="l">164</TD><TD>        private static final long serialVersionUID = 7663436173185080063L;</TD></TR><TR><TD CLASS="l">165</TD><TD>        private final String applicationId;</TD></TR><TR><TD CLASS="l">166</TD><TD>        private final SessionState state;</TD></TR><TR><TD CLASS="l">167</TD><TD>        private final AccessToken tokenInfo;</TD></TR><TR><TD CLASS="l">168</TD><TD>        private final Date lastAttemptedTokenExtendDate;</TD></TR><TR><TD CLASS="l">169</TD><TD>        private final boolean shouldAutoPublish;</TD></TR><TR><TD CLASS="l"><A NAME="5c">170</A></TD><TD>        private final AuthorizationRequest pendingAuthorizationRequest;</TD></TR><TR><TD CLASS="l">171</TD><TD> </TD></TR><TR><TD CLASS="l">172</TD><TD>        SerializationProxyV1(String applicationId, SessionState state,</TD></TR><TR><TD CLASS="l">173</TD><TD>                AccessToken tokenInfo, Date lastAttemptedTokenExtendDate,</TD></TR><TR CLASS="z"><TD CLASS="l">174</TD><TD>                boolean shouldAutoPublish, AuthorizationRequest pendingAuthorizationRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">175</TD><TD>            this.applicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l">176</TD><TD>            this.state = state;</TD></TR><TR CLASS="z"><TD CLASS="l">177</TD><TD>            this.tokenInfo = tokenInfo;</TD></TR><TR CLASS="z"><TD CLASS="l">178</TD><TD>            this.lastAttemptedTokenExtendDate = lastAttemptedTokenExtendDate;</TD></TR><TR CLASS="z"><TD CLASS="l">179</TD><TD>            this.shouldAutoPublish = shouldAutoPublish;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="5e">180</A></TD><TD>            this.pendingAuthorizationRequest = pendingAuthorizationRequest;</TD></TR><TR CLASS="z"><TD CLASS="l">181</TD><TD>        }</TD></TR><TR><TD CLASS="l">182</TD><TD> </TD></TR><TR><TD CLASS="l">183</TD><TD>        private Object readResolve() {</TD></TR><TR CLASS="z"><TD CLASS="l">184</TD><TD>            return new Session(applicationId, state, tokenInfo,</TD></TR><TR><TD CLASS="l">185</TD><TD>                    lastAttemptedTokenExtendDate, shouldAutoPublish, pendingAuthorizationRequest);</TD></TR><TR><TD CLASS="l">186</TD><TD>        }</TD></TR><TR><TD CLASS="l">187</TD><TD>    }</TD></TR><TR><TD CLASS="l">188</TD><TD> </TD></TR><TR><TD CLASS="l">189</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="6c">190</A></TD><TD>     * Used by version 1 of the serialization proxy, do not modify.</TD></TR><TR><TD CLASS="l">191</TD><TD>     */</TD></TR><TR><TD CLASS="l">192</TD><TD>    private Session(String applicationId, SessionState state,</TD></TR><TR><TD CLASS="l">193</TD><TD>            AccessToken tokenInfo, Date lastAttemptedTokenExtendDate,</TD></TR><TR CLASS="z"><TD CLASS="l">194</TD><TD>            boolean shouldAutoPublish, AuthorizationRequest pendingAuthorizationRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">195</TD><TD>        this.applicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l">196</TD><TD>        this.state = state;</TD></TR><TR CLASS="z"><TD CLASS="l">197</TD><TD>        this.tokenInfo = tokenInfo;</TD></TR><TR CLASS="z"><TD CLASS="l">198</TD><TD>        this.lastAttemptedTokenExtendDate = lastAttemptedTokenExtendDate;</TD></TR><TR CLASS="z"><TD CLASS="l">199</TD><TD>        this.pendingAuthorizationRequest = pendingAuthorizationRequest;</TD></TR><TR CLASS="z"><TD CLASS="l">200</TD><TD>        handler = new Handler(Looper.getMainLooper());</TD></TR><TR CLASS="z"><TD CLASS="l">201</TD><TD>        currentTokenRefreshRequest = null;</TD></TR><TR CLASS="z"><TD CLASS="l">202</TD><TD>        tokenCachingStrategy = null;</TD></TR><TR CLASS="z"><TD CLASS="l">203</TD><TD>        callbacks = new ArrayList&lt;StatusCallback&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">204</TD><TD>    }</TD></TR><TR><TD CLASS="l">205</TD><TD> </TD></TR><TR><TD CLASS="l">206</TD><TD>    /**</TD></TR><TR><TD CLASS="l">207</TD><TD>     * Initializes a new Session with the specified context.</TD></TR><TR><TD CLASS="l"><A NAME="b8">208</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">209</TD><TD>     * @param currentContext The Activity or Service creating this Session.</TD></TR><TR><TD CLASS="l">210</TD><TD>     */</TD></TR><TR><TD CLASS="l">211</TD><TD>    public Session(Context currentContext) {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="6b">212</A></TD><TD>        this(currentContext, null, null, true);</TD></TR><TR CLASS="c"><TD CLASS="l">213</TD><TD>    }</TD></TR><TR><TD CLASS="l">214</TD><TD> </TD></TR><TR><TD CLASS="l">215</TD><TD>    Session(Context context, String applicationId, TokenCachingStrategy tokenCachingStrategy) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b2">216</A></TD><TD>        this(context, applicationId, tokenCachingStrategy, true);</TD></TR><TR CLASS="z"><TD CLASS="l">217</TD><TD>    }</TD></TR><TR><TD CLASS="l">218</TD><TD> </TD></TR><TR><TD CLASS="l">219</TD><TD>    Session(Context context, String applicationId, TokenCachingStrategy tokenCachingStrategy,</TD></TR><TR CLASS="c"><TD CLASS="l">220</TD><TD>            boolean loadTokenFromCache) {</TD></TR><TR><TD CLASS="l">221</TD><TD>        // if the application ID passed in is null, try to get it from the</TD></TR><TR><TD CLASS="l">222</TD><TD>        // meta-data in the manifest.</TD></TR><TR CLASS="c"><TD CLASS="l">223</TD><TD>        if ((context != null) &amp;&amp; (applicationId == null)) {</TD></TR><TR CLASS="c"><TD CLASS="l">224</TD><TD>            applicationId = Utility.getMetadataApplicationId(context);</TD></TR><TR><TD CLASS="l">225</TD><TD>        }</TD></TR><TR><TD CLASS="l">226</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">227</TD><TD>        Validate.notNull(applicationId, &#34;applicationId&#34;);</TD></TR><TR><TD CLASS="l">228</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">229</TD><TD>        initializeStaticContext(context);</TD></TR><TR><TD CLASS="l">230</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">231</TD><TD>        if (tokenCachingStrategy == null) {</TD></TR><TR CLASS="c"><TD CLASS="l">232</TD><TD>            tokenCachingStrategy = new SharedPreferencesTokenCachingStrategy(staticContext);</TD></TR><TR><TD CLASS="l">233</TD><TD>        }</TD></TR><TR><TD CLASS="l">234</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">235</TD><TD>        this.applicationId = applicationId;</TD></TR><TR CLASS="c"><TD CLASS="l">236</TD><TD>        this.tokenCachingStrategy = tokenCachingStrategy;</TD></TR><TR CLASS="c"><TD CLASS="l">237</TD><TD>        this.state = SessionState.CREATED;</TD></TR><TR CLASS="c"><TD CLASS="l">238</TD><TD>        this.pendingAuthorizationRequest = null;</TD></TR><TR CLASS="c"><TD CLASS="l">239</TD><TD>        this.callbacks = new ArrayList&lt;StatusCallback&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">240</TD><TD>        this.handler = new Handler(Looper.getMainLooper());</TD></TR><TR><TD CLASS="l">241</TD><TD> </TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="97% line coverage (32 out of 33 instructions)">242</TD><TD TITLE="97% line coverage (32 out of 33 instructions)">        Bundle tokenState = loadTokenFromCache ? tokenCachingStrategy.load() : null;</TD></TR><TR CLASS="c"><TD CLASS="l">243</TD><TD>        if (TokenCachingStrategy.hasTokenInformation(tokenState)) {</TD></TR><TR CLASS="z"><TD CLASS="l">244</TD><TD>            Date cachedExpirationDate = TokenCachingStrategy</TD></TR><TR><TD CLASS="l">245</TD><TD>                    .getDate(tokenState, TokenCachingStrategy.EXPIRATION_DATE_KEY);</TD></TR><TR CLASS="z"><TD CLASS="l">246</TD><TD>            Date now = new Date();</TD></TR><TR><TD CLASS="l">247</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">248</TD><TD>            if ((cachedExpirationDate == null) || cachedExpirationDate.before(now)) {</TD></TR><TR><TD CLASS="l">249</TD><TD>                // If expired or we require new permissions, clear out the</TD></TR><TR><TD CLASS="l">250</TD><TD>                // current token cache.</TD></TR><TR CLASS="z"><TD CLASS="l">251</TD><TD>                tokenCachingStrategy.clear();</TD></TR><TR CLASS="z"><TD CLASS="l">252</TD><TD>                this.tokenInfo = AccessToken.createEmptyToken(Collections.&lt;String&gt;emptyList());</TD></TR><TR><TD CLASS="l">253</TD><TD>            } else {</TD></TR><TR><TD CLASS="l">254</TD><TD>                // Otherwise we have a valid token, so use it.</TD></TR><TR CLASS="z"><TD CLASS="l">255</TD><TD>                this.tokenInfo = AccessToken.createFromCache(tokenState);</TD></TR><TR CLASS="z"><TD CLASS="l">256</TD><TD>                this.state = SessionState.CREATED_TOKEN_LOADED;</TD></TR><TR><TD CLASS="l">257</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">258</TD><TD>        } else {</TD></TR><TR CLASS="c"><TD CLASS="l">259</TD><TD>            this.tokenInfo = AccessToken.createEmptyToken(Collections.&lt;String&gt;emptyList());</TD></TR><TR><TD CLASS="l">260</TD><TD>        }</TD></TR><TR CLASS="c"><TD CLASS="l">261</TD><TD>    }</TD></TR><TR><TD CLASS="l">262</TD><TD> </TD></TR><TR><TD CLASS="l">263</TD><TD>    /**</TD></TR><TR><TD CLASS="l">264</TD><TD>     * Returns a Bundle containing data that was returned from Facebook during</TD></TR><TR><TD CLASS="l">265</TD><TD>     * authorization.</TD></TR><TR><TD CLASS="l">266</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="85">267</A></TD><TD>     * @return a Bundle containing data that was returned from Facebook during</TD></TR><TR><TD CLASS="l">268</TD><TD>     *         authorization.</TD></TR><TR><TD CLASS="l">269</TD><TD>     */</TD></TR><TR><TD CLASS="l">270</TD><TD>    public final Bundle getAuthorizationBundle() {</TD></TR><TR CLASS="z"><TD CLASS="l">271</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">272</TD><TD>            return this.authorizationBundle;</TD></TR><TR CLASS="z"><TD CLASS="l">273</TD><TD>        }</TD></TR><TR><TD CLASS="l">274</TD><TD>    }</TD></TR><TR><TD CLASS="l">275</TD><TD> </TD></TR><TR><TD CLASS="l">276</TD><TD>    /**</TD></TR><TR><TD CLASS="l">277</TD><TD>     * Returns a boolean indicating whether the session is opened.</TD></TR><TR><TD CLASS="l"><A NAME="b1">278</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">279</TD><TD>     * @return a boolean indicating whether the session is opened.</TD></TR><TR><TD CLASS="l">280</TD><TD>     */</TD></TR><TR><TD CLASS="l">281</TD><TD>    public final boolean isOpened() {</TD></TR><TR CLASS="c"><TD CLASS="l">282</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="c"><TD CLASS="l">283</TD><TD>            return this.state.isOpened();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b0">284</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">285</TD><TD>    }</TD></TR><TR><TD CLASS="l">286</TD><TD> </TD></TR><TR><TD CLASS="l">287</TD><TD>    public final boolean isClosed() {</TD></TR><TR CLASS="c"><TD CLASS="l">288</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="c"><TD CLASS="l">289</TD><TD>            return this.state.isClosed();</TD></TR><TR CLASS="z"><TD CLASS="l">290</TD><TD>        }</TD></TR><TR><TD CLASS="l">291</TD><TD>    }</TD></TR><TR><TD CLASS="l">292</TD><TD> </TD></TR><TR><TD CLASS="l">293</TD><TD>    /**</TD></TR><TR><TD CLASS="l">294</TD><TD>     * Returns the current state of the Session.</TD></TR><TR><TD CLASS="l">295</TD><TD>     * See {@link SessionState} for details.</TD></TR><TR><TD CLASS="l"><A NAME="af">296</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">297</TD><TD>     * @return the current state of the Session.</TD></TR><TR><TD CLASS="l">298</TD><TD>     */</TD></TR><TR><TD CLASS="l">299</TD><TD>    public final SessionState getState() {</TD></TR><TR CLASS="c"><TD CLASS="l">300</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="c"><TD CLASS="l">301</TD><TD>            return this.state;</TD></TR><TR CLASS="z"><TD CLASS="l">302</TD><TD>        }</TD></TR><TR><TD CLASS="l">303</TD><TD>    }</TD></TR><TR><TD CLASS="l">304</TD><TD> </TD></TR><TR><TD CLASS="l">305</TD><TD>    /**</TD></TR><TR><TD CLASS="l">306</TD><TD>     * Returns the application id associated with this Session.</TD></TR><TR><TD CLASS="l"><A NAME="84">307</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">308</TD><TD>     * @return the application id associated with this Session.</TD></TR><TR><TD CLASS="l">309</TD><TD>     */</TD></TR><TR><TD CLASS="l">310</TD><TD>    public final String getApplicationId() {</TD></TR><TR CLASS="z"><TD CLASS="l">311</TD><TD>        return this.applicationId;</TD></TR><TR><TD CLASS="l">312</TD><TD>    }</TD></TR><TR><TD CLASS="l">313</TD><TD> </TD></TR><TR><TD CLASS="l">314</TD><TD>    /**</TD></TR><TR><TD CLASS="l">315</TD><TD>     * Returns the access token String.</TD></TR><TR><TD CLASS="l"><A NAME="82">316</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">317</TD><TD>     * @return the access token String, or null if there is no access token</TD></TR><TR><TD CLASS="l">318</TD><TD>     */</TD></TR><TR><TD CLASS="l">319</TD><TD>    public final String getAccessToken() {</TD></TR><TR CLASS="z"><TD CLASS="l">320</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">321</TD><TD>            return (this.tokenInfo == null) ? null : this.tokenInfo.getToken();</TD></TR><TR CLASS="z"><TD CLASS="l">322</TD><TD>        }</TD></TR><TR><TD CLASS="l">323</TD><TD>    }</TD></TR><TR><TD CLASS="l">324</TD><TD> </TD></TR><TR><TD CLASS="l">325</TD><TD>    /**</TD></TR><TR><TD CLASS="l">326</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">327</TD><TD>     * Returns the Date at which the current token will expire.</TD></TR><TR><TD CLASS="l">328</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">329</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">330</TD><TD>     * Note that Session automatically attempts to extend the lifetime of Tokens</TD></TR><TR><TD CLASS="l">331</TD><TD>     * as needed when Facebook requests are made.</TD></TR><TR><TD CLASS="l">332</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l"><A NAME="86">333</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">334</TD><TD>     * @return the Date at which the current token will expire, or null if there is no access token</TD></TR><TR><TD CLASS="l">335</TD><TD>     */</TD></TR><TR><TD CLASS="l">336</TD><TD>    public final Date getExpirationDate() {</TD></TR><TR CLASS="z"><TD CLASS="l">337</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>            return (this.tokenInfo == null) ? null : this.tokenInfo.getExpires();</TD></TR><TR CLASS="z"><TD CLASS="l">339</TD><TD>        }</TD></TR><TR><TD CLASS="l">340</TD><TD>    }</TD></TR><TR><TD CLASS="l">341</TD><TD> </TD></TR><TR><TD CLASS="l">342</TD><TD>    /**</TD></TR><TR><TD CLASS="l">343</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">344</TD><TD>     * Returns the list of permissions associated with the session.</TD></TR><TR><TD CLASS="l">345</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">346</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">347</TD><TD>     * If there is a valid token, this represents the permissions granted by</TD></TR><TR><TD CLASS="l">348</TD><TD>     * that token. This can change during calls to</TD></TR><TR><TD CLASS="l">349</TD><TD>     * {@link #requestNewReadPermissions}</TD></TR><TR><TD CLASS="l">350</TD><TD>     * or {@link #requestNewPublishPermissions}.</TD></TR><TR><TD CLASS="l">351</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l"><A NAME="89">352</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">353</TD><TD>     * @return the list of permissions associated with the session, or null if there is no access token</TD></TR><TR><TD CLASS="l">354</TD><TD>     */</TD></TR><TR><TD CLASS="l">355</TD><TD>    public final List&lt;String&gt; getPermissions() {</TD></TR><TR CLASS="z"><TD CLASS="l">356</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">357</TD><TD>            return (this.tokenInfo == null) ? null : this.tokenInfo.getPermissions();</TD></TR><TR CLASS="z"><TD CLASS="l">358</TD><TD>        }</TD></TR><TR><TD CLASS="l">359</TD><TD>    }</TD></TR><TR><TD CLASS="l">360</TD><TD> </TD></TR><TR><TD CLASS="l">361</TD><TD>    /**</TD></TR><TR><TD CLASS="l">362</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">363</TD><TD>     * Logs a user in to Facebook.</TD></TR><TR><TD CLASS="l">364</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">365</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">366</TD><TD>     * A session may not be used with {@link Request Request} and other classes</TD></TR><TR><TD CLASS="l">367</TD><TD>     * in the SDK until it is open. If, prior to calling open, the session is in</TD></TR><TR><TD CLASS="l">368</TD><TD>     * the {@link SessionState#CREATED_TOKEN_LOADED CREATED_TOKEN_LOADED}</TD></TR><TR><TD CLASS="l">369</TD><TD>     * state, and the requested permissions are a subset of the previously authorized</TD></TR><TR><TD CLASS="l">370</TD><TD>     * permissions, then the Session becomes usable immediately with no user interaction.</TD></TR><TR><TD CLASS="l">371</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">372</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">373</TD><TD>     * The permissions associated with the openRequest passed to this method must</TD></TR><TR><TD CLASS="l">374</TD><TD>     * be read permissions only (or null/empty). It is not allowed to pass publish</TD></TR><TR><TD CLASS="l">375</TD><TD>     * permissions to this method and will result in an exception being thrown.</TD></TR><TR><TD CLASS="l">376</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">377</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">378</TD><TD>     * Any open method must be called at most once, and cannot be called after the</TD></TR><TR><TD CLASS="l">379</TD><TD>     * Session is closed. Calling the method at an invalid time will result in</TD></TR><TR><TD CLASS="l">380</TD><TD>     * UnsuportedOperationException.</TD></TR><TR><TD CLASS="l">381</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">382</TD><TD>     *</TD></TR><TR><TD CLASS="l">383</TD><TD>     * @param openRequest the open request, can be null only if the Session is in the</TD></TR><TR><TD CLASS="l"><A NAME="99">384</A></TD><TD>     *                    {@link SessionState#CREATED_TOKEN_LOADED CREATED_TOKEN_LOADED} state</TD></TR><TR><TD CLASS="l">385</TD><TD>     * @throws FacebookException if any publish or manage permissions are requested</TD></TR><TR><TD CLASS="l">386</TD><TD>     */</TD></TR><TR><TD CLASS="l">387</TD><TD>    public final void openForRead(OpenRequest openRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">388</TD><TD>        open(openRequest, SessionAuthorizationType.READ);</TD></TR><TR CLASS="z"><TD CLASS="l">389</TD><TD>    }</TD></TR><TR><TD CLASS="l">390</TD><TD> </TD></TR><TR><TD CLASS="l">391</TD><TD>    /**</TD></TR><TR><TD CLASS="l">392</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">393</TD><TD>     * Logs a user in to Facebook.</TD></TR><TR><TD CLASS="l">394</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">395</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">396</TD><TD>     * A session may not be used with {@link Request Request} and other classes</TD></TR><TR><TD CLASS="l">397</TD><TD>     * in the SDK until it is open. If, prior to calling open, the session is in</TD></TR><TR><TD CLASS="l">398</TD><TD>     * the {@link SessionState#CREATED_TOKEN_LOADED CREATED_TOKEN_LOADED}</TD></TR><TR><TD CLASS="l">399</TD><TD>     * state, and the requested permissions are a subset of the previously authorized</TD></TR><TR><TD CLASS="l">400</TD><TD>     * permissions, then the Session becomes usable immediately with no user interaction.</TD></TR><TR><TD CLASS="l">401</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">402</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">403</TD><TD>     * The permissions associated with the openRequest passed to this method must</TD></TR><TR><TD CLASS="l">404</TD><TD>     * be publish or manage permissions only and must be non-empty. Any read permissions</TD></TR><TR><TD CLASS="l">405</TD><TD>     * will result in a warning, and may fail during server-side authorization. Also, an application</TD></TR><TR><TD CLASS="l">406</TD><TD>     * must have at least basic read permissions prior to requesting publish permissions, so</TD></TR><TR><TD CLASS="l">407</TD><TD>     * this method should only be used if the application knows that the user has already granted</TD></TR><TR><TD CLASS="l">408</TD><TD>     * read permissions to the application; otherwise, openForRead should be used, followed by a</TD></TR><TR><TD CLASS="l">409</TD><TD>     * call to requestNewPublishPermissions. For more information on this flow, see</TD></TR><TR><TD CLASS="l">410</TD><TD>     * https://developers.facebook.com/docs/facebook-login/permissions/.</TD></TR><TR><TD CLASS="l">411</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">412</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">413</TD><TD>     * Any open method must be called at most once, and cannot be called after the</TD></TR><TR><TD CLASS="l">414</TD><TD>     * Session is closed. Calling the method at an invalid time will result in</TD></TR><TR><TD CLASS="l">415</TD><TD>     * UnsuportedOperationException.</TD></TR><TR><TD CLASS="l">416</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">417</TD><TD>     *</TD></TR><TR><TD CLASS="l">418</TD><TD>     * @param openRequest the open request, can be null only if the Session is in the</TD></TR><TR><TD CLASS="l"><A NAME="98">419</A></TD><TD>     *                    {@link SessionState#CREATED_TOKEN_LOADED CREATED_TOKEN_LOADED} state</TD></TR><TR><TD CLASS="l">420</TD><TD>     * @throws FacebookException if the passed in request is null or has no permissions set.</TD></TR><TR><TD CLASS="l">421</TD><TD>     */</TD></TR><TR><TD CLASS="l">422</TD><TD>    public final void openForPublish(OpenRequest openRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">423</TD><TD>        open(openRequest, SessionAuthorizationType.PUBLISH);</TD></TR><TR CLASS="z"><TD CLASS="l">424</TD><TD>    }</TD></TR><TR><TD CLASS="l">425</TD><TD> </TD></TR><TR><TD CLASS="l">426</TD><TD>    /**</TD></TR><TR><TD CLASS="l">427</TD><TD>     * Opens a session based on an existing Facebook access token. This method should be used</TD></TR><TR><TD CLASS="l">428</TD><TD>     * only in instances where an application has previously obtained an access token and wishes</TD></TR><TR><TD CLASS="l">429</TD><TD>     * to import it into the Session/TokenCachingStrategy-based session-management system. An</TD></TR><TR><TD CLASS="l">430</TD><TD>     * example would be an application which previously did not use the Facebook SDK for Android</TD></TR><TR><TD CLASS="l">431</TD><TD>     * and implemented its own session-management scheme, but wishes to implement an upgrade path</TD></TR><TR><TD CLASS="l">432</TD><TD>     * for existing users so they do not need to log in again when upgrading to a version of</TD></TR><TR><TD CLASS="l">433</TD><TD>     * the app that uses the SDK.</TD></TR><TR><TD CLASS="l">434</TD><TD>     * &lt;p/&gt;</TD></TR><TR><TD CLASS="l">435</TD><TD>     * No validation is done that the token, token source, or permissions are actually valid.</TD></TR><TR><TD CLASS="l">436</TD><TD>     * It is the caller's responsibility to ensure that these accurately reflect the state of</TD></TR><TR><TD CLASS="l">437</TD><TD>     * the token that has been passed in, or calls to the Facebook API may fail.</TD></TR><TR><TD CLASS="l">438</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="91">439</A></TD><TD>     * @param accessToken the access token obtained from Facebook</TD></TR><TR><TD CLASS="l">440</TD><TD>     * @param callback    a callback that will be called when the session status changes; may be null</TD></TR><TR><TD CLASS="l">441</TD><TD>     */</TD></TR><TR><TD CLASS="l">442</TD><TD>    public final void open(AccessToken accessToken, StatusCallback callback) {</TD></TR><TR CLASS="z"><TD CLASS="l">443</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">444</TD><TD>            if (pendingAuthorizationRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">445</TD><TD>                throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">446</TD><TD>                        &#34;Session: an attempt was made to open a session that has a pending request.&#34;);</TD></TR><TR><TD CLASS="l">447</TD><TD>            }</TD></TR><TR><TD CLASS="l">448</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">449</TD><TD>            if (state.isClosed()) {</TD></TR><TR CLASS="z"><TD CLASS="l">450</TD><TD>                throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">451</TD><TD>                        &#34;Session: an attempt was made to open a previously-closed session.&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">452</TD><TD>            } else if (state != SessionState.CREATED &amp;&amp; state != SessionState.CREATED_TOKEN_LOADED) {</TD></TR><TR CLASS="z"><TD CLASS="l">453</TD><TD>                throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">454</TD><TD>                        &#34;Session: an attempt was made to open an already opened session.&#34;);</TD></TR><TR><TD CLASS="l">455</TD><TD>            }</TD></TR><TR><TD CLASS="l">456</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">457</TD><TD>            if (callback != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">458</TD><TD>                addCallback(callback);</TD></TR><TR><TD CLASS="l">459</TD><TD>            }</TD></TR><TR><TD CLASS="l">460</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">461</TD><TD>            this.tokenInfo = accessToken;</TD></TR><TR><TD CLASS="l">462</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">463</TD><TD>            if (this.tokenCachingStrategy != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">464</TD><TD>                this.tokenCachingStrategy.save(accessToken.toCacheBundle());</TD></TR><TR><TD CLASS="l">465</TD><TD>            }</TD></TR><TR><TD CLASS="l">466</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">467</TD><TD>            final SessionState oldState = state;</TD></TR><TR CLASS="z"><TD CLASS="l">468</TD><TD>            state = SessionState.OPENED;</TD></TR><TR CLASS="z"><TD CLASS="l">469</TD><TD>            this.postStateChange(oldState, state, null);</TD></TR><TR CLASS="z"><TD CLASS="l">470</TD><TD>        }</TD></TR><TR><TD CLASS="l">471</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">472</TD><TD>        autoPublishAsync();</TD></TR><TR CLASS="z"><TD CLASS="l">473</TD><TD>    }</TD></TR><TR><TD CLASS="l">474</TD><TD> </TD></TR><TR><TD CLASS="l">475</TD><TD>    /**</TD></TR><TR><TD CLASS="l">476</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">477</TD><TD>     * Issues a request to add new read permissions to the Session.</TD></TR><TR><TD CLASS="l">478</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">479</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">480</TD><TD>     * If successful, this will update the set of permissions on this session to</TD></TR><TR><TD CLASS="l">481</TD><TD>     * match the newPermissions. If this fails, the Session remains unchanged.</TD></TR><TR><TD CLASS="l">482</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">483</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">484</TD><TD>     * The permissions associated with the newPermissionsRequest passed to this method must</TD></TR><TR><TD CLASS="l">485</TD><TD>     * be read permissions only (or null/empty). It is not allowed to pass publish</TD></TR><TR><TD CLASS="l">486</TD><TD>     * permissions to this method and will result in an exception being thrown.</TD></TR><TR><TD CLASS="l">487</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l"><A NAME="9e">488</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">489</TD><TD>     * @param newPermissionsRequest the new permissions request</TD></TR><TR><TD CLASS="l">490</TD><TD>     */</TD></TR><TR><TD CLASS="l">491</TD><TD>    public final void requestNewReadPermissions(NewPermissionsRequest newPermissionsRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">492</TD><TD>        requestNewPermissions(newPermissionsRequest, SessionAuthorizationType.READ);</TD></TR><TR CLASS="z"><TD CLASS="l">493</TD><TD>    }</TD></TR><TR><TD CLASS="l">494</TD><TD> </TD></TR><TR><TD CLASS="l">495</TD><TD>    /**</TD></TR><TR><TD CLASS="l">496</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">497</TD><TD>     * Issues a request to add new publish or manage permissions to the Session.</TD></TR><TR><TD CLASS="l">498</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">499</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">500</TD><TD>     * If successful, this will update the set of permissions on this session to</TD></TR><TR><TD CLASS="l">501</TD><TD>     * match the newPermissions. If this fails, the Session remains unchanged.</TD></TR><TR><TD CLASS="l">502</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">503</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">504</TD><TD>     * The permissions associated with the newPermissionsRequest passed to this method must</TD></TR><TR><TD CLASS="l">505</TD><TD>     * be publish or manage permissions only and must be non-empty. Any read permissions</TD></TR><TR><TD CLASS="l">506</TD><TD>     * will result in a warning, and may fail during server-side authorization.</TD></TR><TR><TD CLASS="l">507</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l"><A NAME="9d">508</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">509</TD><TD>     * @param newPermissionsRequest the new permissions request</TD></TR><TR><TD CLASS="l">510</TD><TD>     */</TD></TR><TR><TD CLASS="l">511</TD><TD>    public final void requestNewPublishPermissions(NewPermissionsRequest newPermissionsRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">512</TD><TD>        requestNewPermissions(newPermissionsRequest, SessionAuthorizationType.PUBLISH);</TD></TR><TR CLASS="z"><TD CLASS="l">513</TD><TD>    }</TD></TR><TR><TD CLASS="l">514</TD><TD> </TD></TR><TR><TD CLASS="l">515</TD><TD>    /**</TD></TR><TR><TD CLASS="l">516</TD><TD>     * Provides an implementation for {@link Activity#onActivityResult</TD></TR><TR><TD CLASS="l">517</TD><TD>     * onActivityResult} that updates the Session based on information returned</TD></TR><TR><TD CLASS="l">518</TD><TD>     * during the authorization flow. The Activity that calls open or</TD></TR><TR><TD CLASS="l">519</TD><TD>     * requestNewPermissions should forward the resulting onActivityResult call here to</TD></TR><TR><TD CLASS="l">520</TD><TD>     * update the Session state based on the contents of the resultCode and</TD></TR><TR><TD CLASS="l">521</TD><TD>     * data.</TD></TR><TR><TD CLASS="l">522</TD><TD>     *</TD></TR><TR><TD CLASS="l">523</TD><TD>     * @param currentActivity The Activity that is forwarding the onActivityResult call.</TD></TR><TR><TD CLASS="l">524</TD><TD>     * @param requestCode     The requestCode parameter from the forwarded call. When this</TD></TR><TR><TD CLASS="l">525</TD><TD>     *                        onActivityResult occurs as part of Facebook authorization</TD></TR><TR><TD CLASS="l">526</TD><TD>     *                        flow, this value is the activityCode passed to open or</TD></TR><TR><TD CLASS="l">527</TD><TD>     *                        authorize.</TD></TR><TR><TD CLASS="l">528</TD><TD>     * @param resultCode      An int containing the resultCode parameter from the forwarded</TD></TR><TR><TD CLASS="l">529</TD><TD>     *                        call.</TD></TR><TR><TD CLASS="l">530</TD><TD>     * @param data            The Intent passed as the data parameter from the forwarded</TD></TR><TR><TD CLASS="l">531</TD><TD>     *                        call.</TD></TR><TR><TD CLASS="l"><A NAME="90">532</A></TD><TD>     * @return A boolean indicating whether the requestCode matched a pending</TD></TR><TR><TD CLASS="l">533</TD><TD>     *         authorization request for this Session.</TD></TR><TR><TD CLASS="l">534</TD><TD>     */</TD></TR><TR><TD CLASS="l">535</TD><TD>    public final boolean onActivityResult(Activity currentActivity, int requestCode, int resultCode, Intent data) {</TD></TR><TR CLASS="z"><TD CLASS="l">536</TD><TD>        Validate.notNull(currentActivity, &#34;currentActivity&#34;);</TD></TR><TR><TD CLASS="l">537</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">538</TD><TD>        initializeStaticContext(currentActivity);</TD></TR><TR><TD CLASS="l">539</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">540</TD><TD>        synchronized (lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">541</TD><TD>            if (pendingAuthorizationRequest == null || (requestCode != pendingAuthorizationRequest.getRequestCode())) {</TD></TR><TR CLASS="z"><TD CLASS="l">542</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">543</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">544</TD><TD>        }</TD></TR><TR><TD CLASS="l">545</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">546</TD><TD>        Exception exception = null;</TD></TR><TR CLASS="z"><TD CLASS="l">547</TD><TD>        AuthorizationClient.Result.Code code = AuthorizationClient.Result.Code.ERROR;</TD></TR><TR><TD CLASS="l">548</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">549</TD><TD>        if (data != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">550</TD><TD>            AuthorizationClient.Result result = (AuthorizationClient.Result) data.getSerializableExtra(</TD></TR><TR><TD CLASS="l">551</TD><TD>                    LoginActivity.RESULT_KEY);</TD></TR><TR CLASS="z"><TD CLASS="l">552</TD><TD>            if (result != null) {</TD></TR><TR><TD CLASS="l">553</TD><TD>                // This came from LoginActivity.</TD></TR><TR CLASS="z"><TD CLASS="l">554</TD><TD>                handleAuthorizationResult(resultCode, result);</TD></TR><TR CLASS="z"><TD CLASS="l">555</TD><TD>                return true;</TD></TR><TR CLASS="z"><TD CLASS="l">556</TD><TD>            } else if (authorizationClient != null) {</TD></TR><TR><TD CLASS="l">557</TD><TD>                // Delegate to the auth client.</TD></TR><TR CLASS="z"><TD CLASS="l">558</TD><TD>                authorizationClient.onActivityResult(requestCode, resultCode, data);</TD></TR><TR CLASS="z"><TD CLASS="l">559</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">560</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">561</TD><TD>        } else if (resultCode == Activity.RESULT_CANCELED) {</TD></TR><TR CLASS="z"><TD CLASS="l">562</TD><TD>            exception = new FacebookOperationCanceledException(&#34;User canceled operation.&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">563</TD><TD>            code = AuthorizationClient.Result.Code.CANCEL;</TD></TR><TR><TD CLASS="l">564</TD><TD>        }</TD></TR><TR><TD CLASS="l">565</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">566</TD><TD>        if (exception == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">567</TD><TD>            exception = new FacebookException(&#34;Unexpected call to Session.onActivityResult&#34;);</TD></TR><TR><TD CLASS="l">568</TD><TD>        }</TD></TR><TR><TD CLASS="l">569</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">570</TD><TD>        logAuthorizationComplete(code, null, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">571</TD><TD>        finishAuthOrReauth(null, exception);</TD></TR><TR><TD CLASS="l">572</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">573</TD><TD>        return true;</TD></TR><TR><TD CLASS="l">574</TD><TD>    }</TD></TR><TR><TD CLASS="l">575</TD><TD> </TD></TR><TR><TD CLASS="l">576</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="79">577</A></TD><TD>     * Closes the local in-memory Session object, but does not clear the</TD></TR><TR><TD CLASS="l">578</TD><TD>     * persisted token cache.</TD></TR><TR><TD CLASS="l">579</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="9">580</A></TD><TD>    public final void close() {</TD></TR><TR CLASS="z"><TD CLASS="l">581</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">582</TD><TD>            final SessionState oldState = this.state;</TD></TR><TR><TD CLASS="l">583</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">584</TD><TD>            switch (this.state) {</TD></TR><TR><TD CLASS="l">585</TD><TD>                case CREATED:</TD></TR><TR><TD CLASS="l">586</TD><TD>                case OPENING:</TD></TR><TR CLASS="z"><TD CLASS="l">587</TD><TD>                    this.state = SessionState.CLOSED_LOGIN_FAILED;</TD></TR><TR CLASS="z"><TD CLASS="l">588</TD><TD>                    postStateChange(oldState, this.state, new FacebookException(</TD></TR><TR><TD CLASS="l">589</TD><TD>                            &#34;Log in attempt aborted.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">590</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">591</TD><TD> </TD></TR><TR><TD CLASS="l">592</TD><TD>                case CREATED_TOKEN_LOADED:</TD></TR><TR><TD CLASS="l">593</TD><TD>                case OPENED:</TD></TR><TR><TD CLASS="l">594</TD><TD>                case OPENED_TOKEN_UPDATED:</TD></TR><TR CLASS="z"><TD CLASS="l">595</TD><TD>                    this.state = SessionState.CLOSED;</TD></TR><TR CLASS="z"><TD CLASS="l">596</TD><TD>                    postStateChange(oldState, this.state, null);</TD></TR><TR CLASS="z"><TD CLASS="l">597</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">598</TD><TD> </TD></TR><TR><TD CLASS="l">599</TD><TD>                case CLOSED:</TD></TR><TR><TD CLASS="l">600</TD><TD>                case CLOSED_LOGIN_FAILED:</TD></TR><TR><TD CLASS="l">601</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">602</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">603</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">604</TD><TD>    }</TD></TR><TR><TD CLASS="l">605</TD><TD> </TD></TR><TR><TD CLASS="l">606</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="7a">607</A></TD><TD>     * Closes the local in-memory Session object and clears any persisted token</TD></TR><TR><TD CLASS="l">608</TD><TD>     * cache related to the Session.</TD></TR><TR><TD CLASS="l">609</TD><TD>     */</TD></TR><TR><TD CLASS="l">610</TD><TD>    public final void closeAndClearTokenInformation() {</TD></TR><TR CLASS="z"><TD CLASS="l">611</TD><TD>        if (this.tokenCachingStrategy != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">612</TD><TD>            this.tokenCachingStrategy.clear();</TD></TR><TR><TD CLASS="l">613</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">614</TD><TD>        Utility.clearFacebookCookies(staticContext);</TD></TR><TR CLASS="z"><TD CLASS="l">615</TD><TD>        Utility.clearCaches(staticContext);</TD></TR><TR CLASS="z"><TD CLASS="l">616</TD><TD>        close();</TD></TR><TR CLASS="z"><TD CLASS="l">617</TD><TD>    }</TD></TR><TR><TD CLASS="l">618</TD><TD> </TD></TR><TR><TD CLASS="l">619</TD><TD>    /**</TD></TR><TR><TD CLASS="l">620</TD><TD>     * Adds a callback that will be called when the state of this Session changes.</TD></TR><TR><TD CLASS="l"><A NAME="b5">621</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">622</TD><TD>     * @param callback the callback</TD></TR><TR><TD CLASS="l">623</TD><TD>     */</TD></TR><TR><TD CLASS="l">624</TD><TD>    public final void addCallback(StatusCallback callback) {</TD></TR><TR CLASS="c"><TD CLASS="l">625</TD><TD>        synchronized (callbacks) {</TD></TR><TR CLASS="c"><TD CLASS="l">626</TD><TD>            if (callback != null &amp;&amp; !callbacks.contains(callback)) {</TD></TR><TR CLASS="c"><TD CLASS="l">627</TD><TD>                callbacks.add(callback);</TD></TR><TR><TD CLASS="l">628</TD><TD>            }</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="38% line coverage (3 out of 8 instructions)">629</TD><TD TITLE="38% line coverage (3 out of 8 instructions)">        }</TD></TR><TR CLASS="c"><TD CLASS="l">630</TD><TD>    }</TD></TR><TR><TD CLASS="l">631</TD><TD> </TD></TR><TR><TD CLASS="l">632</TD><TD>    /**</TD></TR><TR><TD CLASS="l">633</TD><TD>     * Removes a StatusCallback from this Session.</TD></TR><TR><TD CLASS="l"><A NAME="b4">634</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">635</TD><TD>     * @param callback the callback</TD></TR><TR><TD CLASS="l">636</TD><TD>     */</TD></TR><TR><TD CLASS="l">637</TD><TD>    public final void removeCallback(StatusCallback callback) {</TD></TR><TR CLASS="c"><TD CLASS="l">638</TD><TD>        synchronized (callbacks) {</TD></TR><TR CLASS="c"><TD CLASS="l">639</TD><TD>            callbacks.remove(callback);</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="72% line coverage (13 out of 18 instructions)">640</TD><TD TITLE="72% line coverage (13 out of 18 instructions)">        }</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="a8">641</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">642</TD><TD> </TD></TR><TR><TD CLASS="l">643</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">644</TD><TD>    public String toString() {</TD></TR><TR CLASS="z"><TD CLASS="l">645</TD><TD>        return new StringBuilder().append(&#34;{Session&#34;).append(&#34; state:&#34;).append(this.state).append(&#34;, token:&#34;)</TD></TR><TR><TD CLASS="l">646</TD><TD>                .append((this.tokenInfo == null) ? &#34;null&#34; : this.tokenInfo).append(&#34;, appId:&#34;)</TD></TR><TR><TD CLASS="l"><A NAME="7e">647</A></TD><TD>                .append((this.applicationId == null) ? &#34;null&#34; : this.applicationId).append(&#34;}&#34;).toString();</TD></TR><TR><TD CLASS="l">648</TD><TD>    }</TD></TR><TR><TD CLASS="l">649</TD><TD> </TD></TR><TR><TD CLASS="l">650</TD><TD>    void extendTokenCompleted(Bundle bundle) {</TD></TR><TR CLASS="z"><TD CLASS="l">651</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">652</TD><TD>            final SessionState oldState = this.state;</TD></TR><TR><TD CLASS="l">653</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">654</TD><TD>            switch (this.state) {</TD></TR><TR><TD CLASS="l">655</TD><TD>                case OPENED:</TD></TR><TR CLASS="z"><TD CLASS="l">656</TD><TD>                    this.state = SessionState.OPENED_TOKEN_UPDATED;</TD></TR><TR CLASS="z"><TD CLASS="l">657</TD><TD>                    postStateChange(oldState, this.state, null);</TD></TR><TR CLASS="z"><TD CLASS="l">658</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">659</TD><TD>                case OPENED_TOKEN_UPDATED:</TD></TR><TR CLASS="z"><TD CLASS="l">660</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">661</TD><TD>                default:</TD></TR><TR><TD CLASS="l">662</TD><TD>                    // Silently ignore attempts to refresh token if we are not open</TD></TR><TR CLASS="z"><TD CLASS="l">663</TD><TD>                    Log.d(TAG, &#34;refreshToken ignored in state &#34; + this.state);</TD></TR><TR CLASS="z"><TD CLASS="l">664</TD><TD>                    return;</TD></TR><TR><TD CLASS="l">665</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">666</TD><TD>            this.tokenInfo = AccessToken.createFromRefresh(this.tokenInfo, bundle);</TD></TR><TR CLASS="z"><TD CLASS="l">667</TD><TD>            if (this.tokenCachingStrategy != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">668</TD><TD>                this.tokenCachingStrategy.save(this.tokenInfo.toCacheBundle());</TD></TR><TR><TD CLASS="l">669</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="ad">670</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">671</TD><TD>    }</TD></TR><TR><TD CLASS="l">672</TD><TD> </TD></TR><TR><TD CLASS="l">673</TD><TD>    private Object writeReplace() {</TD></TR><TR CLASS="z"><TD CLASS="l">674</TD><TD>        return new SerializationProxyV1(applicationId, state, tokenInfo,</TD></TR><TR><TD CLASS="l">675</TD><TD>                lastAttemptedTokenExtendDate, false, pendingAuthorizationRequest);</TD></TR><TR><TD CLASS="l"><A NAME="9b">676</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">677</TD><TD> </TD></TR><TR><TD CLASS="l">678</TD><TD>    // have a readObject that throws to prevent spoofing</TD></TR><TR><TD CLASS="l">679</TD><TD>    private void readObject(ObjectInputStream stream) throws InvalidObjectException {</TD></TR><TR CLASS="z"><TD CLASS="l">680</TD><TD>        throw new InvalidObjectException(&#34;Cannot readObject, serialization proxy required&#34;);</TD></TR><TR><TD CLASS="l">681</TD><TD>    }</TD></TR><TR><TD CLASS="l">682</TD><TD> </TD></TR><TR><TD CLASS="l">683</TD><TD>    /**</TD></TR><TR><TD CLASS="l">684</TD><TD>     * Save the Session object into the supplied Bundle. This method is intended to be called from an</TD></TR><TR><TD CLASS="l">685</TD><TD>     * Activity or Fragment's onSaveInstanceState method in order to preserve Sessions across Activity lifecycle events.</TD></TR><TR><TD CLASS="l">686</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="a2">687</A></TD><TD>     * @param session the Session to save</TD></TR><TR><TD CLASS="l">688</TD><TD>     * @param bundle  the Bundle to save the Session to</TD></TR><TR><TD CLASS="l">689</TD><TD>     */</TD></TR><TR><TD CLASS="l">690</TD><TD>    public static final void saveSession(Session session, Bundle bundle) {</TD></TR><TR CLASS="z"><TD CLASS="l">691</TD><TD>        if (bundle != null &amp;&amp; session != null &amp;&amp; !bundle.containsKey(SESSION_BUNDLE_SAVE_KEY)) {</TD></TR><TR CLASS="z"><TD CLASS="l">692</TD><TD>            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();</TD></TR><TR><TD CLASS="l">693</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">694</TD><TD>                new ObjectOutputStream(outputStream).writeObject(session);</TD></TR><TR CLASS="z"><TD CLASS="l">695</TD><TD>            } catch (IOException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">696</TD><TD>                throw new FacebookException(&#34;Unable to save session.&#34;, e);</TD></TR><TR CLASS="z"><TD CLASS="l">697</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">698</TD><TD>            bundle.putByteArray(SESSION_BUNDLE_SAVE_KEY, outputStream.toByteArray());</TD></TR><TR CLASS="z"><TD CLASS="l">699</TD><TD>            bundle.putBundle(AUTH_BUNDLE_SAVE_KEY, session.authorizationBundle);</TD></TR><TR><TD CLASS="l">700</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">701</TD><TD>    }</TD></TR><TR><TD CLASS="l">702</TD><TD> </TD></TR><TR><TD CLASS="l">703</TD><TD>    /**</TD></TR><TR><TD CLASS="l">704</TD><TD>     * Restores the saved session from a Bundle, if any. Returns the restored Session or</TD></TR><TR><TD CLASS="l">705</TD><TD>     * null if it could not be restored. This method is intended to be called from an Activity or Fragment's</TD></TR><TR><TD CLASS="l">706</TD><TD>     * onCreate method when a Session has previously been saved into a Bundle via saveState to preserve a Session</TD></TR><TR><TD CLASS="l">707</TD><TD>     * across Activity lifecycle events.</TD></TR><TR><TD CLASS="l">708</TD><TD>     *</TD></TR><TR><TD CLASS="l">709</TD><TD>     * @param context         the Activity or Service creating the Session, must not be null</TD></TR><TR><TD CLASS="l">710</TD><TD>     * @param cachingStrategy the TokenCachingStrategy to use to load and store the token. If this is</TD></TR><TR><TD CLASS="l">711</TD><TD>     *                        null, a default token cachingStrategy that stores data in</TD></TR><TR><TD CLASS="l">712</TD><TD>     *                        SharedPreferences will be used</TD></TR><TR><TD CLASS="l">713</TD><TD>     * @param callback        the callback to notify for Session state changes, can be null</TD></TR><TR><TD CLASS="l">714</TD><TD>     * @param bundle          the bundle to restore the Session from</TD></TR><TR><TD CLASS="l"><A NAME="a0">715</A></TD><TD>     * @return the restored Session, or null</TD></TR><TR><TD CLASS="l">716</TD><TD>     */</TD></TR><TR><TD CLASS="l">717</TD><TD>    public static final Session restoreSession(</TD></TR><TR><TD CLASS="l">718</TD><TD>            Context context, TokenCachingStrategy cachingStrategy, StatusCallback callback, Bundle bundle) {</TD></TR><TR CLASS="z"><TD CLASS="l">719</TD><TD>        if (bundle == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">720</TD><TD>            return null;</TD></TR><TR><TD CLASS="l">721</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">722</TD><TD>        byte[] data = bundle.getByteArray(SESSION_BUNDLE_SAVE_KEY);</TD></TR><TR CLASS="z"><TD CLASS="l">723</TD><TD>        if (data != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">724</TD><TD>            ByteArrayInputStream is = new ByteArrayInputStream(data);</TD></TR><TR><TD CLASS="l">725</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">726</TD><TD>                Session session = (Session) (new ObjectInputStream(is)).readObject();</TD></TR><TR CLASS="z"><TD CLASS="l">727</TD><TD>                initializeStaticContext(context);</TD></TR><TR CLASS="z"><TD CLASS="l">728</TD><TD>                if (cachingStrategy != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">729</TD><TD>                    session.tokenCachingStrategy = cachingStrategy;</TD></TR><TR><TD CLASS="l">730</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">731</TD><TD>                    session.tokenCachingStrategy = new SharedPreferencesTokenCachingStrategy(context);</TD></TR><TR><TD CLASS="l">732</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">733</TD><TD>                if (callback != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">734</TD><TD>                    session.addCallback(callback);</TD></TR><TR><TD CLASS="l">735</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">736</TD><TD>                session.authorizationBundle = bundle.getBundle(AUTH_BUNDLE_SAVE_KEY);</TD></TR><TR CLASS="z"><TD CLASS="l">737</TD><TD>                return session;</TD></TR><TR CLASS="z"><TD CLASS="l">738</TD><TD>            } catch (ClassNotFoundException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">739</TD><TD>                Log.w(TAG, &#34;Unable to restore session&#34;, e);</TD></TR><TR CLASS="z"><TD CLASS="l">740</TD><TD>            } catch (IOException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">741</TD><TD>                Log.w(TAG, &#34;Unable to restore session.&#34;, e);</TD></TR><TR CLASS="z"><TD CLASS="l">742</TD><TD>            }</TD></TR><TR><TD CLASS="l">743</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">744</TD><TD>        return null;</TD></TR><TR><TD CLASS="l">745</TD><TD>    }</TD></TR><TR><TD CLASS="l">746</TD><TD> </TD></TR><TR><TD CLASS="l">747</TD><TD> </TD></TR><TR><TD CLASS="l">748</TD><TD>    /**</TD></TR><TR><TD CLASS="l">749</TD><TD>     * Returns the current active Session, or null if there is none.</TD></TR><TR><TD CLASS="l"><A NAME="ae">750</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">751</TD><TD>     * @return the current active Session, or null if there is none.</TD></TR><TR><TD CLASS="l">752</TD><TD>     */</TD></TR><TR><TD CLASS="l">753</TD><TD>    public static final Session getActiveSession() {</TD></TR><TR CLASS="c"><TD CLASS="l">754</TD><TD>        synchronized (Session.STATIC_LOCK) {</TD></TR><TR CLASS="c"><TD CLASS="l">755</TD><TD>            return Session.activeSession;</TD></TR><TR CLASS="z"><TD CLASS="l">756</TD><TD>        }</TD></TR><TR><TD CLASS="l">757</TD><TD>    }</TD></TR><TR><TD CLASS="l">758</TD><TD> </TD></TR><TR><TD CLASS="l">759</TD><TD>    /**</TD></TR><TR><TD CLASS="l">760</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">761</TD><TD>     * Sets the current active Session.</TD></TR><TR><TD CLASS="l">762</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">763</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">764</TD><TD>     * The active Session is used implicitly by predefined Request factory</TD></TR><TR><TD CLASS="l">765</TD><TD>     * methods as well as optionally by UI controls in the sdk.</TD></TR><TR><TD CLASS="l">766</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">767</TD><TD>     * &lt;p&gt;</TD></TR><TR><TD CLASS="l">768</TD><TD>     * It is legal to set this to null, or to a Session that is not yet open.</TD></TR><TR><TD CLASS="l">769</TD><TD>     * &lt;/p&gt;</TD></TR><TR><TD CLASS="l">770</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="b3">771</A></TD><TD>     * @param session A Session to use as the active Session, or null to indicate</TD></TR><TR><TD CLASS="l">772</TD><TD>     *                that there is no active Session.</TD></TR><TR><TD CLASS="l">773</TD><TD>     */</TD></TR><TR><TD CLASS="l">774</TD><TD>    public static final void setActiveSession(Session session) {</TD></TR><TR CLASS="c"><TD CLASS="l">775</TD><TD>        synchronized (Session.STATIC_LOCK) {</TD></TR><TR CLASS="c"><TD CLASS="l">776</TD><TD>            if (session != Session.activeSession) {</TD></TR><TR CLASS="c"><TD CLASS="l">777</TD><TD>                Session oldSession = Session.activeSession;</TD></TR><TR><TD CLASS="l">778</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">779</TD><TD>                if (oldSession != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">780</TD><TD>                    oldSession.close();</TD></TR><TR><TD CLASS="l">781</TD><TD>                }</TD></TR><TR><TD CLASS="l">782</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">783</TD><TD>                Session.activeSession = session;</TD></TR><TR><TD CLASS="l">784</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">785</TD><TD>                if (oldSession != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">786</TD><TD>                    postActiveSessionAction(Session.ACTION_ACTIVE_SESSION_UNSET);</TD></TR><TR><TD CLASS="l">787</TD><TD>                }</TD></TR><TR><TD CLASS="l">788</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">789</TD><TD>                if (session != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">790</TD><TD>                    postActiveSessionAction(Session.ACTION_ACTIVE_SESSION_SET);</TD></TR><TR><TD CLASS="l">791</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">792</TD><TD>                    if (session.isOpened()) {</TD></TR><TR CLASS="z"><TD CLASS="l">793</TD><TD>                        postActiveSessionAction(Session.ACTION_ACTIVE_SESSION_OPENED);</TD></TR><TR><TD CLASS="l">794</TD><TD>                    }</TD></TR><TR><TD CLASS="l">795</TD><TD>                }</TD></TR><TR><TD CLASS="l">796</TD><TD>            }</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="38% line coverage (3 out of 8 instructions)">797</TD><TD TITLE="38% line coverage (3 out of 8 instructions)">        }</TD></TR><TR CLASS="c"><TD CLASS="l">798</TD><TD>    }</TD></TR><TR><TD CLASS="l">799</TD><TD> </TD></TR><TR><TD CLASS="l">800</TD><TD>    /**</TD></TR><TR><TD CLASS="l">801</TD><TD>     * If a cached token is available, creates and opens the session and makes it active without any user interaction,</TD></TR><TR><TD CLASS="l">802</TD><TD>     * otherwise this does nothing.</TD></TR><TR><TD CLASS="l">803</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="96">804</A></TD><TD>     * @param context The Context creating this session</TD></TR><TR><TD CLASS="l">805</TD><TD>     * @return The new session or null if one could not be created</TD></TR><TR><TD CLASS="l">806</TD><TD>     */</TD></TR><TR><TD CLASS="l">807</TD><TD>    public static Session openActiveSessionFromCache(Context context) {</TD></TR><TR CLASS="z"><TD CLASS="l">808</TD><TD>        return openActiveSession(context, false, null);</TD></TR><TR><TD CLASS="l">809</TD><TD>    }</TD></TR><TR><TD CLASS="l">810</TD><TD> </TD></TR><TR><TD CLASS="l">811</TD><TD>    /**</TD></TR><TR><TD CLASS="l">812</TD><TD>     * If allowLoginUI is true, this will create a new Session, make it active, and</TD></TR><TR><TD CLASS="l">813</TD><TD>     * open it. If the default token cache is not available, then this will request</TD></TR><TR><TD CLASS="l">814</TD><TD>     * basic permissions. If the default token cache is available and cached tokens</TD></TR><TR><TD CLASS="l">815</TD><TD>     * are loaded, this will use the cached token and associated permissions.</TD></TR><TR><TD CLASS="l">816</TD><TD>     * &lt;p/&gt;</TD></TR><TR><TD CLASS="l">817</TD><TD>     * If allowedLoginUI is false, this will only create the active session and open</TD></TR><TR><TD CLASS="l">818</TD><TD>     * it if it requires no user interaction (i.e. the token cache is available and</TD></TR><TR><TD CLASS="l">819</TD><TD>     * there are cached tokens).</TD></TR><TR><TD CLASS="l">820</TD><TD>     *</TD></TR><TR><TD CLASS="l">821</TD><TD>     * @param activity     The Activity that is opening the new Session.</TD></TR><TR><TD CLASS="l">822</TD><TD>     * @param allowLoginUI if false, only sets the active session and opens it if it</TD></TR><TR><TD CLASS="l">823</TD><TD>     *                     does not require user interaction</TD></TR><TR><TD CLASS="l">824</TD><TD>     * @param callback     The {@link StatusCallback SessionStatusCallback} to</TD></TR><TR><TD CLASS="l">825</TD><TD>     *                     notify regarding Session state changes. May be null.</TD></TR><TR><TD CLASS="l"><A NAME="93">826</A></TD><TD>     * @return The new Session or null if one could not be created</TD></TR><TR><TD CLASS="l">827</TD><TD>     */</TD></TR><TR><TD CLASS="l">828</TD><TD>    public static Session openActiveSession(Activity activity, boolean allowLoginUI,</TD></TR><TR><TD CLASS="l">829</TD><TD>            StatusCallback callback) {</TD></TR><TR CLASS="z"><TD CLASS="l">830</TD><TD>        return openActiveSession(activity, allowLoginUI, new OpenRequest(activity).setCallback(callback));</TD></TR><TR><TD CLASS="l">831</TD><TD>    }</TD></TR><TR><TD CLASS="l">832</TD><TD> </TD></TR><TR><TD CLASS="l">833</TD><TD>    /**</TD></TR><TR><TD CLASS="l">834</TD><TD>     * If allowLoginUI is true, this will create a new Session, make it active, and</TD></TR><TR><TD CLASS="l">835</TD><TD>     * open it. If the default token cache is not available, then this will request</TD></TR><TR><TD CLASS="l">836</TD><TD>     * basic permissions. If the default token cache is available and cached tokens</TD></TR><TR><TD CLASS="l">837</TD><TD>     * are loaded, this will use the cached token and associated permissions.</TD></TR><TR><TD CLASS="l">838</TD><TD>     * &lt;p/&gt;</TD></TR><TR><TD CLASS="l">839</TD><TD>     * If allowedLoginUI is false, this will only create the active session and open</TD></TR><TR><TD CLASS="l">840</TD><TD>     * it if it requires no user interaction (i.e. the token cache is available and</TD></TR><TR><TD CLASS="l">841</TD><TD>     * there are cached tokens).</TD></TR><TR><TD CLASS="l">842</TD><TD>     *</TD></TR><TR><TD CLASS="l">843</TD><TD>     * @param context      The Activity or Service creating this Session</TD></TR><TR><TD CLASS="l">844</TD><TD>     * @param fragment     The Fragment that is opening the new Session.</TD></TR><TR><TD CLASS="l">845</TD><TD>     * @param allowLoginUI if false, only sets the active session and opens it if it</TD></TR><TR><TD CLASS="l">846</TD><TD>     *                     does not require user interaction</TD></TR><TR><TD CLASS="l">847</TD><TD>     * @param callback     The {@link StatusCallback SessionStatusCallback} to</TD></TR><TR><TD CLASS="l">848</TD><TD>     *                     notify regarding Session state changes.</TD></TR><TR><TD CLASS="l"><A NAME="94">849</A></TD><TD>     * @return The new Session or null if one could not be created</TD></TR><TR><TD CLASS="l">850</TD><TD>     */</TD></TR><TR><TD CLASS="l">851</TD><TD>    public static Session openActiveSession(Context context, Fragment fragment,</TD></TR><TR><TD CLASS="l">852</TD><TD>            boolean allowLoginUI, StatusCallback callback) {</TD></TR><TR CLASS="z"><TD CLASS="l">853</TD><TD>        return openActiveSession(context, allowLoginUI, new OpenRequest(fragment).setCallback(callback));</TD></TR><TR><TD CLASS="l">854</TD><TD>    }</TD></TR><TR><TD CLASS="l">855</TD><TD> </TD></TR><TR><TD CLASS="l">856</TD><TD>    /**</TD></TR><TR><TD CLASS="l">857</TD><TD>     * Opens a session based on an existing Facebook access token, and also makes this session</TD></TR><TR><TD CLASS="l">858</TD><TD>     * the currently active session. This method should be used</TD></TR><TR><TD CLASS="l">859</TD><TD>     * only in instances where an application has previously obtained an access token and wishes</TD></TR><TR><TD CLASS="l">860</TD><TD>     * to import it into the Session/TokenCachingStrategy-based session-management system. A primary</TD></TR><TR><TD CLASS="l">861</TD><TD>     * example would be an application which previously did not use the Facebook SDK for Android</TD></TR><TR><TD CLASS="l">862</TD><TD>     * and implemented its own session-management scheme, but wishes to implement an upgrade path</TD></TR><TR><TD CLASS="l">863</TD><TD>     * for existing users so they do not need to log in again when upgrading to a version of</TD></TR><TR><TD CLASS="l">864</TD><TD>     * the app that uses the SDK. In general, this method will be called only once, when the app</TD></TR><TR><TD CLASS="l">865</TD><TD>     * detects that it has been upgraded -- after that, the usual Session lifecycle methods</TD></TR><TR><TD CLASS="l">866</TD><TD>     * should be used to manage the session and its associated token.</TD></TR><TR><TD CLASS="l">867</TD><TD>     * &lt;p/&gt;</TD></TR><TR><TD CLASS="l">868</TD><TD>     * No validation is done that the token, token source, or permissions are actually valid.</TD></TR><TR><TD CLASS="l">869</TD><TD>     * It is the caller's responsibility to ensure that these accurately reflect the state of</TD></TR><TR><TD CLASS="l">870</TD><TD>     * the token that has been passed in, or calls to the Facebook API may fail.</TD></TR><TR><TD CLASS="l">871</TD><TD>     *</TD></TR><TR><TD CLASS="l">872</TD><TD>     * @param context     the Context to use for creation the session</TD></TR><TR><TD CLASS="l">873</TD><TD>     * @param accessToken the access token obtained from Facebook</TD></TR><TR><TD CLASS="l">874</TD><TD>     * @param callback    a callback that will be called when the session status changes; may be null</TD></TR><TR><TD CLASS="l"><A NAME="97">875</A></TD><TD>     * @return The new Session or null if one could not be created</TD></TR><TR><TD CLASS="l">876</TD><TD>     */</TD></TR><TR><TD CLASS="l">877</TD><TD>    public static Session openActiveSessionWithAccessToken(Context context, AccessToken accessToken,</TD></TR><TR><TD CLASS="l">878</TD><TD>            StatusCallback callback) {</TD></TR><TR CLASS="z"><TD CLASS="l">879</TD><TD>        Session session = new Session(context, null, null, false);</TD></TR><TR><TD CLASS="l">880</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">881</TD><TD>        setActiveSession(session);</TD></TR><TR CLASS="z"><TD CLASS="l">882</TD><TD>        session.open(accessToken, callback);</TD></TR><TR><TD CLASS="l">883</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="95">884</A></TD><TD>        return session;</TD></TR><TR><TD CLASS="l">885</TD><TD>    }</TD></TR><TR><TD CLASS="l">886</TD><TD> </TD></TR><TR><TD CLASS="l">887</TD><TD>    private static Session openActiveSession(Context context, boolean allowLoginUI, OpenRequest openRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">888</TD><TD>        Session session = new Builder(context).build();</TD></TR><TR CLASS="z"><TD CLASS="l">889</TD><TD>        if (SessionState.CREATED_TOKEN_LOADED.equals(session.getState()) || allowLoginUI) {</TD></TR><TR CLASS="z"><TD CLASS="l">890</TD><TD>            setActiveSession(session);</TD></TR><TR CLASS="z"><TD CLASS="l">891</TD><TD>            session.openForRead(openRequest);</TD></TR><TR CLASS="z"><TD CLASS="l">892</TD><TD>            return session;</TD></TR><TR><TD CLASS="l">893</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b9">894</A></TD><TD>        return null;</TD></TR><TR><TD CLASS="l">895</TD><TD>    }</TD></TR><TR><TD CLASS="l">896</TD><TD> </TD></TR><TR><TD CLASS="l">897</TD><TD>    static Context getStaticContext() {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="b6">898</A></TD><TD>        return staticContext;</TD></TR><TR><TD CLASS="l">899</TD><TD>    }</TD></TR><TR><TD CLASS="l">900</TD><TD> </TD></TR><TR><TD CLASS="l">901</TD><TD>    static void initializeStaticContext(Context currentContext) {</TD></TR><TR CLASS="c"><TD CLASS="l">902</TD><TD>        if ((currentContext != null) &amp;&amp; (staticContext == null)) {</TD></TR><TR CLASS="c"><TD CLASS="l">903</TD><TD>            Context applicationContext = currentContext.getApplicationContext();</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="89% line coverage (8 out of 9 instructions)">904</TD><TD TITLE="89% line coverage (8 out of 9 instructions)">            staticContext = (applicationContext != null) ? applicationContext : currentContext;</TD></TR><TR><TD CLASS="l"><A NAME="77">905</A></TD><TD>        }</TD></TR><TR CLASS="c"><TD CLASS="l">906</TD><TD>    }</TD></TR><TR><TD CLASS="l">907</TD><TD> </TD></TR><TR><TD CLASS="l">908</TD><TD>    void authorize(AuthorizationRequest request) {</TD></TR><TR CLASS="z"><TD CLASS="l">909</TD><TD>        boolean started = false;</TD></TR><TR><TD CLASS="l">910</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">911</TD><TD>        request.setApplicationId(applicationId);</TD></TR><TR><TD CLASS="l">912</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">913</TD><TD>        autoPublishAsync();</TD></TR><TR><TD CLASS="l">914</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">915</TD><TD>        logAuthorizationStart();</TD></TR><TR><TD CLASS="l">916</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">917</TD><TD>        started = tryLoginActivity(request);</TD></TR><TR><TD CLASS="l">918</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">919</TD><TD>        pendingAuthorizationRequest.loggingExtras.put(AuthorizationClient.EVENT_EXTRAS_TRY_LOGIN_ACTIVITY,</TD></TR><TR><TD CLASS="l">920</TD><TD>                started ? AppEventsConstants.EVENT_PARAM_VALUE_YES : AppEventsConstants.EVENT_PARAM_VALUE_NO);</TD></TR><TR><TD CLASS="l">921</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">922</TD><TD>        if (!started &amp;&amp; request.isLegacy) {</TD></TR><TR CLASS="z"><TD CLASS="l">923</TD><TD>            pendingAuthorizationRequest.loggingExtras.put(AuthorizationClient.EVENT_EXTRAS_TRY_LEGACY,</TD></TR><TR><TD CLASS="l">924</TD><TD>                    AppEventsConstants.EVENT_PARAM_VALUE_YES);</TD></TR><TR><TD CLASS="l">925</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">926</TD><TD>            tryLegacyAuth(request);</TD></TR><TR CLASS="z"><TD CLASS="l">927</TD><TD>            started = true;</TD></TR><TR><TD CLASS="l">928</TD><TD>        }</TD></TR><TR><TD CLASS="l">929</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">930</TD><TD>        if (!started) {</TD></TR><TR CLASS="z"><TD CLASS="l">931</TD><TD>            synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">932</TD><TD>                final SessionState oldState = this.state;</TD></TR><TR><TD CLASS="l">933</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">934</TD><TD>                switch (this.state) {</TD></TR><TR><TD CLASS="l">935</TD><TD>                    case CLOSED:</TD></TR><TR><TD CLASS="l">936</TD><TD>                    case CLOSED_LOGIN_FAILED:</TD></TR><TR CLASS="z"><TD CLASS="l">937</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">938</TD><TD> </TD></TR><TR><TD CLASS="l">939</TD><TD>                    default:</TD></TR><TR CLASS="z"><TD CLASS="l">940</TD><TD>                        this.state = SessionState.CLOSED_LOGIN_FAILED;</TD></TR><TR><TD CLASS="l">941</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">942</TD><TD>                        Exception exception = new FacebookException(</TD></TR><TR><TD CLASS="l">943</TD><TD>                                &#34;Log in attempt failed: LoginActivity could not be started, and not legacy request&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">944</TD><TD>                        logAuthorizationComplete(AuthorizationClient.Result.Code.ERROR, null, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">945</TD><TD>                        postStateChange(oldState, this.state, exception);</TD></TR><TR><TD CLASS="l">946</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">947</TD><TD>            }</TD></TR><TR><TD CLASS="l"><A NAME="92">948</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">949</TD><TD>    }</TD></TR><TR><TD CLASS="l">950</TD><TD> </TD></TR><TR><TD CLASS="l">951</TD><TD>    private void open(OpenRequest openRequest, SessionAuthorizationType authType) {</TD></TR><TR CLASS="z"><TD CLASS="l">952</TD><TD>        validatePermissions(openRequest, authType);</TD></TR><TR CLASS="z"><TD CLASS="l">953</TD><TD>        validateLoginBehavior(openRequest);</TD></TR><TR><TD CLASS="l">954</TD><TD> </TD></TR><TR><TD CLASS="l">955</TD><TD>        SessionState newState;</TD></TR><TR CLASS="z"><TD CLASS="l">956</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">957</TD><TD>            if (pendingAuthorizationRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">958</TD><TD>                postStateChange(state, state, new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">959</TD><TD>                        &#34;Session: an attempt was made to open a session that has a pending request.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">960</TD><TD>                return;</TD></TR><TR><TD CLASS="l">961</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">962</TD><TD>            final SessionState oldState = this.state;</TD></TR><TR><TD CLASS="l">963</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">964</TD><TD>            switch (this.state) {</TD></TR><TR><TD CLASS="l">965</TD><TD>                case CREATED:</TD></TR><TR CLASS="z"><TD CLASS="l">966</TD><TD>                    this.state = newState = SessionState.OPENING;</TD></TR><TR CLASS="z"><TD CLASS="l">967</TD><TD>                    if (openRequest == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">968</TD><TD>                        throw new IllegalArgumentException(&#34;openRequest cannot be null when opening a new Session&#34;);</TD></TR><TR><TD CLASS="l">969</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">970</TD><TD>                    pendingAuthorizationRequest = openRequest;</TD></TR><TR CLASS="z"><TD CLASS="l">971</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">972</TD><TD>                case CREATED_TOKEN_LOADED:</TD></TR><TR CLASS="z"><TD CLASS="l">973</TD><TD>                    if (openRequest != null &amp;&amp; !Utility.isNullOrEmpty(openRequest.getPermissions())) {</TD></TR><TR CLASS="z"><TD CLASS="l">974</TD><TD>                        if (!Utility.isSubset(openRequest.getPermissions(), getPermissions())) {</TD></TR><TR CLASS="z"><TD CLASS="l">975</TD><TD>                            pendingAuthorizationRequest = openRequest;</TD></TR><TR><TD CLASS="l">976</TD><TD>                        }</TD></TR><TR><TD CLASS="l">977</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">978</TD><TD>                    if (pendingAuthorizationRequest == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">979</TD><TD>                        this.state = newState = SessionState.OPENED;</TD></TR><TR><TD CLASS="l">980</TD><TD>                    } else {</TD></TR><TR CLASS="z"><TD CLASS="l">981</TD><TD>                        this.state = newState = SessionState.OPENING;</TD></TR><TR><TD CLASS="l">982</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">983</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">984</TD><TD>                default:</TD></TR><TR CLASS="z"><TD CLASS="l">985</TD><TD>                    throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">986</TD><TD>                            &#34;Session: an attempt was made to open an already opened session.&#34;);</TD></TR><TR><TD CLASS="l">987</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">988</TD><TD>            if (openRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">989</TD><TD>                addCallback(openRequest.getCallback());</TD></TR><TR><TD CLASS="l">990</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">991</TD><TD>            this.postStateChange(oldState, newState, null);</TD></TR><TR CLASS="z"><TD CLASS="l">992</TD><TD>        }</TD></TR><TR><TD CLASS="l">993</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">994</TD><TD>        if (newState == SessionState.OPENING) {</TD></TR><TR CLASS="z"><TD CLASS="l">995</TD><TD>            authorize(openRequest);</TD></TR><TR><TD CLASS="l"><A NAME="9c">996</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">997</TD><TD>    }</TD></TR><TR><TD CLASS="l">998</TD><TD> </TD></TR><TR><TD CLASS="l">999</TD><TD>    private void requestNewPermissions(NewPermissionsRequest newPermissionsRequest, SessionAuthorizationType authType) {</TD></TR><TR CLASS="z"><TD CLASS="l">1000</TD><TD>        validatePermissions(newPermissionsRequest, authType);</TD></TR><TR CLASS="z"><TD CLASS="l">1001</TD><TD>        validateLoginBehavior(newPermissionsRequest);</TD></TR><TR><TD CLASS="l">1002</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1003</TD><TD>        if (newPermissionsRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1004</TD><TD>            synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">1005</TD><TD>                if (pendingAuthorizationRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1006</TD><TD>                    throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">1007</TD><TD>                            &#34;Session: an attempt was made to request new permissions for a session that has a pending request.&#34;);</TD></TR><TR><TD CLASS="l">1008</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1009</TD><TD>                if (state.isOpened()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1010</TD><TD>                    pendingAuthorizationRequest = newPermissionsRequest;</TD></TR><TR CLASS="z"><TD CLASS="l">1011</TD><TD>                } else if (state.isClosed()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1012</TD><TD>                    throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">1013</TD><TD>                            &#34;Session: an attempt was made to request new permissions for a session that has been closed.&#34;);</TD></TR><TR><TD CLASS="l">1014</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1015</TD><TD>                    throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">1016</TD><TD>                            &#34;Session: an attempt was made to request new permissions for a session that is not currently open.&#34;);</TD></TR><TR><TD CLASS="l">1017</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1018</TD><TD>            }</TD></TR><TR><TD CLASS="l">1019</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1020</TD><TD>            newPermissionsRequest.setValidateSameFbidAsToken(getAccessToken());</TD></TR><TR CLASS="z"><TD CLASS="l">1021</TD><TD>            addCallback(newPermissionsRequest.getCallback());</TD></TR><TR CLASS="z"><TD CLASS="l">1022</TD><TD>            authorize(newPermissionsRequest);</TD></TR><TR><TD CLASS="l"><A NAME="ab">1023</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1024</TD><TD>    }</TD></TR><TR><TD CLASS="l">1025</TD><TD> </TD></TR><TR><TD CLASS="l">1026</TD><TD>    private void validateLoginBehavior(AuthorizationRequest request) {</TD></TR><TR CLASS="z"><TD CLASS="l">1027</TD><TD>        if (request != null &amp;&amp; !request.isLegacy) {</TD></TR><TR CLASS="z"><TD CLASS="l">1028</TD><TD>            Intent intent = new Intent();</TD></TR><TR CLASS="z"><TD CLASS="l">1029</TD><TD>            intent.setClass(getStaticContext(), LoginActivity.class);</TD></TR><TR CLASS="z"><TD CLASS="l">1030</TD><TD>            if (!resolveIntent(intent)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1031</TD><TD>                throw new FacebookException(String.format(</TD></TR><TR><TD CLASS="l">1032</TD><TD>                        &#34;Cannot use SessionLoginBehavior %s when %s is not declared as an activity in AndroidManifest.xml&#34;,</TD></TR><TR><TD CLASS="l">1033</TD><TD>                        request.getLoginBehavior(), LoginActivity.class.getName()));</TD></TR><TR><TD CLASS="l">1034</TD><TD>            }</TD></TR><TR><TD CLASS="l"><A NAME="ac">1035</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1036</TD><TD>    }</TD></TR><TR><TD CLASS="l">1037</TD><TD> </TD></TR><TR><TD CLASS="l">1038</TD><TD>    private void validatePermissions(AuthorizationRequest request, SessionAuthorizationType authType) {</TD></TR><TR CLASS="z"><TD CLASS="l">1039</TD><TD>        if (request == null || Utility.isNullOrEmpty(request.getPermissions())) {</TD></TR><TR CLASS="z"><TD CLASS="l">1040</TD><TD>            if (SessionAuthorizationType.PUBLISH.equals(authType)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1041</TD><TD>                throw new FacebookException(&#34;Cannot request publish or manage authorization with no permissions.&#34;);</TD></TR><TR><TD CLASS="l">1042</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1043</TD><TD>            return; // nothing to check</TD></TR><TR><TD CLASS="l">1044</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1045</TD><TD>        for (String permission : request.getPermissions()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1046</TD><TD>            if (isPublishPermission(permission)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1047</TD><TD>                if (SessionAuthorizationType.READ.equals(authType)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1048</TD><TD>                    throw new FacebookException(</TD></TR><TR><TD CLASS="l">1049</TD><TD>                            String.format(</TD></TR><TR><TD CLASS="l">1050</TD><TD>                                    &#34;Cannot pass a publish or manage permission (%s) to a request for read authorization&#34;,</TD></TR><TR><TD CLASS="l">1051</TD><TD>                                    permission));</TD></TR><TR><TD CLASS="l">1052</TD><TD>                }</TD></TR><TR><TD CLASS="l">1053</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1054</TD><TD>                if (SessionAuthorizationType.PUBLISH.equals(authType)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1055</TD><TD>                    Log.w(TAG,</TD></TR><TR><TD CLASS="l">1056</TD><TD>                            String.format(</TD></TR><TR><TD CLASS="l">1057</TD><TD>                                    &#34;Should not pass a read permission (%s) to a request for publish or manage authorization&#34;,</TD></TR><TR><TD CLASS="l">1058</TD><TD>                                    permission));</TD></TR><TR><TD CLASS="l">1059</TD><TD>                }</TD></TR><TR><TD CLASS="l">1060</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8d">1061</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1062</TD><TD>    }</TD></TR><TR><TD CLASS="l">1063</TD><TD> </TD></TR><TR><TD CLASS="l">1064</TD><TD>    public static boolean isPublishPermission(String permission) {</TD></TR><TR CLASS="z"><TD CLASS="l">1065</TD><TD>        return permission != null &amp;&amp;</TD></TR><TR><TD CLASS="l">1066</TD><TD>                (permission.startsWith(PUBLISH_PERMISSION_PREFIX) ||</TD></TR><TR><TD CLASS="l">1067</TD><TD>                        permission.startsWith(MANAGE_PERMISSION_PREFIX) ||</TD></TR><TR><TD CLASS="l">1068</TD><TD>                        OTHER_PUBLISH_PERMISSIONS.contains(permission));</TD></TR><TR><TD CLASS="l"><A NAME="8b">1069</A></TD><TD> </TD></TR><TR><TD CLASS="l">1070</TD><TD>    }</TD></TR><TR><TD CLASS="l">1071</TD><TD> </TD></TR><TR><TD CLASS="l">1072</TD><TD>    private void handleAuthorizationResult(int resultCode, AuthorizationClient.Result result) {</TD></TR><TR CLASS="z"><TD CLASS="l">1073</TD><TD>        AccessToken newToken = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1074</TD><TD>        Exception exception = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1075</TD><TD>        if (resultCode == Activity.RESULT_OK) {</TD></TR><TR CLASS="z"><TD CLASS="l">1076</TD><TD>            if (result.code == AuthorizationClient.Result.Code.SUCCESS) {</TD></TR><TR CLASS="z"><TD CLASS="l">1077</TD><TD>                newToken = result.token;</TD></TR><TR><TD CLASS="l">1078</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1079</TD><TD>                exception = new FacebookAuthorizationException(result.errorMessage);</TD></TR><TR><TD CLASS="l">1080</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1081</TD><TD>        } else if (resultCode == Activity.RESULT_CANCELED) {</TD></TR><TR CLASS="z"><TD CLASS="l">1082</TD><TD>            exception = new FacebookOperationCanceledException(result.errorMessage);</TD></TR><TR><TD CLASS="l">1083</TD><TD>        }</TD></TR><TR><TD CLASS="l">1084</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1085</TD><TD>        logAuthorizationComplete(result.code, result.loggingExtras, exception);</TD></TR><TR><TD CLASS="l">1086</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1087</TD><TD>        authorizationClient = null;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8f">1088</A></TD><TD>        finishAuthOrReauth(newToken, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">1089</TD><TD>    }</TD></TR><TR><TD CLASS="l">1090</TD><TD> </TD></TR><TR><TD CLASS="l">1091</TD><TD>    private void logAuthorizationStart() {</TD></TR><TR CLASS="z"><TD CLASS="l">1092</TD><TD>        Bundle bundle = AuthorizationClient.newAuthorizationLoggingBundle(pendingAuthorizationRequest.getAuthId());</TD></TR><TR CLASS="z"><TD CLASS="l">1093</TD><TD>        bundle.putLong(AuthorizationClient.EVENT_PARAM_TIMESTAMP, System.currentTimeMillis());</TD></TR><TR><TD CLASS="l">1094</TD><TD> </TD></TR><TR><TD CLASS="l">1095</TD><TD>        // Log what we already know about the call in start event</TD></TR><TR><TD CLASS="l">1096</TD><TD>        try {</TD></TR><TR CLASS="z"><TD CLASS="l">1097</TD><TD>            JSONObject extras = new JSONObject();</TD></TR><TR CLASS="z"><TD CLASS="l">1098</TD><TD>            extras.put(AuthorizationClient.EVENT_EXTRAS_LOGIN_BEHAVIOR,</TD></TR><TR><TD CLASS="l">1099</TD><TD>                    pendingAuthorizationRequest.loginBehavior.toString());</TD></TR><TR CLASS="z"><TD CLASS="l">1100</TD><TD>            extras.put(AuthorizationClient.EVENT_EXTRAS_REQUEST_CODE, pendingAuthorizationRequest.requestCode);</TD></TR><TR CLASS="z"><TD CLASS="l">1101</TD><TD>            extras.put(AuthorizationClient.EVENT_EXTRAS_IS_LEGACY, pendingAuthorizationRequest.isLegacy);</TD></TR><TR CLASS="z"><TD CLASS="l">1102</TD><TD>            extras.put(AuthorizationClient.EVENT_EXTRAS_PERMISSIONS,</TD></TR><TR><TD CLASS="l">1103</TD><TD>                    TextUtils.join(&#34;,&#34;, pendingAuthorizationRequest.permissions));</TD></TR><TR CLASS="z"><TD CLASS="l">1104</TD><TD>            extras.put(AuthorizationClient.EVENT_EXTRAS_DEFAULT_AUDIENCE,</TD></TR><TR><TD CLASS="l">1105</TD><TD>                    pendingAuthorizationRequest.defaultAudience.toString());</TD></TR><TR CLASS="z"><TD CLASS="l">1106</TD><TD>            bundle.putString(AuthorizationClient.EVENT_PARAM_EXTRAS, extras.toString());</TD></TR><TR CLASS="z"><TD CLASS="l">1107</TD><TD>        } catch (JSONException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1108</TD><TD>        }</TD></TR><TR><TD CLASS="l">1109</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1110</TD><TD>        AppEventsLogger logger = getAppEventsLogger();</TD></TR><TR CLASS="z"><TD CLASS="l">1111</TD><TD>        logger.logSdkEvent(AuthorizationClient.EVENT_NAME_LOGIN_START, null, bundle);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8e">1112</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1113</TD><TD> </TD></TR><TR><TD CLASS="l">1114</TD><TD>    private void logAuthorizationComplete(AuthorizationClient.Result.Code result, Map&lt;String, String&gt; resultExtras,</TD></TR><TR><TD CLASS="l">1115</TD><TD>            Exception exception) {</TD></TR><TR CLASS="z"><TD CLASS="l">1116</TD><TD>        Bundle bundle = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1117</TD><TD>        if (pendingAuthorizationRequest == null) {</TD></TR><TR><TD CLASS="l">1118</TD><TD>            // We don't expect this to happen, but if it does, log an event for diagnostic purposes.</TD></TR><TR CLASS="z"><TD CLASS="l">1119</TD><TD>            bundle = AuthorizationClient.newAuthorizationLoggingBundle(&#34;&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">1120</TD><TD>            bundle.putString(AuthorizationClient.EVENT_PARAM_LOGIN_RESULT,</TD></TR><TR><TD CLASS="l">1121</TD><TD>                    AuthorizationClient.Result.Code.ERROR.getLoggingValue());</TD></TR><TR CLASS="z"><TD CLASS="l">1122</TD><TD>            bundle.putString(AuthorizationClient.EVENT_PARAM_ERROR_MESSAGE,</TD></TR><TR><TD CLASS="l">1123</TD><TD>                    &#34;Unexpected call to logAuthorizationComplete with null pendingAuthorizationRequest.&#34;);</TD></TR><TR><TD CLASS="l">1124</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1125</TD><TD>            bundle = AuthorizationClient.newAuthorizationLoggingBundle(pendingAuthorizationRequest.getAuthId());</TD></TR><TR CLASS="z"><TD CLASS="l">1126</TD><TD>            if (result != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1127</TD><TD>                bundle.putString(AuthorizationClient.EVENT_PARAM_LOGIN_RESULT, result.getLoggingValue());</TD></TR><TR><TD CLASS="l">1128</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1129</TD><TD>            if (exception != null &amp;&amp; exception.getMessage() != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1130</TD><TD>                bundle.putString(AuthorizationClient.EVENT_PARAM_ERROR_MESSAGE, exception.getMessage());</TD></TR><TR><TD CLASS="l">1131</TD><TD>            }</TD></TR><TR><TD CLASS="l">1132</TD><TD> </TD></TR><TR><TD CLASS="l">1133</TD><TD>            // Combine extras from the request and from the result.</TD></TR><TR CLASS="z"><TD CLASS="l">1134</TD><TD>            JSONObject jsonObject = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1135</TD><TD>            if (pendingAuthorizationRequest.loggingExtras.isEmpty() == false) {</TD></TR><TR CLASS="z"><TD CLASS="l">1136</TD><TD>                jsonObject = new JSONObject(pendingAuthorizationRequest.loggingExtras);</TD></TR><TR><TD CLASS="l">1137</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1138</TD><TD>            if (resultExtras != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1139</TD><TD>                if (jsonObject == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1140</TD><TD>                    jsonObject = new JSONObject();</TD></TR><TR><TD CLASS="l">1141</TD><TD>                }</TD></TR><TR><TD CLASS="l">1142</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">1143</TD><TD>                    for (Map.Entry&lt;String, String&gt; entry : resultExtras.entrySet()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1144</TD><TD>                        jsonObject.put(entry.getKey(), entry.getValue());</TD></TR><TR CLASS="z"><TD CLASS="l">1145</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">1146</TD><TD>                } catch (JSONException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1147</TD><TD>                }</TD></TR><TR><TD CLASS="l">1148</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1149</TD><TD>            if (jsonObject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1150</TD><TD>                bundle.putString(AuthorizationClient.EVENT_PARAM_EXTRAS, jsonObject.toString());</TD></TR><TR><TD CLASS="l">1151</TD><TD>            }</TD></TR><TR><TD CLASS="l">1152</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1153</TD><TD>        bundle.putLong(AuthorizationClient.EVENT_PARAM_TIMESTAMP, System.currentTimeMillis());</TD></TR><TR><TD CLASS="l">1154</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1155</TD><TD>        AppEventsLogger logger = getAppEventsLogger();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="aa">1156</A></TD><TD>        logger.logSdkEvent(AuthorizationClient.EVENT_NAME_LOGIN_COMPLETE, null, bundle);</TD></TR><TR CLASS="z"><TD CLASS="l">1157</TD><TD>    }</TD></TR><TR><TD CLASS="l">1158</TD><TD> </TD></TR><TR><TD CLASS="l">1159</TD><TD>    private boolean tryLoginActivity(AuthorizationRequest request) {</TD></TR><TR CLASS="z"><TD CLASS="l">1160</TD><TD>        Intent intent = getLoginActivityIntent(request);</TD></TR><TR><TD CLASS="l">1161</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1162</TD><TD>        if (!resolveIntent(intent)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1163</TD><TD>            return false;</TD></TR><TR><TD CLASS="l">1164</TD><TD>        }</TD></TR><TR><TD CLASS="l">1165</TD><TD> </TD></TR><TR><TD CLASS="l">1166</TD><TD>        try {</TD></TR><TR CLASS="z"><TD CLASS="l">1167</TD><TD>            request.getStartActivityDelegate().startActivityForResult(intent, request.getRequestCode());</TD></TR><TR CLASS="z"><TD CLASS="l">1168</TD><TD>        } catch (ActivityNotFoundException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1169</TD><TD>            return false;</TD></TR><TR CLASS="z"><TD CLASS="l">1170</TD><TD>        }</TD></TR><TR><TD CLASS="l">1171</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="9f">1172</A></TD><TD>        return true;</TD></TR><TR><TD CLASS="l">1173</TD><TD>    }</TD></TR><TR><TD CLASS="l">1174</TD><TD> </TD></TR><TR><TD CLASS="l">1175</TD><TD>    private boolean resolveIntent(Intent intent) {</TD></TR><TR CLASS="z"><TD CLASS="l">1176</TD><TD>        ResolveInfo resolveInfo = getStaticContext().getPackageManager().resolveActivity(intent, 0);</TD></TR><TR CLASS="z"><TD CLASS="l">1177</TD><TD>        if (resolveInfo == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1178</TD><TD>            return false;</TD></TR><TR><TD CLASS="l">1179</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="88">1180</A></TD><TD>        return true;</TD></TR><TR><TD CLASS="l">1181</TD><TD>    }</TD></TR><TR><TD CLASS="l">1182</TD><TD> </TD></TR><TR><TD CLASS="l">1183</TD><TD>    private Intent getLoginActivityIntent(AuthorizationRequest request) {</TD></TR><TR CLASS="z"><TD CLASS="l">1184</TD><TD>        Intent intent = new Intent();</TD></TR><TR CLASS="z"><TD CLASS="l">1185</TD><TD>        intent.setClass(getStaticContext(), LoginActivity.class);</TD></TR><TR CLASS="z"><TD CLASS="l">1186</TD><TD>        intent.setAction(request.getLoginBehavior().toString());</TD></TR><TR><TD CLASS="l">1187</TD><TD> </TD></TR><TR><TD CLASS="l">1188</TD><TD>        // Let LoginActivity populate extras appropriately</TD></TR><TR CLASS="z"><TD CLASS="l">1189</TD><TD>        AuthorizationClient.AuthorizationRequest authClientRequest = request.getAuthorizationClientRequest();</TD></TR><TR CLASS="z"><TD CLASS="l">1190</TD><TD>        Bundle extras = LoginActivity.populateIntentExtras(authClientRequest);</TD></TR><TR CLASS="z"><TD CLASS="l">1191</TD><TD>        intent.putExtras(extras);</TD></TR><TR><TD CLASS="l">1192</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="a9">1193</A></TD><TD>        return intent;</TD></TR><TR><TD CLASS="l"><A NAME="0">1194</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1195</TD><TD> </TD></TR><TR><TD CLASS="l">1196</TD><TD>    private void tryLegacyAuth(final AuthorizationRequest request) {</TD></TR><TR CLASS="z"><TD CLASS="l">1197</TD><TD>        authorizationClient = new AuthorizationClient();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2">1198</A></TD><TD>        authorizationClient.setOnCompletedListener(new AuthorizationClient.OnCompletedListener() {</TD></TR><TR><TD CLASS="l">1199</TD><TD>            @Override</TD></TR><TR><TD CLASS="l">1200</TD><TD>            public void onCompleted(AuthorizationClient.Result result) {</TD></TR><TR><TD CLASS="l">1201</TD><TD>                int activityResult;</TD></TR><TR CLASS="z"><TD CLASS="l">1202</TD><TD>                if (result.code == AuthorizationClient.Result.Code.CANCEL) {</TD></TR><TR CLASS="z"><TD CLASS="l">1203</TD><TD>                    activityResult = Activity.RESULT_CANCELED;</TD></TR><TR><TD CLASS="l">1204</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1205</TD><TD>                    activityResult = Activity.RESULT_OK;</TD></TR><TR><TD CLASS="l">1206</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1207</TD><TD>                handleAuthorizationResult(activityResult, result);</TD></TR><TR CLASS="z"><TD CLASS="l">1208</TD><TD>            }</TD></TR><TR><TD CLASS="l">1209</TD><TD>        });</TD></TR><TR CLASS="z"><TD CLASS="l">1210</TD><TD>        authorizationClient.setContext(getStaticContext());</TD></TR><TR CLASS="z"><TD CLASS="l">1211</TD><TD>        authorizationClient.startOrContinueAuth(request.getAuthorizationClientRequest());</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="7f">1212</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1213</TD><TD> </TD></TR><TR><TD CLASS="l">1214</TD><TD>    void finishAuthOrReauth(AccessToken newToken, Exception exception) {</TD></TR><TR><TD CLASS="l">1215</TD><TD>        // If the token we came up with is expired/invalid, then auth failed.</TD></TR><TR CLASS="z"><TD CLASS="l">1216</TD><TD>        if ((newToken != null) &amp;&amp; newToken.isInvalid()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1217</TD><TD>            newToken = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1218</TD><TD>            exception = new FacebookException(&#34;Invalid access token.&#34;);</TD></TR><TR><TD CLASS="l">1219</TD><TD>        }</TD></TR><TR><TD CLASS="l">1220</TD><TD> </TD></TR><TR><TD CLASS="l">1221</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1222</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">1223</TD><TD>            switch (this.state) {</TD></TR><TR><TD CLASS="l">1224</TD><TD>                case OPENING:</TD></TR><TR><TD CLASS="l">1225</TD><TD>                    // This means we are authorizing for the first time in this Session.</TD></TR><TR CLASS="z"><TD CLASS="l">1226</TD><TD>                    finishAuthorization(newToken, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">1227</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">1228</TD><TD> </TD></TR><TR><TD CLASS="l">1229</TD><TD>                case OPENED:</TD></TR><TR><TD CLASS="l">1230</TD><TD>                case OPENED_TOKEN_UPDATED:</TD></TR><TR><TD CLASS="l">1231</TD><TD>                    // This means we are reauthorizing.</TD></TR><TR CLASS="z"><TD CLASS="l">1232</TD><TD>                    finishReauthorization(newToken, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">1233</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">1234</TD><TD> </TD></TR><TR><TD CLASS="l">1235</TD><TD>                case CREATED:</TD></TR><TR><TD CLASS="l">1236</TD><TD>                case CREATED_TOKEN_LOADED:</TD></TR><TR><TD CLASS="l">1237</TD><TD>                case CLOSED:</TD></TR><TR><TD CLASS="l">1238</TD><TD>                case CLOSED_LOGIN_FAILED:</TD></TR><TR CLASS="z"><TD CLASS="l">1239</TD><TD>                    Log.d(TAG, &#34;Unexpected call to finishAuthOrReauth in state &#34; + this.state);</TD></TR><TR><TD CLASS="l">1240</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">1241</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="80">1242</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1243</TD><TD>    }</TD></TR><TR><TD CLASS="l">1244</TD><TD> </TD></TR><TR><TD CLASS="l">1245</TD><TD>    private void finishAuthorization(AccessToken newToken, Exception exception) {</TD></TR><TR CLASS="z"><TD CLASS="l">1246</TD><TD>        final SessionState oldState = state;</TD></TR><TR CLASS="z"><TD CLASS="l">1247</TD><TD>        if (newToken != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1248</TD><TD>            tokenInfo = newToken;</TD></TR><TR CLASS="z"><TD CLASS="l">1249</TD><TD>            saveTokenToCache(newToken);</TD></TR><TR><TD CLASS="l">1250</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1251</TD><TD>            state = SessionState.OPENED;</TD></TR><TR CLASS="z"><TD CLASS="l">1252</TD><TD>        } else if (exception != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1253</TD><TD>            state = SessionState.CLOSED_LOGIN_FAILED;</TD></TR><TR><TD CLASS="l">1254</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1255</TD><TD>        pendingAuthorizationRequest = null;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="81">1256</A></TD><TD>        postStateChange(oldState, state, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">1257</TD><TD>    }</TD></TR><TR><TD CLASS="l">1258</TD><TD> </TD></TR><TR><TD CLASS="l">1259</TD><TD>    private void finishReauthorization(final AccessToken newToken, Exception exception) {</TD></TR><TR CLASS="z"><TD CLASS="l">1260</TD><TD>        final SessionState oldState = state;</TD></TR><TR><TD CLASS="l">1261</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1262</TD><TD>        if (newToken != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1263</TD><TD>            tokenInfo = newToken;</TD></TR><TR CLASS="z"><TD CLASS="l">1264</TD><TD>            saveTokenToCache(newToken);</TD></TR><TR><TD CLASS="l">1265</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1266</TD><TD>            state = SessionState.OPENED_TOKEN_UPDATED;</TD></TR><TR><TD CLASS="l">1267</TD><TD>        }</TD></TR><TR><TD CLASS="l">1268</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1269</TD><TD>        pendingAuthorizationRequest = null;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="a3">1270</A></TD><TD>        postStateChange(oldState, state, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">1271</TD><TD>    }</TD></TR><TR><TD CLASS="l">1272</TD><TD> </TD></TR><TR><TD CLASS="l">1273</TD><TD>    private void saveTokenToCache(AccessToken newToken) {</TD></TR><TR CLASS="z"><TD CLASS="l">1274</TD><TD>        if (newToken != null &amp;&amp; tokenCachingStrategy != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1275</TD><TD>            tokenCachingStrategy.save(newToken.toCacheBundle());</TD></TR><TR><TD CLASS="l">1276</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1277</TD><TD>    }</TD></TR><TR><TD CLASS="l">1278</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="9a">1279</A></TD><TD>    void postStateChange(final SessionState oldState, final SessionState newState, final Exception exception) {</TD></TR><TR><TD CLASS="l">1280</TD><TD>        // When we request new permissions, we stay in SessionState.OPENED_TOKEN_UPDATED,</TD></TR><TR><TD CLASS="l">1281</TD><TD>        // but we still want notifications of the state change since permissions are</TD></TR><TR><TD CLASS="l">1282</TD><TD>        // different now.</TD></TR><TR CLASS="z"><TD CLASS="l">1283</TD><TD>        if ((oldState == newState) &amp;&amp;</TD></TR><TR><TD CLASS="l">1284</TD><TD>                (oldState != SessionState.OPENED_TOKEN_UPDATED) &amp;&amp;</TD></TR><TR><TD CLASS="l">1285</TD><TD>                (exception == null)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1286</TD><TD>            return;</TD></TR><TR><TD CLASS="l">1287</TD><TD>        }</TD></TR><TR><TD CLASS="l">1288</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1289</TD><TD>        if (newState.isClosed()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1290</TD><TD>            this.tokenInfo = AccessToken.createEmptyToken(Collections.&lt;String&gt;emptyList());</TD></TR><TR><TD CLASS="l">1291</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="3">1292</A></TD><TD> </TD></TR><TR><TD CLASS="l">1293</TD><TD>        // Need to schedule the callbacks inside the same queue to preserve ordering.</TD></TR><TR><TD CLASS="l"><A NAME="5">1294</A></TD><TD>        // Otherwise these callbacks could have been added to the queue before the SessionTracker</TD></TR><TR><TD CLASS="l">1295</TD><TD>        // gets the ACTIVE_SESSION_SET action.</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="6">1296</A></TD><TD>        Runnable runCallbacks = new Runnable() {</TD></TR><TR><TD CLASS="l">1297</TD><TD>            public void run() {</TD></TR><TR CLASS="z"><TD CLASS="l">1298</TD><TD>                synchronized (callbacks) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8">1299</A></TD><TD>                    for (final StatusCallback callback : callbacks) {</TD></TR><TR CLASS="z"><TD CLASS="l">1300</TD><TD>                        Runnable closure = new Runnable() {</TD></TR><TR><TD CLASS="l">1301</TD><TD>                            public void run() {</TD></TR><TR><TD CLASS="l">1302</TD><TD>                                // This can be called inside a synchronized block.</TD></TR><TR CLASS="z"><TD CLASS="l">1303</TD><TD>                                callback.call(Session.this, newState, exception);</TD></TR><TR CLASS="z"><TD CLASS="l">1304</TD><TD>                            }</TD></TR><TR><TD CLASS="l">1305</TD><TD>                        };</TD></TR><TR><TD CLASS="l">1306</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1307</TD><TD>                        runWithHandlerOrExecutor(handler, closure);</TD></TR><TR CLASS="z"><TD CLASS="l">1308</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">1309</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1310</TD><TD>            }</TD></TR><TR><TD CLASS="l">1311</TD><TD>        };</TD></TR><TR CLASS="z"><TD CLASS="l">1312</TD><TD>        runWithHandlerOrExecutor(handler, runCallbacks);</TD></TR><TR><TD CLASS="l">1313</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1314</TD><TD>        if (this == Session.activeSession) {</TD></TR><TR CLASS="z"><TD CLASS="l">1315</TD><TD>            if (oldState.isOpened() != newState.isOpened()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1316</TD><TD>                if (newState.isOpened()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1317</TD><TD>                    postActiveSessionAction(Session.ACTION_ACTIVE_SESSION_OPENED);</TD></TR><TR><TD CLASS="l">1318</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1319</TD><TD>                    postActiveSessionAction(Session.ACTION_ACTIVE_SESSION_CLOSED);</TD></TR><TR><TD CLASS="l">1320</TD><TD>                }</TD></TR><TR><TD CLASS="l">1321</TD><TD>            }</TD></TR><TR><TD CLASS="l"><A NAME="ba">1322</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1323</TD><TD>    }</TD></TR><TR><TD CLASS="l">1324</TD><TD> </TD></TR><TR><TD CLASS="l">1325</TD><TD>    static void postActiveSessionAction(String action) {</TD></TR><TR CLASS="c"><TD CLASS="l">1326</TD><TD>        final Intent intent = new Intent(action);</TD></TR><TR><TD CLASS="l">1327</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="a1">1328</A></TD><TD>        LocalBroadcastManager.getInstance(getStaticContext()).sendBroadcast(intent);</TD></TR><TR CLASS="c"><TD CLASS="l">1329</TD><TD>    }</TD></TR><TR><TD CLASS="l">1330</TD><TD> </TD></TR><TR><TD CLASS="l">1331</TD><TD>    private static void runWithHandlerOrExecutor(Handler handler, Runnable runnable) {</TD></TR><TR CLASS="z"><TD CLASS="l">1332</TD><TD>        if (handler != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1333</TD><TD>            handler.post(runnable);</TD></TR><TR><TD CLASS="l">1334</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1335</TD><TD>            Settings.getExecutor().execute(runnable);</TD></TR><TR><TD CLASS="l"><A NAME="7d">1336</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1337</TD><TD>    }</TD></TR><TR><TD CLASS="l">1338</TD><TD> </TD></TR><TR><TD CLASS="l">1339</TD><TD>    void extendAccessTokenIfNeeded() {</TD></TR><TR CLASS="z"><TD CLASS="l">1340</TD><TD>        if (shouldExtendAccessToken()) {</TD></TR><TR CLASS="z"><TD CLASS="l">1341</TD><TD>            extendAccessToken();</TD></TR><TR><TD CLASS="l"><A NAME="7c">1342</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1343</TD><TD>    }</TD></TR><TR><TD CLASS="l">1344</TD><TD> </TD></TR><TR><TD CLASS="l">1345</TD><TD>    void extendAccessToken() {</TD></TR><TR CLASS="z"><TD CLASS="l">1346</TD><TD>        TokenRefreshRequest newTokenRefreshRequest = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1347</TD><TD>        synchronized (this.lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">1348</TD><TD>            if (currentTokenRefreshRequest == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1349</TD><TD>                newTokenRefreshRequest = new TokenRefreshRequest();</TD></TR><TR CLASS="z"><TD CLASS="l">1350</TD><TD>                currentTokenRefreshRequest = newTokenRefreshRequest;</TD></TR><TR><TD CLASS="l">1351</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1352</TD><TD>        }</TD></TR><TR><TD CLASS="l">1353</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1354</TD><TD>        if (newTokenRefreshRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1355</TD><TD>            newTokenRefreshRequest.bind();</TD></TR><TR><TD CLASS="l"><A NAME="a7">1356</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1357</TD><TD>    }</TD></TR><TR><TD CLASS="l">1358</TD><TD> </TD></TR><TR><TD CLASS="l">1359</TD><TD>    boolean shouldExtendAccessToken() {</TD></TR><TR CLASS="z"><TD CLASS="l">1360</TD><TD>        if (currentTokenRefreshRequest != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1361</TD><TD>            return false;</TD></TR><TR><TD CLASS="l">1362</TD><TD>        }</TD></TR><TR><TD CLASS="l">1363</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1364</TD><TD>        boolean result = false;</TD></TR><TR><TD CLASS="l">1365</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1366</TD><TD>        Date now = new Date();</TD></TR><TR><TD CLASS="l">1367</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1368</TD><TD>        if (state.isOpened() &amp;&amp; tokenInfo.getSource().canExtendToken()</TD></TR><TR><TD CLASS="l">1369</TD><TD>                &amp;&amp; now.getTime() - lastAttemptedTokenExtendDate.getTime() &gt; TOKEN_EXTEND_RETRY_SECONDS * 1000</TD></TR><TR><TD CLASS="l">1370</TD><TD>                &amp;&amp; now.getTime() - tokenInfo.getLastRefresh().getTime() &gt; TOKEN_EXTEND_THRESHOLD_SECONDS * 1000) {</TD></TR><TR CLASS="z"><TD CLASS="l">1371</TD><TD>            result = true;</TD></TR><TR><TD CLASS="l">1372</TD><TD>        }</TD></TR><TR><TD CLASS="l">1373</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="83">1374</A></TD><TD>        return result;</TD></TR><TR><TD CLASS="l">1375</TD><TD>    }</TD></TR><TR><TD CLASS="l">1376</TD><TD> </TD></TR><TR><TD CLASS="l">1377</TD><TD>    private AppEventsLogger getAppEventsLogger() {</TD></TR><TR CLASS="z"><TD CLASS="l">1378</TD><TD>        synchronized (lock) {</TD></TR><TR CLASS="z"><TD CLASS="l">1379</TD><TD>            if (appEventsLogger == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1380</TD><TD>                appEventsLogger = AppEventsLogger.newLogger(staticContext, applicationId);</TD></TR><TR><TD CLASS="l">1381</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1382</TD><TD>            return appEventsLogger;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8a">1383</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">1384</TD><TD>    }</TD></TR><TR><TD CLASS="l">1385</TD><TD> </TD></TR><TR><TD CLASS="l">1386</TD><TD>    AccessToken getTokenInfo() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="a6">1387</A></TD><TD>        return tokenInfo;</TD></TR><TR><TD CLASS="l">1388</TD><TD>    }</TD></TR><TR><TD CLASS="l">1389</TD><TD> </TD></TR><TR><TD CLASS="l">1390</TD><TD>    void setTokenInfo(AccessToken tokenInfo) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="87">1391</A></TD><TD>        this.tokenInfo = tokenInfo;</TD></TR><TR CLASS="z"><TD CLASS="l">1392</TD><TD>    }</TD></TR><TR><TD CLASS="l">1393</TD><TD> </TD></TR><TR><TD CLASS="l">1394</TD><TD>    Date getLastAttemptedTokenExtendDate() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="a5">1395</A></TD><TD>        return lastAttemptedTokenExtendDate;</TD></TR><TR><TD CLASS="l">1396</TD><TD>    }</TD></TR><TR><TD CLASS="l">1397</TD><TD> </TD></TR><TR><TD CLASS="l">1398</TD><TD>    void setLastAttemptedTokenExtendDate(Date lastAttemptedTokenExtendDate) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="a4">1399</A></TD><TD>        this.lastAttemptedTokenExtendDate = lastAttemptedTokenExtendDate;</TD></TR><TR CLASS="z"><TD CLASS="l">1400</TD><TD>    }</TD></TR><TR><TD CLASS="l">1401</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="5f">1402</A></TD><TD>    void setCurrentTokenRefreshRequest(TokenRefreshRequest request) {</TD></TR><TR CLASS="z"><TD CLASS="l">1403</TD><TD>        this.currentTokenRefreshRequest = request;</TD></TR><TR CLASS="z"><TD CLASS="l">1404</TD><TD>    }</TD></TR><TR><TD CLASS="l">1405</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1406</TD><TD>    class TokenRefreshRequest implements ServiceConnection {</TD></TR><TR><TD CLASS="l">1407</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1408</TD><TD>        final Messenger messageReceiver = new Messenger(</TD></TR><TR><TD CLASS="l">1409</TD><TD>                new TokenRefreshRequestHandler(Session.this, this));</TD></TR><TR><TD CLASS="l"><A NAME="62">1410</A></TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1411</TD><TD>        Messenger messageSender = null;</TD></TR><TR><TD CLASS="l">1412</TD><TD> </TD></TR><TR><TD CLASS="l">1413</TD><TD>        public void bind() {</TD></TR><TR CLASS="z"><TD CLASS="l">1414</TD><TD>            Intent intent = NativeProtocol.createTokenRefreshIntent(getStaticContext());</TD></TR><TR CLASS="z"><TD CLASS="l">1415</TD><TD>            if (intent != null</TD></TR><TR><TD CLASS="l">1416</TD><TD>                    &amp;&amp; staticContext.bindService(intent, this, Context.BIND_AUTO_CREATE)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1417</TD><TD>                setLastAttemptedTokenExtendDate(new Date());</TD></TR><TR><TD CLASS="l">1418</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1419</TD><TD>                cleanup();</TD></TR><TR><TD CLASS="l">1420</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="64">1421</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">1422</TD><TD> </TD></TR><TR><TD CLASS="l">1423</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">1424</TD><TD>        public void onServiceConnected(ComponentName className, IBinder service) {</TD></TR><TR CLASS="z"><TD CLASS="l">1425</TD><TD>            messageSender = new Messenger(service);</TD></TR><TR CLASS="z"><TD CLASS="l">1426</TD><TD>            refreshToken();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="65">1427</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">1428</TD><TD> </TD></TR><TR><TD CLASS="l">1429</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">1430</TD><TD>        public void onServiceDisconnected(ComponentName arg) {</TD></TR><TR CLASS="z"><TD CLASS="l">1431</TD><TD>            cleanup();</TD></TR><TR><TD CLASS="l">1432</TD><TD> </TD></TR><TR><TD CLASS="l">1433</TD><TD>            // We returned an error so there's no point in</TD></TR><TR><TD CLASS="l">1434</TD><TD>            // keeping the binding open.</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="63">1435</A></TD><TD>            staticContext.unbindService(TokenRefreshRequest.this);</TD></TR><TR CLASS="z"><TD CLASS="l">1436</TD><TD>        }</TD></TR><TR><TD CLASS="l">1437</TD><TD> </TD></TR><TR><TD CLASS="l">1438</TD><TD>        private void cleanup() {</TD></TR><TR CLASS="z"><TD CLASS="l">1439</TD><TD>            if (currentTokenRefreshRequest == this) {</TD></TR><TR CLASS="z"><TD CLASS="l">1440</TD><TD>                currentTokenRefreshRequest = null;</TD></TR><TR><TD CLASS="l"><A NAME="66">1441</A></TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1442</TD><TD>        }</TD></TR><TR><TD CLASS="l">1443</TD><TD> </TD></TR><TR><TD CLASS="l">1444</TD><TD>        private void refreshToken() {</TD></TR><TR CLASS="z"><TD CLASS="l">1445</TD><TD>            Bundle requestData = new Bundle();</TD></TR><TR CLASS="z"><TD CLASS="l">1446</TD><TD>            requestData.putString(AccessToken.ACCESS_TOKEN_KEY, getTokenInfo().getToken());</TD></TR><TR><TD CLASS="l">1447</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1448</TD><TD>            Message request = Message.obtain();</TD></TR><TR CLASS="z"><TD CLASS="l">1449</TD><TD>            request.setData(requestData);</TD></TR><TR CLASS="z"><TD CLASS="l">1450</TD><TD>            request.replyTo = messageReceiver;</TD></TR><TR><TD CLASS="l">1451</TD><TD> </TD></TR><TR><TD CLASS="l">1452</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">1453</TD><TD>                messageSender.send(request);</TD></TR><TR CLASS="z"><TD CLASS="l">1454</TD><TD>            } catch (RemoteException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1455</TD><TD>                cleanup();</TD></TR><TR CLASS="z"><TD CLASS="l">1456</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1457</TD><TD>        }</TD></TR><TR><TD CLASS="l">1458</TD><TD> </TD></TR><TR><TD CLASS="l">1459</TD><TD>    }</TD></TR><TR><TD CLASS="l">1460</TD><TD> </TD></TR><TR><TD CLASS="l">1461</TD><TD>    // Creating a static Handler class to reduce the possibility of a memory leak.</TD></TR><TR><TD CLASS="l">1462</TD><TD>    // Handler objects for the same thread all share a common Looper object, which they post messages</TD></TR><TR><TD CLASS="l">1463</TD><TD>    // to and read from. As messages contain target Handler, as long as there are messages with target</TD></TR><TR><TD CLASS="l">1464</TD><TD>    // handler in the message queue, the handler cannot be garbage collected. If handler is not static,</TD></TR><TR><TD CLASS="l">1465</TD><TD>    // the instance of the containing class also cannot be garbage collected even if it is destroyed.</TD></TR><TR><TD CLASS="l">1466</TD><TD>    static class TokenRefreshRequestHandler extends Handler {</TD></TR><TR><TD CLASS="l">1467</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="67">1468</A></TD><TD>        private WeakReference&lt;Session&gt; sessionWeakReference;</TD></TR><TR><TD CLASS="l">1469</TD><TD>        private WeakReference&lt;TokenRefreshRequest&gt; refreshRequestWeakReference;</TD></TR><TR><TD CLASS="l">1470</TD><TD> </TD></TR><TR><TD CLASS="l">1471</TD><TD>        TokenRefreshRequestHandler(Session session, TokenRefreshRequest refreshRequest) {</TD></TR><TR CLASS="z"><TD CLASS="l">1472</TD><TD>            super(Looper.getMainLooper());</TD></TR><TR CLASS="z"><TD CLASS="l">1473</TD><TD>            sessionWeakReference = new WeakReference&lt;Session&gt;(session);</TD></TR><TR CLASS="z"><TD CLASS="l">1474</TD><TD>            refreshRequestWeakReference = new WeakReference&lt;TokenRefreshRequest&gt;(refreshRequest);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="69">1475</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">1476</TD><TD> </TD></TR><TR><TD CLASS="l">1477</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">1478</TD><TD>        public void handleMessage(Message msg) {</TD></TR><TR CLASS="z"><TD CLASS="l">1479</TD><TD>            String token = msg.getData().getString(AccessToken.ACCESS_TOKEN_KEY);</TD></TR><TR CLASS="z"><TD CLASS="l">1480</TD><TD>            Session session = sessionWeakReference.get();</TD></TR><TR><TD CLASS="l">1481</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1482</TD><TD>            if (session != null &amp;&amp; token != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1483</TD><TD>                session.extendTokenCompleted(msg.getData());</TD></TR><TR><TD CLASS="l">1484</TD><TD>            }</TD></TR><TR><TD CLASS="l">1485</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1486</TD><TD>            TokenRefreshRequest request = refreshRequestWeakReference.get();</TD></TR><TR CLASS="z"><TD CLASS="l">1487</TD><TD>            if (request != null) {</TD></TR><TR><TD CLASS="l">1488</TD><TD>                // The refreshToken function should be called rarely,</TD></TR><TR><TD CLASS="l">1489</TD><TD>                // so there is no point in keeping the binding open.</TD></TR><TR CLASS="z"><TD CLASS="l">1490</TD><TD>                staticContext.unbindService(request);</TD></TR><TR CLASS="z"><TD CLASS="l">1491</TD><TD>                request.cleanup();</TD></TR><TR><TD CLASS="l">1492</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1493</TD><TD>        }</TD></TR><TR><TD CLASS="l">1494</TD><TD>    }</TD></TR><TR><TD CLASS="l">1495</TD><TD> </TD></TR><TR><TD CLASS="l">1496</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1497</TD><TD>     * Provides asynchronous notification of Session state changes.</TD></TR><TR><TD CLASS="l">1498</TD><TD>     *</TD></TR><TR><TD CLASS="l">1499</TD><TD>     * @see Session#open open</TD></TR><TR><TD CLASS="l">1500</TD><TD>     */</TD></TR><TR><TD CLASS="l">1501</TD><TD>    public interface StatusCallback {</TD></TR><TR><TD CLASS="l">1502</TD><TD>        public void call(Session session, SessionState state, Exception exception);</TD></TR><TR><TD CLASS="l"><A NAME="8c">1503</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1504</TD><TD> </TD></TR><TR><TD CLASS="l">1505</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">1506</TD><TD>    public int hashCode() {</TD></TR><TR CLASS="z"><TD CLASS="l">1507</TD><TD>        return 0;</TD></TR><TR><TD CLASS="l"><A NAME="7b">1508</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1509</TD><TD> </TD></TR><TR><TD CLASS="l">1510</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">1511</TD><TD>    public boolean equals(Object otherObj) {</TD></TR><TR CLASS="z"><TD CLASS="l">1512</TD><TD>        if (!(otherObj instanceof Session)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1513</TD><TD>            return false;</TD></TR><TR><TD CLASS="l">1514</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1515</TD><TD>        Session other = (Session) otherObj;</TD></TR><TR><TD CLASS="l">1516</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1517</TD><TD>        return areEqual(other.applicationId, applicationId) &amp;&amp;</TD></TR><TR><TD CLASS="l">1518</TD><TD>                areEqual(other.authorizationBundle, authorizationBundle) &amp;&amp;</TD></TR><TR><TD CLASS="l">1519</TD><TD>                areEqual(other.state, state) &amp;&amp;</TD></TR><TR><TD CLASS="l"><A NAME="76">1520</A></TD><TD>                areEqual(other.getExpirationDate(), getExpirationDate());</TD></TR><TR><TD CLASS="l">1521</TD><TD>    }</TD></TR><TR><TD CLASS="l">1522</TD><TD> </TD></TR><TR><TD CLASS="l">1523</TD><TD>    private static boolean areEqual(Object a, Object b) {</TD></TR><TR CLASS="z"><TD CLASS="l">1524</TD><TD>        if (a == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1525</TD><TD>            return b == null;</TD></TR><TR><TD CLASS="l">1526</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1527</TD><TD>            return a.equals(b);</TD></TR><TR><TD CLASS="l">1528</TD><TD>        }</TD></TR><TR><TD CLASS="l">1529</TD><TD>    }</TD></TR><TR><TD CLASS="l">1530</TD><TD> </TD></TR><TR><TD CLASS="l">1531</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1532</TD><TD>     * Builder class used to create a Session.</TD></TR><TR><TD CLASS="l">1533</TD><TD>     */</TD></TR><TR><TD CLASS="l">1534</TD><TD>    public static final class Builder {</TD></TR><TR><TD CLASS="l">1535</TD><TD>        private final Context context;</TD></TR><TR><TD CLASS="l">1536</TD><TD>        private String applicationId;</TD></TR><TR><TD CLASS="l">1537</TD><TD>        private TokenCachingStrategy tokenCachingStrategy;</TD></TR><TR><TD CLASS="l">1538</TD><TD> </TD></TR><TR><TD CLASS="l">1539</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="45">1540</A></TD><TD>         * Constructs a new Builder associated with the context.</TD></TR><TR><TD CLASS="l">1541</TD><TD>         *</TD></TR><TR><TD CLASS="l">1542</TD><TD>         * @param context the Activity or Service starting the Session</TD></TR><TR><TD CLASS="l">1543</TD><TD>         */</TD></TR><TR CLASS="z"><TD CLASS="l">1544</TD><TD>        public Builder(Context context) {</TD></TR><TR CLASS="z"><TD CLASS="l">1545</TD><TD>            this.context = context;</TD></TR><TR CLASS="z"><TD CLASS="l">1546</TD><TD>        }</TD></TR><TR><TD CLASS="l">1547</TD><TD> </TD></TR><TR><TD CLASS="l">1548</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1549</TD><TD>         * Sets the application id for the Session.</TD></TR><TR><TD CLASS="l">1550</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="48">1551</A></TD><TD>         * @param applicationId the application id</TD></TR><TR><TD CLASS="l">1552</TD><TD>         * @return the Builder instance</TD></TR><TR><TD CLASS="l">1553</TD><TD>         */</TD></TR><TR><TD CLASS="l">1554</TD><TD>        public Builder setApplicationId(final String applicationId) {</TD></TR><TR CLASS="z"><TD CLASS="l">1555</TD><TD>            this.applicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l">1556</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1557</TD><TD>        }</TD></TR><TR><TD CLASS="l">1558</TD><TD> </TD></TR><TR><TD CLASS="l">1559</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1560</TD><TD>         * Sets the TokenCachingStrategy for the Session.</TD></TR><TR><TD CLASS="l">1561</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="49">1562</A></TD><TD>         * @param tokenCachingStrategy the token cache to use</TD></TR><TR><TD CLASS="l">1563</TD><TD>         * @return the Builder instance</TD></TR><TR><TD CLASS="l">1564</TD><TD>         */</TD></TR><TR><TD CLASS="l">1565</TD><TD>        public Builder setTokenCachingStrategy(final TokenCachingStrategy tokenCachingStrategy) {</TD></TR><TR CLASS="z"><TD CLASS="l">1566</TD><TD>            this.tokenCachingStrategy = tokenCachingStrategy;</TD></TR><TR CLASS="z"><TD CLASS="l">1567</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1568</TD><TD>        }</TD></TR><TR><TD CLASS="l">1569</TD><TD> </TD></TR><TR><TD CLASS="l">1570</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1571</TD><TD>         * Build the Session.</TD></TR><TR><TD CLASS="l"><A NAME="47">1572</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1573</TD><TD>         * @return a new Session</TD></TR><TR><TD CLASS="l">1574</TD><TD>         */</TD></TR><TR><TD CLASS="l">1575</TD><TD>        public Session build() {</TD></TR><TR CLASS="z"><TD CLASS="l">1576</TD><TD>            return new Session(context, applicationId, tokenCachingStrategy);</TD></TR><TR><TD CLASS="l">1577</TD><TD>        }</TD></TR><TR><TD CLASS="l">1578</TD><TD>    }</TD></TR><TR><TD CLASS="l">1579</TD><TD> </TD></TR><TR><TD CLASS="l">1580</TD><TD>    interface StartActivityDelegate {</TD></TR><TR><TD CLASS="l">1581</TD><TD>        public void startActivityForResult(Intent intent, int requestCode);</TD></TR><TR><TD CLASS="l">1582</TD><TD> </TD></TR><TR><TD CLASS="l">1583</TD><TD>        public Activity getActivityContext();</TD></TR><TR><TD CLASS="l"><A NAME="78">1584</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1585</TD><TD> </TD></TR><TR><TD CLASS="l">1586</TD><TD>    @SuppressWarnings(&#34;deprecation&#34;)</TD></TR><TR><TD CLASS="l">1587</TD><TD>    private void autoPublishAsync() {</TD></TR><TR CLASS="z"><TD CLASS="l">1588</TD><TD>        AutoPublishAsyncTask asyncTask = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1589</TD><TD>        synchronized (this) {</TD></TR><TR CLASS="z"><TD CLASS="l">1590</TD><TD>            if (autoPublishAsyncTask == null &amp;&amp; Settings.getShouldAutoPublishInstall()) {</TD></TR><TR><TD CLASS="l">1591</TD><TD>                // copy the application id to guarantee thread safety against our container.</TD></TR><TR CLASS="z"><TD CLASS="l">1592</TD><TD>                String applicationId = Session.this.applicationId;</TD></TR><TR><TD CLASS="l">1593</TD><TD> </TD></TR><TR><TD CLASS="l">1594</TD><TD>                // skip publish if we don't have an application id.</TD></TR><TR CLASS="z"><TD CLASS="l">1595</TD><TD>                if (applicationId != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1596</TD><TD>                    asyncTask = autoPublishAsyncTask = new AutoPublishAsyncTask(applicationId, staticContext);</TD></TR><TR><TD CLASS="l">1597</TD><TD>                }</TD></TR><TR><TD CLASS="l">1598</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1599</TD><TD>        }</TD></TR><TR><TD CLASS="l">1600</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1601</TD><TD>        if (asyncTask != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1602</TD><TD>            asyncTask.execute();</TD></TR><TR><TD CLASS="l">1603</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1604</TD><TD>    }</TD></TR><TR><TD CLASS="l">1605</TD><TD> </TD></TR><TR><TD CLASS="l">1606</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1607</TD><TD>     * Async implementation to allow auto publishing to not block the ui thread.</TD></TR><TR><TD CLASS="l">1608</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="41">1609</A></TD><TD>    private class AutoPublishAsyncTask extends AsyncTask&lt;Void, Void, Void&gt; {</TD></TR><TR><TD CLASS="l">1610</TD><TD>        private final String mApplicationId;</TD></TR><TR><TD CLASS="l">1611</TD><TD>        private final Context mApplicationContext;</TD></TR><TR><TD CLASS="l">1612</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1613</TD><TD>        public AutoPublishAsyncTask(String applicationId, Context context) {</TD></TR><TR CLASS="z"><TD CLASS="l">1614</TD><TD>            mApplicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l">1615</TD><TD>            mApplicationContext = context.getApplicationContext();</TD></TR><TR CLASS="z"><TD CLASS="l">1616</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="43">1617</A></TD><TD> </TD></TR><TR><TD CLASS="l">1618</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">1619</TD><TD>        protected Void doInBackground(Void... voids) {</TD></TR><TR><TD CLASS="l">1620</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">1621</TD><TD>                Settings.publishInstallAndWaitForResponse(mApplicationContext, mApplicationId, true);</TD></TR><TR CLASS="z"><TD CLASS="l">1622</TD><TD>            } catch (Exception e) {</TD></TR><TR CLASS="z"><TD CLASS="l">1623</TD><TD>                Utility.logd(&#34;Facebook-publish&#34;, e);</TD></TR><TR CLASS="z"><TD CLASS="l">1624</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1625</TD><TD>            return null;</TD></TR><TR><TD CLASS="l">1626</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="44">1627</A></TD><TD> </TD></TR><TR><TD CLASS="l">1628</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">1629</TD><TD>        protected void onPostExecute(Void result) {</TD></TR><TR><TD CLASS="l">1630</TD><TD>            // always clear out the publisher to allow other invocations.</TD></TR><TR CLASS="z"><TD CLASS="l">1631</TD><TD>            synchronized (Session.this) {</TD></TR><TR CLASS="z"><TD CLASS="l">1632</TD><TD>                autoPublishAsyncTask = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1633</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1634</TD><TD>        }</TD></TR><TR><TD CLASS="l">1635</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="b">1636</A></TD><TD> </TD></TR><TR><TD CLASS="l">1637</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1638</TD><TD>     * Base class for authorization requests {@link OpenRequest} and {@link NewPermissionsRequest}.</TD></TR><TR><TD CLASS="l">1639</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l">1640</TD><TD>    public static class AuthorizationRequest implements Serializable {</TD></TR><TR><TD CLASS="l">1641</TD><TD> </TD></TR><TR><TD CLASS="l">1642</TD><TD>        private static final long serialVersionUID = 1L;</TD></TR><TR><TD CLASS="l">1643</TD><TD> </TD></TR><TR><TD CLASS="l">1644</TD><TD>        private final StartActivityDelegate startActivityDelegate;</TD></TR><TR CLASS="z"><TD CLASS="l">1645</TD><TD>        private SessionLoginBehavior loginBehavior = SessionLoginBehavior.SSO_WITH_FALLBACK;</TD></TR><TR CLASS="z"><TD CLASS="l">1646</TD><TD>        private int requestCode = DEFAULT_AUTHORIZE_ACTIVITY_CODE;</TD></TR><TR><TD CLASS="l">1647</TD><TD>        private StatusCallback statusCallback;</TD></TR><TR CLASS="z"><TD CLASS="l">1648</TD><TD>        private boolean isLegacy = false;</TD></TR><TR CLASS="z"><TD CLASS="l">1649</TD><TD>        private List&lt;String&gt; permissions = Collections.emptyList();</TD></TR><TR CLASS="z"><TD CLASS="l">1650</TD><TD>        private SessionDefaultAudience defaultAudience = SessionDefaultAudience.FRIENDS;</TD></TR><TR><TD CLASS="l">1651</TD><TD>        private String applicationId;</TD></TR><TR><TD CLASS="l"><A NAME="c">1652</A></TD><TD>        private String validateSameFbidAsToken;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2d">1653</A></TD><TD>        private final String authId = UUID.randomUUID().toString();</TD></TR><TR CLASS="z"><TD CLASS="l">1654</TD><TD>        private final Map&lt;String, String&gt; loggingExtras = new HashMap&lt;String, String&gt;();</TD></TR><TR><TD CLASS="l">1655</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="30">1656</A></TD><TD>        AuthorizationRequest(final Activity activity) {</TD></TR><TR CLASS="z"><TD CLASS="l">1657</TD><TD>            startActivityDelegate = new StartActivityDelegate() {</TD></TR><TR><TD CLASS="l">1658</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1659</TD><TD>                public void startActivityForResult(Intent intent, int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">1660</TD><TD>                    activity.startActivityForResult(intent, requestCode);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2f">1661</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">1662</TD><TD> </TD></TR><TR><TD CLASS="l">1663</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1664</TD><TD>                public Activity getActivityContext() {</TD></TR><TR CLASS="z"><TD CLASS="l">1665</TD><TD>                    return activity;</TD></TR><TR><TD CLASS="l"><A NAME="d">1666</A></TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="31">1667</A></TD><TD>            };</TD></TR><TR CLASS="z"><TD CLASS="l">1668</TD><TD>        }</TD></TR><TR><TD CLASS="l">1669</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="34">1670</A></TD><TD>        AuthorizationRequest(final Fragment fragment) {</TD></TR><TR CLASS="z"><TD CLASS="l">1671</TD><TD>            startActivityDelegate = new StartActivityDelegate() {</TD></TR><TR><TD CLASS="l">1672</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1673</TD><TD>                public void startActivityForResult(Intent intent, int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">1674</TD><TD>                    fragment.startActivityForResult(intent, requestCode);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="33">1675</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">1676</TD><TD> </TD></TR><TR><TD CLASS="l">1677</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1678</TD><TD>                public Activity getActivityContext() {</TD></TR><TR CLASS="z"><TD CLASS="l">1679</TD><TD>                    return fragment.getActivity();</TD></TR><TR><TD CLASS="l">1680</TD><TD>                }</TD></TR><TR><TD CLASS="l">1681</TD><TD>            };</TD></TR><TR CLASS="z"><TD CLASS="l">1682</TD><TD>        }</TD></TR><TR><TD CLASS="l">1683</TD><TD> </TD></TR><TR><TD CLASS="l">1684</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="e">1685</A></TD><TD>         * Constructor to be used for V1 serialization only, DO NOT CHANGE.</TD></TR><TR><TD CLASS="l"><A NAME="35">1686</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">1687</TD><TD>        private AuthorizationRequest(SessionLoginBehavior loginBehavior, int requestCode,</TD></TR><TR><TD CLASS="l">1688</TD><TD>                List&lt;String&gt; permissions, String defaultAudience, boolean isLegacy, String applicationId,</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="38">1689</A></TD><TD>                String validateSameFbidAsToken) {</TD></TR><TR CLASS="z"><TD CLASS="l">1690</TD><TD>            startActivityDelegate = new StartActivityDelegate() {</TD></TR><TR><TD CLASS="l">1691</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1692</TD><TD>                public void startActivityForResult(Intent intent, int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">1693</TD><TD>                    throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">1694</TD><TD>                            &#34;Cannot create an AuthorizationRequest without a valid Activity or Fragment&#34;);</TD></TR><TR><TD CLASS="l"><A NAME="37">1695</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">1696</TD><TD> </TD></TR><TR><TD CLASS="l">1697</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1698</TD><TD>                public Activity getActivityContext() {</TD></TR><TR CLASS="z"><TD CLASS="l">1699</TD><TD>                    throw new UnsupportedOperationException(</TD></TR><TR><TD CLASS="l">1700</TD><TD>                            &#34;Cannot create an AuthorizationRequest without a valid Activity or Fragment&#34;);</TD></TR><TR><TD CLASS="l">1701</TD><TD>                }</TD></TR><TR><TD CLASS="l">1702</TD><TD>            };</TD></TR><TR CLASS="z"><TD CLASS="l">1703</TD><TD>            this.loginBehavior = loginBehavior;</TD></TR><TR CLASS="z"><TD CLASS="l">1704</TD><TD>            this.requestCode = requestCode;</TD></TR><TR CLASS="z"><TD CLASS="l">1705</TD><TD>            this.permissions = permissions;</TD></TR><TR CLASS="z"><TD CLASS="l">1706</TD><TD>            this.defaultAudience = SessionDefaultAudience.valueOf(defaultAudience);</TD></TR><TR CLASS="z"><TD CLASS="l">1707</TD><TD>            this.isLegacy = isLegacy;</TD></TR><TR CLASS="z"><TD CLASS="l">1708</TD><TD>            this.applicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l">1709</TD><TD>            this.validateSameFbidAsToken = validateSameFbidAsToken;</TD></TR><TR CLASS="z"><TD CLASS="l">1710</TD><TD>        }</TD></TR><TR><TD CLASS="l">1711</TD><TD> </TD></TR><TR><TD CLASS="l">1712</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1713</TD><TD>         * Used for backwards compatibility with Facebook.java only, DO NOT USE.</TD></TR><TR><TD CLASS="l"><A NAME="26">1714</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1715</TD><TD>         * @param isLegacy</TD></TR><TR><TD CLASS="l">1716</TD><TD>         */</TD></TR><TR><TD CLASS="l">1717</TD><TD>        public void setIsLegacy(boolean isLegacy) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="21">1718</A></TD><TD>            this.isLegacy = isLegacy;</TD></TR><TR CLASS="z"><TD CLASS="l">1719</TD><TD>        }</TD></TR><TR><TD CLASS="l">1720</TD><TD> </TD></TR><TR><TD CLASS="l">1721</TD><TD>        boolean isLegacy() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="24">1722</A></TD><TD>            return isLegacy;</TD></TR><TR><TD CLASS="l">1723</TD><TD>        }</TD></TR><TR><TD CLASS="l">1724</TD><TD> </TD></TR><TR><TD CLASS="l">1725</TD><TD>        AuthorizationRequest setCallback(StatusCallback statusCallback) {</TD></TR><TR CLASS="z"><TD CLASS="l">1726</TD><TD>            this.statusCallback = statusCallback;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1a">1727</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1728</TD><TD>        }</TD></TR><TR><TD CLASS="l">1729</TD><TD> </TD></TR><TR><TD CLASS="l">1730</TD><TD>        StatusCallback getCallback() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="27">1731</A></TD><TD>            return statusCallback;</TD></TR><TR><TD CLASS="l">1732</TD><TD>        }</TD></TR><TR><TD CLASS="l">1733</TD><TD> </TD></TR><TR><TD CLASS="l">1734</TD><TD>        AuthorizationRequest setLoginBehavior(SessionLoginBehavior loginBehavior) {</TD></TR><TR CLASS="z"><TD CLASS="l">1735</TD><TD>            if (loginBehavior != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1736</TD><TD>                this.loginBehavior = loginBehavior;</TD></TR><TR><TD CLASS="l">1737</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1c">1738</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1739</TD><TD>        }</TD></TR><TR><TD CLASS="l">1740</TD><TD> </TD></TR><TR><TD CLASS="l">1741</TD><TD>        SessionLoginBehavior getLoginBehavior() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2a">1742</A></TD><TD>            return loginBehavior;</TD></TR><TR><TD CLASS="l">1743</TD><TD>        }</TD></TR><TR><TD CLASS="l">1744</TD><TD> </TD></TR><TR><TD CLASS="l">1745</TD><TD>        AuthorizationRequest setRequestCode(int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">1746</TD><TD>            if (requestCode &gt;= 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">1747</TD><TD>                this.requestCode = requestCode;</TD></TR><TR><TD CLASS="l">1748</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1e">1749</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1750</TD><TD>        }</TD></TR><TR><TD CLASS="l">1751</TD><TD> </TD></TR><TR><TD CLASS="l">1752</TD><TD>        int getRequestCode() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="28">1753</A></TD><TD>            return requestCode;</TD></TR><TR><TD CLASS="l">1754</TD><TD>        }</TD></TR><TR><TD CLASS="l">1755</TD><TD> </TD></TR><TR><TD CLASS="l">1756</TD><TD>        AuthorizationRequest setPermissions(List&lt;String&gt; permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1757</TD><TD>            if (permissions != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1758</TD><TD>                this.permissions = permissions;</TD></TR><TR><TD CLASS="l">1759</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="29">1760</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1761</TD><TD>        }</TD></TR><TR><TD CLASS="l">1762</TD><TD> </TD></TR><TR><TD CLASS="l">1763</TD><TD>        AuthorizationRequest setPermissions(String... permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1d">1764</A></TD><TD>            return setPermissions(Arrays.asList(permissions));</TD></TR><TR><TD CLASS="l">1765</TD><TD>        }</TD></TR><TR><TD CLASS="l">1766</TD><TD> </TD></TR><TR><TD CLASS="l">1767</TD><TD>        List&lt;String&gt; getPermissions() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="25">1768</A></TD><TD>            return permissions;</TD></TR><TR><TD CLASS="l">1769</TD><TD>        }</TD></TR><TR><TD CLASS="l">1770</TD><TD> </TD></TR><TR><TD CLASS="l">1771</TD><TD>        AuthorizationRequest setDefaultAudience(SessionDefaultAudience defaultAudience) {</TD></TR><TR CLASS="z"><TD CLASS="l">1772</TD><TD>            if (defaultAudience != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">1773</TD><TD>                this.defaultAudience = defaultAudience;</TD></TR><TR><TD CLASS="l">1774</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1b">1775</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1776</TD><TD>        }</TD></TR><TR><TD CLASS="l">1777</TD><TD> </TD></TR><TR><TD CLASS="l">1778</TD><TD>        SessionDefaultAudience getDefaultAudience() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1f">1779</A></TD><TD>            return defaultAudience;</TD></TR><TR><TD CLASS="l">1780</TD><TD>        }</TD></TR><TR><TD CLASS="l">1781</TD><TD> </TD></TR><TR><TD CLASS="l">1782</TD><TD>        StartActivityDelegate getStartActivityDelegate() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="17">1783</A></TD><TD>            return startActivityDelegate;</TD></TR><TR><TD CLASS="l">1784</TD><TD>        }</TD></TR><TR><TD CLASS="l">1785</TD><TD> </TD></TR><TR><TD CLASS="l">1786</TD><TD>        String getApplicationId() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="23">1787</A></TD><TD>            return applicationId;</TD></TR><TR><TD CLASS="l">1788</TD><TD>        }</TD></TR><TR><TD CLASS="l">1789</TD><TD> </TD></TR><TR><TD CLASS="l">1790</TD><TD>        void setApplicationId(String applicationId) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="20">1791</A></TD><TD>            this.applicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l">1792</TD><TD>        }</TD></TR><TR><TD CLASS="l">1793</TD><TD> </TD></TR><TR><TD CLASS="l">1794</TD><TD>        String getValidateSameFbidAsToken() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2b">1795</A></TD><TD>            return validateSameFbidAsToken;</TD></TR><TR><TD CLASS="l">1796</TD><TD>        }</TD></TR><TR><TD CLASS="l">1797</TD><TD> </TD></TR><TR><TD CLASS="l">1798</TD><TD>        void setValidateSameFbidAsToken(String validateSameFbidAsToken) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="18">1799</A></TD><TD>            this.validateSameFbidAsToken = validateSameFbidAsToken;</TD></TR><TR CLASS="z"><TD CLASS="l">1800</TD><TD>        }</TD></TR><TR><TD CLASS="l">1801</TD><TD> </TD></TR><TR><TD CLASS="l">1802</TD><TD>        String getAuthId() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="19">1803</A></TD><TD>            return authId;</TD></TR><TR><TD CLASS="l">1804</TD><TD>        }</TD></TR><TR><TD CLASS="l">1805</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="3c">1806</A></TD><TD>        AuthorizationClient.AuthorizationRequest getAuthorizationClientRequest() {</TD></TR><TR CLASS="z"><TD CLASS="l">1807</TD><TD>            AuthorizationClient.StartActivityDelegate delegate = new AuthorizationClient.StartActivityDelegate() {</TD></TR><TR><TD CLASS="l">1808</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1809</TD><TD>                public void startActivityForResult(Intent intent, int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">1810</TD><TD>                    startActivityDelegate.startActivityForResult(intent, requestCode);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3b">1811</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">1812</TD><TD> </TD></TR><TR><TD CLASS="l">1813</TD><TD>                @Override</TD></TR><TR><TD CLASS="l">1814</TD><TD>                public Activity getActivityContext() {</TD></TR><TR CLASS="z"><TD CLASS="l">1815</TD><TD>                    return startActivityDelegate.getActivityContext();</TD></TR><TR><TD CLASS="l">1816</TD><TD>                }</TD></TR><TR><TD CLASS="l">1817</TD><TD>            };</TD></TR><TR CLASS="z"><TD CLASS="l">1818</TD><TD>            return new AuthorizationClient.AuthorizationRequest(loginBehavior, requestCode, isLegacy,</TD></TR><TR><TD CLASS="l">1819</TD><TD>                    permissions, defaultAudience, applicationId, validateSameFbidAsToken, delegate, authId);</TD></TR><TR><TD CLASS="l"><A NAME="2c">1820</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">1821</TD><TD> </TD></TR><TR><TD CLASS="l">1822</TD><TD>        // package private so subclasses can use it</TD></TR><TR><TD CLASS="l">1823</TD><TD>        Object writeReplace() {</TD></TR><TR CLASS="z"><TD CLASS="l">1824</TD><TD>            return new AuthRequestSerializationProxyV1(</TD></TR><TR><TD CLASS="l">1825</TD><TD>                    loginBehavior, requestCode, permissions, defaultAudience.name(), isLegacy, applicationId, validateSameFbidAsToken);</TD></TR><TR><TD CLASS="l">1826</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="22">1827</A></TD><TD> </TD></TR><TR><TD CLASS="l">1828</TD><TD>        // have a readObject that throws to prevent spoofing; must be private so serializer will call it (will be</TD></TR><TR><TD CLASS="l">1829</TD><TD>        // called automatically prior to any base class)</TD></TR><TR><TD CLASS="l"><A NAME="3d">1830</A></TD><TD>        private void readObject(ObjectInputStream stream) throws InvalidObjectException {</TD></TR><TR CLASS="z"><TD CLASS="l">1831</TD><TD>            throw new InvalidObjectException(&#34;Cannot readObject, serialization proxy required&#34;);</TD></TR><TR><TD CLASS="l">1832</TD><TD>        }</TD></TR><TR><TD CLASS="l">1833</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1834</TD><TD>        private static class AuthRequestSerializationProxyV1 implements Serializable {</TD></TR><TR><TD CLASS="l">1835</TD><TD>            private static final long serialVersionUID = -8748347685113614927L;</TD></TR><TR><TD CLASS="l">1836</TD><TD>            private final SessionLoginBehavior loginBehavior;</TD></TR><TR><TD CLASS="l">1837</TD><TD>            private final int requestCode;</TD></TR><TR><TD CLASS="l">1838</TD><TD>            private boolean isLegacy;</TD></TR><TR><TD CLASS="l">1839</TD><TD>            private final List&lt;String&gt; permissions;</TD></TR><TR><TD CLASS="l">1840</TD><TD>            private final String defaultAudience;</TD></TR><TR><TD CLASS="l">1841</TD><TD>            private final String applicationId;</TD></TR><TR><TD CLASS="l"><A NAME="3e">1842</A></TD><TD>            private final String validateSameFbidAsToken;</TD></TR><TR><TD CLASS="l">1843</TD><TD> </TD></TR><TR><TD CLASS="l">1844</TD><TD>            private AuthRequestSerializationProxyV1(SessionLoginBehavior loginBehavior,</TD></TR><TR><TD CLASS="l">1845</TD><TD>                    int requestCode, List&lt;String&gt; permissions, String defaultAudience, boolean isLegacy,</TD></TR><TR CLASS="z"><TD CLASS="l">1846</TD><TD>                    String applicationId, String validateSameFbidAsToken) {</TD></TR><TR CLASS="z"><TD CLASS="l">1847</TD><TD>                this.loginBehavior = loginBehavior;</TD></TR><TR CLASS="z"><TD CLASS="l">1848</TD><TD>                this.requestCode = requestCode;</TD></TR><TR CLASS="z"><TD CLASS="l">1849</TD><TD>                this.permissions = permissions;</TD></TR><TR CLASS="z"><TD CLASS="l">1850</TD><TD>                this.defaultAudience = defaultAudience;</TD></TR><TR CLASS="z"><TD CLASS="l">1851</TD><TD>                this.isLegacy = isLegacy;</TD></TR><TR CLASS="z"><TD CLASS="l">1852</TD><TD>                this.applicationId = applicationId;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="40">1853</A></TD><TD>                this.validateSameFbidAsToken = validateSameFbidAsToken;</TD></TR><TR CLASS="z"><TD CLASS="l">1854</TD><TD>            }</TD></TR><TR><TD CLASS="l">1855</TD><TD> </TD></TR><TR><TD CLASS="l">1856</TD><TD>            private Object readResolve() {</TD></TR><TR CLASS="z"><TD CLASS="l">1857</TD><TD>                return new AuthorizationRequest(loginBehavior, requestCode, permissions, defaultAudience, isLegacy,</TD></TR><TR><TD CLASS="l">1858</TD><TD>                        applicationId, validateSameFbidAsToken);</TD></TR><TR><TD CLASS="l">1859</TD><TD>            }</TD></TR><TR><TD CLASS="l">1860</TD><TD>        }</TD></TR><TR><TD CLASS="l">1861</TD><TD>    }</TD></TR><TR><TD CLASS="l">1862</TD><TD> </TD></TR><TR><TD CLASS="l">1863</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1864</TD><TD>     * A request used to open a Session.</TD></TR><TR><TD CLASS="l">1865</TD><TD>     */</TD></TR><TR><TD CLASS="l">1866</TD><TD>    public static final class OpenRequest extends AuthorizationRequest {</TD></TR><TR><TD CLASS="l">1867</TD><TD>        private static final long serialVersionUID = 1L;</TD></TR><TR><TD CLASS="l">1868</TD><TD> </TD></TR><TR><TD CLASS="l">1869</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1870</TD><TD>         * Constructs an OpenRequest.</TD></TR><TR><TD CLASS="l"><A NAME="53">1871</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1872</TD><TD>         * @param activity the Activity to use to open the Session</TD></TR><TR><TD CLASS="l">1873</TD><TD>         */</TD></TR><TR><TD CLASS="l">1874</TD><TD>        public OpenRequest(Activity activity) {</TD></TR><TR CLASS="z"><TD CLASS="l">1875</TD><TD>            super(activity);</TD></TR><TR CLASS="z"><TD CLASS="l">1876</TD><TD>        }</TD></TR><TR><TD CLASS="l">1877</TD><TD> </TD></TR><TR><TD CLASS="l">1878</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1879</TD><TD>         * Constructs an OpenRequest.</TD></TR><TR><TD CLASS="l"><A NAME="55">1880</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1881</TD><TD>         * @param fragment the Fragment to use to open the Session</TD></TR><TR><TD CLASS="l">1882</TD><TD>         */</TD></TR><TR><TD CLASS="l">1883</TD><TD>        public OpenRequest(Fragment fragment) {</TD></TR><TR CLASS="z"><TD CLASS="l">1884</TD><TD>            super(fragment);</TD></TR><TR CLASS="z"><TD CLASS="l">1885</TD><TD>        }</TD></TR><TR><TD CLASS="l">1886</TD><TD> </TD></TR><TR><TD CLASS="l">1887</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1888</TD><TD>         * Sets the StatusCallback for the OpenRequest.</TD></TR><TR><TD CLASS="l">1889</TD><TD>         *</TD></TR><TR><TD CLASS="l">1890</TD><TD>         * @param statusCallback The {@link StatusCallback SessionStatusCallback} to</TD></TR><TR><TD CLASS="l"><A NAME="56">1891</A></TD><TD>         *                       notify regarding Session state changes.</TD></TR><TR><TD CLASS="l">1892</TD><TD>         * @return the OpenRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">1893</TD><TD>         */</TD></TR><TR><TD CLASS="l">1894</TD><TD>        public final OpenRequest setCallback(StatusCallback statusCallback) {</TD></TR><TR CLASS="z"><TD CLASS="l">1895</TD><TD>            super.setCallback(statusCallback);</TD></TR><TR CLASS="z"><TD CLASS="l">1896</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1897</TD><TD>        }</TD></TR><TR><TD CLASS="l">1898</TD><TD> </TD></TR><TR><TD CLASS="l">1899</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1900</TD><TD>         * Sets the login behavior for the OpenRequest.</TD></TR><TR><TD CLASS="l">1901</TD><TD>         *</TD></TR><TR><TD CLASS="l">1902</TD><TD>         * @param loginBehavior The {@link SessionLoginBehavior SessionLoginBehavior} that</TD></TR><TR><TD CLASS="l">1903</TD><TD>         *                      specifies what behaviors should be attempted during</TD></TR><TR><TD CLASS="l"><A NAME="58">1904</A></TD><TD>         *                      authorization.</TD></TR><TR><TD CLASS="l">1905</TD><TD>         * @return the OpenRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">1906</TD><TD>         */</TD></TR><TR><TD CLASS="l">1907</TD><TD>        public final OpenRequest setLoginBehavior(SessionLoginBehavior loginBehavior) {</TD></TR><TR CLASS="z"><TD CLASS="l">1908</TD><TD>            super.setLoginBehavior(loginBehavior);</TD></TR><TR CLASS="z"><TD CLASS="l">1909</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1910</TD><TD>        }</TD></TR><TR><TD CLASS="l">1911</TD><TD> </TD></TR><TR><TD CLASS="l">1912</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1913</TD><TD>         * Sets the request code for the OpenRequest.</TD></TR><TR><TD CLASS="l">1914</TD><TD>         *</TD></TR><TR><TD CLASS="l">1915</TD><TD>         * @param requestCode An integer that identifies this request. This integer will be used</TD></TR><TR><TD CLASS="l">1916</TD><TD>         *                    as the request code in {@link Activity#onActivityResult</TD></TR><TR><TD CLASS="l">1917</TD><TD>         *                    onActivityResult}. This integer should be &gt;= 0. If a value &lt; 0 is</TD></TR><TR><TD CLASS="l"><A NAME="5b">1918</A></TD><TD>         *                    passed in, then a default value will be used.</TD></TR><TR><TD CLASS="l">1919</TD><TD>         * @return the OpenRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">1920</TD><TD>         */</TD></TR><TR><TD CLASS="l">1921</TD><TD>        public final OpenRequest setRequestCode(int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">1922</TD><TD>            super.setRequestCode(requestCode);</TD></TR><TR CLASS="z"><TD CLASS="l">1923</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1924</TD><TD>        }</TD></TR><TR><TD CLASS="l">1925</TD><TD> </TD></TR><TR><TD CLASS="l">1926</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1927</TD><TD>         * Sets the permissions for the OpenRequest.</TD></TR><TR><TD CLASS="l">1928</TD><TD>         *</TD></TR><TR><TD CLASS="l">1929</TD><TD>         * @param permissions A List&amp;lt;String&amp;gt; representing the permissions to request</TD></TR><TR><TD CLASS="l">1930</TD><TD>         *                    during the authentication flow. A null or empty List</TD></TR><TR><TD CLASS="l"><A NAME="59">1931</A></TD><TD>         *                    represents basic permissions.</TD></TR><TR><TD CLASS="l">1932</TD><TD>         * @return the OpenRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">1933</TD><TD>         */</TD></TR><TR><TD CLASS="l">1934</TD><TD>        public final OpenRequest setPermissions(List&lt;String&gt; permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1935</TD><TD>            super.setPermissions(permissions);</TD></TR><TR CLASS="z"><TD CLASS="l">1936</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1937</TD><TD>        }</TD></TR><TR><TD CLASS="l">1938</TD><TD> </TD></TR><TR><TD CLASS="l">1939</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1940</TD><TD>         * Sets the permissions for the OpenRequest.</TD></TR><TR><TD CLASS="l">1941</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="5a">1942</A></TD><TD>         * @param permissions the permissions to request during the authentication flow.</TD></TR><TR><TD CLASS="l">1943</TD><TD>         * @return the OpenRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">1944</TD><TD>         */</TD></TR><TR><TD CLASS="l">1945</TD><TD>        public final OpenRequest setPermissions(String... permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1946</TD><TD>            super.setPermissions(permissions);</TD></TR><TR CLASS="z"><TD CLASS="l">1947</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1948</TD><TD>        }</TD></TR><TR><TD CLASS="l">1949</TD><TD> </TD></TR><TR><TD CLASS="l">1950</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1951</TD><TD>         * Sets the defaultAudience for the OpenRequest.</TD></TR><TR><TD CLASS="l">1952</TD><TD>         * &lt;p/&gt;</TD></TR><TR><TD CLASS="l">1953</TD><TD>         * This is only used during Native login using a sufficiently recent facebook app.</TD></TR><TR><TD CLASS="l">1954</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="57">1955</A></TD><TD>         * @param defaultAudience A SessionDefaultAudience representing the default audience setting to request.</TD></TR><TR><TD CLASS="l">1956</TD><TD>         * @return the OpenRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">1957</TD><TD>         */</TD></TR><TR><TD CLASS="l">1958</TD><TD>        public final OpenRequest setDefaultAudience(SessionDefaultAudience defaultAudience) {</TD></TR><TR CLASS="z"><TD CLASS="l">1959</TD><TD>            super.setDefaultAudience(defaultAudience);</TD></TR><TR CLASS="z"><TD CLASS="l">1960</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">1961</TD><TD>        }</TD></TR><TR><TD CLASS="l">1962</TD><TD>    }</TD></TR><TR><TD CLASS="l">1963</TD><TD> </TD></TR><TR><TD CLASS="l">1964</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1965</TD><TD>     * A request to be used to request new permissions for a Session.</TD></TR><TR><TD CLASS="l">1966</TD><TD>     */</TD></TR><TR><TD CLASS="l">1967</TD><TD>    public static final class NewPermissionsRequest extends AuthorizationRequest {</TD></TR><TR><TD CLASS="l">1968</TD><TD>        private static final long serialVersionUID = 1L;</TD></TR><TR><TD CLASS="l">1969</TD><TD> </TD></TR><TR><TD CLASS="l">1970</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1971</TD><TD>         * Constructs a NewPermissionsRequest.</TD></TR><TR><TD CLASS="l">1972</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="4a">1973</A></TD><TD>         * @param activity    the Activity used to issue the request</TD></TR><TR><TD CLASS="l">1974</TD><TD>         * @param permissions additional permissions to request</TD></TR><TR><TD CLASS="l">1975</TD><TD>         */</TD></TR><TR><TD CLASS="l">1976</TD><TD>        public NewPermissionsRequest(Activity activity, List&lt;String&gt; permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1977</TD><TD>            super(activity);</TD></TR><TR CLASS="z"><TD CLASS="l">1978</TD><TD>            setPermissions(permissions);</TD></TR><TR CLASS="z"><TD CLASS="l">1979</TD><TD>        }</TD></TR><TR><TD CLASS="l">1980</TD><TD> </TD></TR><TR><TD CLASS="l">1981</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1982</TD><TD>         * Constructs a NewPermissionsRequest.</TD></TR><TR><TD CLASS="l">1983</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="4d">1984</A></TD><TD>         * @param fragment    the Fragment used to issue the request</TD></TR><TR><TD CLASS="l">1985</TD><TD>         * @param permissions additional permissions to request</TD></TR><TR><TD CLASS="l">1986</TD><TD>         */</TD></TR><TR><TD CLASS="l">1987</TD><TD>        public NewPermissionsRequest(Fragment fragment, List&lt;String&gt; permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1988</TD><TD>            super(fragment);</TD></TR><TR CLASS="z"><TD CLASS="l">1989</TD><TD>            setPermissions(permissions);</TD></TR><TR CLASS="z"><TD CLASS="l">1990</TD><TD>        }</TD></TR><TR><TD CLASS="l">1991</TD><TD> </TD></TR><TR><TD CLASS="l">1992</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1993</TD><TD>         * Constructs a NewPermissionsRequest.</TD></TR><TR><TD CLASS="l">1994</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="4c">1995</A></TD><TD>         * @param activity    the Activity used to issue the request</TD></TR><TR><TD CLASS="l">1996</TD><TD>         * @param permissions additional permissions to request</TD></TR><TR><TD CLASS="l">1997</TD><TD>         */</TD></TR><TR><TD CLASS="l">1998</TD><TD>        public NewPermissionsRequest(Activity activity, String... permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1999</TD><TD>            super(activity);</TD></TR><TR CLASS="z"><TD CLASS="l">2000</TD><TD>            setPermissions(permissions);</TD></TR><TR CLASS="z"><TD CLASS="l">2001</TD><TD>        }</TD></TR><TR><TD CLASS="l">2002</TD><TD> </TD></TR><TR><TD CLASS="l">2003</TD><TD>        /**</TD></TR><TR><TD CLASS="l">2004</TD><TD>         * Constructs a NewPermissionsRequest.</TD></TR><TR><TD CLASS="l">2005</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="4e">2006</A></TD><TD>         * @param fragment    the Fragment used to issue the request</TD></TR><TR><TD CLASS="l">2007</TD><TD>         * @param permissions additional permissions to request</TD></TR><TR><TD CLASS="l">2008</TD><TD>         */</TD></TR><TR><TD CLASS="l">2009</TD><TD>        public NewPermissionsRequest(Fragment fragment, String... permissions) {</TD></TR><TR CLASS="z"><TD CLASS="l">2010</TD><TD>            super(fragment);</TD></TR><TR CLASS="z"><TD CLASS="l">2011</TD><TD>            setPermissions(permissions);</TD></TR><TR CLASS="z"><TD CLASS="l">2012</TD><TD>        }</TD></TR><TR><TD CLASS="l">2013</TD><TD> </TD></TR><TR><TD CLASS="l">2014</TD><TD>        /**</TD></TR><TR><TD CLASS="l">2015</TD><TD>         * Sets the StatusCallback for the NewPermissionsRequest. Note that once the request is made, this callback</TD></TR><TR><TD CLASS="l">2016</TD><TD>         * will be added to the session, and will receive all future state changes on the session.</TD></TR><TR><TD CLASS="l">2017</TD><TD>         *</TD></TR><TR><TD CLASS="l">2018</TD><TD>         * @param statusCallback The {@link StatusCallback SessionStatusCallback} to</TD></TR><TR><TD CLASS="l"><A NAME="4f">2019</A></TD><TD>         *                       notify regarding Session state changes.</TD></TR><TR><TD CLASS="l">2020</TD><TD>         * @return the NewPermissionsRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">2021</TD><TD>         */</TD></TR><TR><TD CLASS="l">2022</TD><TD>        public final NewPermissionsRequest setCallback(StatusCallback statusCallback) {</TD></TR><TR CLASS="z"><TD CLASS="l">2023</TD><TD>            super.setCallback(statusCallback);</TD></TR><TR CLASS="z"><TD CLASS="l">2024</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">2025</TD><TD>        }</TD></TR><TR><TD CLASS="l">2026</TD><TD> </TD></TR><TR><TD CLASS="l">2027</TD><TD>        /**</TD></TR><TR><TD CLASS="l">2028</TD><TD>         * Sets the login behavior for the NewPermissionsRequest.</TD></TR><TR><TD CLASS="l">2029</TD><TD>         *</TD></TR><TR><TD CLASS="l">2030</TD><TD>         * @param loginBehavior The {@link SessionLoginBehavior SessionLoginBehavior} that</TD></TR><TR><TD CLASS="l">2031</TD><TD>         *                      specifies what behaviors should be attempted during</TD></TR><TR><TD CLASS="l"><A NAME="51">2032</A></TD><TD>         *                      authorization.</TD></TR><TR><TD CLASS="l">2033</TD><TD>         * @return the NewPermissionsRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">2034</TD><TD>         */</TD></TR><TR><TD CLASS="l">2035</TD><TD>        public final NewPermissionsRequest setLoginBehavior(SessionLoginBehavior loginBehavior) {</TD></TR><TR CLASS="z"><TD CLASS="l">2036</TD><TD>            super.setLoginBehavior(loginBehavior);</TD></TR><TR CLASS="z"><TD CLASS="l">2037</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">2038</TD><TD>        }</TD></TR><TR><TD CLASS="l">2039</TD><TD> </TD></TR><TR><TD CLASS="l">2040</TD><TD>        /**</TD></TR><TR><TD CLASS="l">2041</TD><TD>         * Sets the request code for the NewPermissionsRequest.</TD></TR><TR><TD CLASS="l">2042</TD><TD>         *</TD></TR><TR><TD CLASS="l">2043</TD><TD>         * @param requestCode An integer that identifies this request. This integer will be used</TD></TR><TR><TD CLASS="l">2044</TD><TD>         *                    as the request code in {@link Activity#onActivityResult</TD></TR><TR><TD CLASS="l">2045</TD><TD>         *                    onActivityResult}. This integer should be &gt;= 0. If a value &lt; 0 is</TD></TR><TR><TD CLASS="l"><A NAME="52">2046</A></TD><TD>         *                    passed in, then a default value will be used.</TD></TR><TR><TD CLASS="l">2047</TD><TD>         * @return the NewPermissionsRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">2048</TD><TD>         */</TD></TR><TR><TD CLASS="l">2049</TD><TD>        public final NewPermissionsRequest setRequestCode(int requestCode) {</TD></TR><TR CLASS="z"><TD CLASS="l">2050</TD><TD>            super.setRequestCode(requestCode);</TD></TR><TR CLASS="z"><TD CLASS="l">2051</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">2052</TD><TD>        }</TD></TR><TR><TD CLASS="l">2053</TD><TD> </TD></TR><TR><TD CLASS="l">2054</TD><TD>        /**</TD></TR><TR><TD CLASS="l">2055</TD><TD>         * Sets the defaultAudience for the OpenRequest.</TD></TR><TR><TD CLASS="l">2056</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="50">2057</A></TD><TD>         * @param defaultAudience A SessionDefaultAudience representing the default audience setting to request.</TD></TR><TR><TD CLASS="l">2058</TD><TD>         * @return the NewPermissionsRequest object to allow for chaining</TD></TR><TR><TD CLASS="l">2059</TD><TD>         */</TD></TR><TR><TD CLASS="l">2060</TD><TD>        public final NewPermissionsRequest setDefaultAudience(SessionDefaultAudience defaultAudience) {</TD></TR><TR CLASS="z"><TD CLASS="l">2061</TD><TD>            super.setDefaultAudience(defaultAudience);</TD></TR><TR CLASS="z"><TD CLASS="l">2062</TD><TD>            return this;</TD></TR><TR><TD CLASS="l">2063</TD><TD>        }</TD></TR><TR><TD CLASS="l">2064</TD><TD>    }</TD></TR><TR><TD CLASS="l">2065</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="5.html">com.facebook</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>