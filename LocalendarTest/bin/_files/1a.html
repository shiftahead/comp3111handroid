<HTML><HEAD><META CONTENT="text/html; charset=UTF-8" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Sun May 04 22:10:52 HKT 2014)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="3.html">com.facebook.widget</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">GraphObjectAdapter.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>GraphObjectAdapter.java</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/72)</TD><TD CLASS="h">0%   (0/1550)</TD><TD CLASS="h">0%   (0/359)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">GraphObjectAdapter</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/61)</TD><TD CLASS="h">0%   (0/1416)</TD><TD CLASS="h">0%   (0/342)</TD></TR><TR><TD CLASS="f"><A HREF="#0">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">GraphObjectAdapter (Context): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/40)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#0">access$000 (GraphObjectAdapter): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#0">access$100 (GraphObject, GraphObject, Collection, Collator): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#0">access$200 (GraphObjectAdapter, ImageResponse, String, ImageView): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6">areAllItemsEnabled (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#7">callOnErrorListener (Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">changeCursor (GraphObjectCursor): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/19)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#9">compareGraphObjects (GraphObject, GraphObject, Collection, Collator): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/47)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a">createGraphObjectView (GraphObject): View</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/51)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#b">downloadProfilePicture (String, URI, ImageView): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/54)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">filterIncludesItem (GraphObject): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#d">getActivityCircleView (View, ViewGroup): View</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">getCount (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/39)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#f">getCursor (): GraphObjectCursor</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">getDataNeededListener (): GraphObjectAdapter$DataNeededListener</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">getDefaultPicture (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#12">getFilter (): GraphObjectAdapter$Filter</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#13">getGraphObjectRowLayoutId (GraphObject): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#14">getGraphObjectView (GraphObject, View, ViewGroup): View</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="f"><A HREF="#15">getGraphObjectsById (Collection): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/39)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#16">getGroupByField (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#17">getIdOfGraphObject (GraphObject): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#18">getItem (int): Object</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/13)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#19">getItemId (int): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1a">getItemViewType (int): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#1b">getOnErrorListener (): GraphObjectAdapter$OnErrorListener</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1c">getPictureFieldSpecifier (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/33)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#1d">getPictureUriOfGraphObject (GraphObject): URI</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/41)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1e">getPosition (String, GraphObject): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/75)</TD><TD CLASS="h">0%   (0/20)</TD></TR><TR><TD CLASS="f"><A HREF="#1f">getPositionForSection (int): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/29)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#20">getSectionAndItem (int): GraphObjectAdapter$SectionAndItem</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/115)</TD><TD CLASS="h">0%   (0/26)</TD></TR><TR><TD CLASS="f"><A HREF="#21">getSectionForPosition (int): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#22">getSectionHeaderView (String, View, ViewGroup): View</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="f"><A HREF="#23">getSectionKeyOfGraphObject (GraphObject): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/28)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#24">getSections (): Object []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#25">getShowCheckbox (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#26">getShowPicture (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#27">getSortFields (): List</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#28">getSubTitleOfGraphObject (GraphObject): CharSequence</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#29">getTitleOfGraphObject (GraphObject): CharSequence</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2a">getView (int, View, ViewGroup): View</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/50)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#2b">getViewTypeCount (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2c">hasStableIds (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#2d">isEmpty (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2e">isEnabled (int): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#2f">isGraphObjectSelected (String): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#30">populateGraphObjectView (View, GraphObject): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/101)</TD><TD CLASS="h">0%   (0/27)</TD></TR><TR><TD CLASS="f"><A HREF="#31">prioritizeViewRange (int, int, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/132)</TD><TD CLASS="h">0%   (0/29)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#32">processImageResponse (ImageResponse, String, ImageView): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/64)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR><TD CLASS="f"><A HREF="#33">rebuildAndNotify (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#34">rebuildSections (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/129)</TD><TD CLASS="h">0%   (0/28)</TD></TR><TR><TD CLASS="f"><A HREF="#35">setDataNeededListener (GraphObjectAdapter$DataNeededListener): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#36">setFilter (GraphObjectAdapter$Filter): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#37">setGroupByField (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#38">setOnErrorListener (GraphObjectAdapter$OnErrorListener): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#39">setShowCheckbox (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3a">setShowPicture (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3b">setSortFields (List): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3c">shouldShowActivityCircleCell (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#3d">updateCheckboxState (CheckBox, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3e">GraphObjectAdapter$1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3e">GraphObjectAdapter$1 (GraphObjectAdapter, Collator): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#40">compare (GraphObject, GraphObject): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#41">GraphObjectAdapter$2</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#41">GraphObjectAdapter$2 (GraphObjectAdapter, String, ImageView): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#43">onCompleted (ImageResponse): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#44">GraphObjectAdapter$3</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#44">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#46">GraphObjectAdapter$SectionAndItem</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#46">GraphObjectAdapter$SectionAndItem (String, GraphObject): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#48">getType (): GraphObjectAdapter$SectionAndItem$Type</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#49">GraphObjectAdapter$SectionAndItem$Type</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/48)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#4a">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#49">GraphObjectAdapter$SectionAndItem$Type (String, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#49">valueOf (String): GraphObjectAdapter$SectionAndItem$Type</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#49">values (): GraphObjectAdapter$SectionAndItem$Type []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>/**</TD></TR><TR><TD CLASS="l">2</TD><TD> * Copyright 2010-present Facebook.</TD></TR><TR><TD CLASS="l">3</TD><TD> *</TD></TR><TR><TD CLASS="l">4</TD><TD> * Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);</TD></TR><TR><TD CLASS="l">5</TD><TD> * you may not use this file except in compliance with the License.</TD></TR><TR><TD CLASS="l">6</TD><TD> * You may obtain a copy of the License at</TD></TR><TR><TD CLASS="l">7</TD><TD> *</TD></TR><TR><TD CLASS="l">8</TD><TD> *    http://www.apache.org/licenses/LICENSE-2.0</TD></TR><TR><TD CLASS="l">9</TD><TD> *</TD></TR><TR><TD CLASS="l">10</TD><TD> * Unless required by applicable law or agreed to in writing, software</TD></TR><TR><TD CLASS="l">11</TD><TD> * distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</TD></TR><TR><TD CLASS="l">12</TD><TD> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</TD></TR><TR><TD CLASS="l">13</TD><TD> * See the License for the specific language governing permissions and</TD></TR><TR><TD CLASS="l">14</TD><TD> * limitations under the License.</TD></TR><TR><TD CLASS="l">15</TD><TD> */</TD></TR><TR><TD CLASS="l">16</TD><TD> </TD></TR><TR><TD CLASS="l">17</TD><TD>package com.facebook.widget;</TD></TR><TR><TD CLASS="l">18</TD><TD> </TD></TR><TR><TD CLASS="l">19</TD><TD>import android.content.Context;</TD></TR><TR><TD CLASS="l">20</TD><TD>import android.graphics.Bitmap;</TD></TR><TR><TD CLASS="l">21</TD><TD>import android.view.LayoutInflater;</TD></TR><TR><TD CLASS="l">22</TD><TD>import android.view.View;</TD></TR><TR><TD CLASS="l">23</TD><TD>import android.view.ViewGroup;</TD></TR><TR><TD CLASS="l">24</TD><TD>import android.view.ViewStub;</TD></TR><TR><TD CLASS="l">25</TD><TD>import android.widget.*;</TD></TR><TR><TD CLASS="l">26</TD><TD>import com.facebook.*;</TD></TR><TR><TD CLASS="l">27</TD><TD>import com.facebook.android.R;</TD></TR><TR><TD CLASS="l">28</TD><TD>import com.facebook.internal.ImageDownloader;</TD></TR><TR><TD CLASS="l">29</TD><TD>import com.facebook.internal.ImageRequest;</TD></TR><TR><TD CLASS="l">30</TD><TD>import com.facebook.internal.ImageResponse;</TD></TR><TR><TD CLASS="l">31</TD><TD>import com.facebook.model.GraphObject;</TD></TR><TR><TD CLASS="l">32</TD><TD>import org.json.JSONObject;</TD></TR><TR><TD CLASS="l">33</TD><TD> </TD></TR><TR><TD CLASS="l">34</TD><TD>import java.net.URI;</TD></TR><TR><TD CLASS="l"><A NAME="0">35</A></TD><TD>import java.net.URISyntaxException;</TD></TR><TR><TD CLASS="l">36</TD><TD>import java.text.Collator;</TD></TR><TR><TD CLASS="l">37</TD><TD>import java.util.*;</TD></TR><TR><TD CLASS="l">38</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">39</TD><TD>class GraphObjectAdapter&lt;T extends GraphObject&gt; extends BaseAdapter implements SectionIndexer {</TD></TR><TR><TD CLASS="l">40</TD><TD>    private static final int DISPLAY_SECTIONS_THRESHOLD = 1;</TD></TR><TR><TD CLASS="l">41</TD><TD>    private static final int HEADER_VIEW_TYPE = 0;</TD></TR><TR><TD CLASS="l">42</TD><TD>    private static final int GRAPH_OBJECT_VIEW_TYPE = 1;</TD></TR><TR><TD CLASS="l">43</TD><TD>    private static final int ACTIVITY_CIRCLE_VIEW_TYPE = 2;</TD></TR><TR><TD CLASS="l">44</TD><TD>    private static final int MAX_PREFETCHED_PICTURES = 20;</TD></TR><TR><TD CLASS="l">45</TD><TD> </TD></TR><TR><TD CLASS="l">46</TD><TD>    private static final String ID = &#34;id&#34;;</TD></TR><TR><TD CLASS="l">47</TD><TD>    private static final String NAME = &#34;name&#34;;</TD></TR><TR><TD CLASS="l">48</TD><TD>    private static final String PICTURE = &#34;picture&#34;;</TD></TR><TR><TD CLASS="l">49</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">50</TD><TD>    private final Map&lt;String, ImageRequest&gt; pendingRequests = new HashMap&lt;String, ImageRequest&gt;();</TD></TR><TR><TD CLASS="l">51</TD><TD>    private final LayoutInflater inflater;</TD></TR><TR CLASS="z"><TD CLASS="l">52</TD><TD>    private List&lt;String&gt; sectionKeys = new ArrayList&lt;String&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">53</TD><TD>    private Map&lt;String, ArrayList&lt;T&gt;&gt; graphObjectsBySection = new HashMap&lt;String, ArrayList&lt;T&gt;&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">54</TD><TD>    private Map&lt;String, T&gt; graphObjectsById = new HashMap&lt;String, T&gt;();</TD></TR><TR><TD CLASS="l">55</TD><TD>    private boolean displaySections;</TD></TR><TR><TD CLASS="l">56</TD><TD>    private List&lt;String&gt; sortFields;</TD></TR><TR><TD CLASS="l">57</TD><TD>    private String groupByField;</TD></TR><TR><TD CLASS="l">58</TD><TD>    private boolean showPicture;</TD></TR><TR><TD CLASS="l">59</TD><TD>    private boolean showCheckbox;</TD></TR><TR><TD CLASS="l">60</TD><TD>    private Filter&lt;T&gt; filter;</TD></TR><TR><TD CLASS="l">61</TD><TD>    private DataNeededListener dataNeededListener;</TD></TR><TR><TD CLASS="l">62</TD><TD>    private GraphObjectCursor&lt;T&gt; cursor;</TD></TR><TR><TD CLASS="l">63</TD><TD>    private Context context;</TD></TR><TR CLASS="z"><TD CLASS="l">64</TD><TD>    private Map&lt;String, ImageResponse&gt; prefetchedPictureCache = new HashMap&lt;String, ImageResponse&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">65</TD><TD>    private ArrayList&lt;String&gt; prefetchedProfilePictureIds = new ArrayList&lt;String&gt;();</TD></TR><TR><TD CLASS="l">66</TD><TD>    private OnErrorListener onErrorListener;</TD></TR><TR><TD CLASS="l">67</TD><TD> </TD></TR><TR><TD CLASS="l">68</TD><TD>    public interface DataNeededListener {</TD></TR><TR><TD CLASS="l">69</TD><TD>        public void onDataNeeded();</TD></TR><TR><TD CLASS="l">70</TD><TD>    }</TD></TR><TR><TD CLASS="l">71</TD><TD> </TD></TR><TR><TD CLASS="l">72</TD><TD>    public interface OnErrorListener {</TD></TR><TR><TD CLASS="l">73</TD><TD>        void onError(GraphObjectAdapter&lt;?&gt; adapter, FacebookException error);</TD></TR><TR><TD CLASS="l">74</TD><TD>    }</TD></TR><TR><TD CLASS="l">75</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="49">76</A></TD><TD>    public static class SectionAndItem&lt;T extends GraphObject&gt; {</TD></TR><TR><TD CLASS="l"><A NAME="4a">77</A></TD><TD>        public String sectionKey;</TD></TR><TR><TD CLASS="l">78</TD><TD>        public T graphObject;</TD></TR><TR><TD CLASS="l">79</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">80</TD><TD>        public enum Type {</TD></TR><TR CLASS="z"><TD CLASS="l">81</TD><TD>            GRAPH_OBJECT,</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="46">82</A></TD><TD>            SECTION_HEADER,</TD></TR><TR CLASS="z"><TD CLASS="l">83</TD><TD>            ACTIVITY_CIRCLE</TD></TR><TR><TD CLASS="l">84</TD><TD>        }</TD></TR><TR><TD CLASS="l">85</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">86</TD><TD>        public SectionAndItem(String sectionKey, T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">87</TD><TD>            this.sectionKey = sectionKey;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="48">88</A></TD><TD>            this.graphObject = graphObject;</TD></TR><TR CLASS="z"><TD CLASS="l">89</TD><TD>        }</TD></TR><TR><TD CLASS="l">90</TD><TD> </TD></TR><TR><TD CLASS="l">91</TD><TD>        public Type getType() {</TD></TR><TR CLASS="z"><TD CLASS="l">92</TD><TD>            if (sectionKey == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">93</TD><TD>                return Type.ACTIVITY_CIRCLE;</TD></TR><TR CLASS="z"><TD CLASS="l">94</TD><TD>            } else if (graphObject == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">95</TD><TD>                return Type.SECTION_HEADER;</TD></TR><TR><TD CLASS="l">96</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">97</TD><TD>                return Type.GRAPH_OBJECT;</TD></TR><TR><TD CLASS="l">98</TD><TD>            }</TD></TR><TR><TD CLASS="l">99</TD><TD>        }</TD></TR><TR><TD CLASS="l">100</TD><TD>    }</TD></TR><TR><TD CLASS="l">101</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="2">102</A></TD><TD>    interface Filter&lt;T&gt; {</TD></TR><TR><TD CLASS="l">103</TD><TD>        boolean includeItem(T graphObject);</TD></TR><TR><TD CLASS="l">104</TD><TD>    }</TD></TR><TR><TD CLASS="l">105</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">106</TD><TD>    public GraphObjectAdapter(Context context) {</TD></TR><TR CLASS="z"><TD CLASS="l">107</TD><TD>        this.context = context;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="27">108</A></TD><TD>        this.inflater = LayoutInflater.from(context);</TD></TR><TR CLASS="z"><TD CLASS="l">109</TD><TD>    }</TD></TR><TR><TD CLASS="l">110</TD><TD> </TD></TR><TR><TD CLASS="l">111</TD><TD>    public List&lt;String&gt; getSortFields() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3b">112</A></TD><TD>        return sortFields;</TD></TR><TR><TD CLASS="l">113</TD><TD>    }</TD></TR><TR><TD CLASS="l">114</TD><TD> </TD></TR><TR><TD CLASS="l">115</TD><TD>    public void setSortFields(List&lt;String&gt; sortFields) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="16">116</A></TD><TD>        this.sortFields = sortFields;</TD></TR><TR CLASS="z"><TD CLASS="l">117</TD><TD>    }</TD></TR><TR><TD CLASS="l">118</TD><TD> </TD></TR><TR><TD CLASS="l">119</TD><TD>    public String getGroupByField() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="37">120</A></TD><TD>        return groupByField;</TD></TR><TR><TD CLASS="l">121</TD><TD>    }</TD></TR><TR><TD CLASS="l">122</TD><TD> </TD></TR><TR><TD CLASS="l">123</TD><TD>    public void setGroupByField(String groupByField) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="26">124</A></TD><TD>        this.groupByField = groupByField;</TD></TR><TR CLASS="z"><TD CLASS="l">125</TD><TD>    }</TD></TR><TR><TD CLASS="l">126</TD><TD> </TD></TR><TR><TD CLASS="l">127</TD><TD>    public boolean getShowPicture() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3a">128</A></TD><TD>        return showPicture;</TD></TR><TR><TD CLASS="l">129</TD><TD>    }</TD></TR><TR><TD CLASS="l">130</TD><TD> </TD></TR><TR><TD CLASS="l">131</TD><TD>    public void setShowPicture(boolean showPicture) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="25">132</A></TD><TD>        this.showPicture = showPicture;</TD></TR><TR CLASS="z"><TD CLASS="l">133</TD><TD>    }</TD></TR><TR><TD CLASS="l">134</TD><TD> </TD></TR><TR><TD CLASS="l">135</TD><TD>    public boolean getShowCheckbox() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="39">136</A></TD><TD>        return showCheckbox;</TD></TR><TR><TD CLASS="l">137</TD><TD>    }</TD></TR><TR><TD CLASS="l">138</TD><TD> </TD></TR><TR><TD CLASS="l">139</TD><TD>    public void setShowCheckbox(boolean showCheckbox) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="10">140</A></TD><TD>        this.showCheckbox = showCheckbox;</TD></TR><TR CLASS="z"><TD CLASS="l">141</TD><TD>    }</TD></TR><TR><TD CLASS="l">142</TD><TD> </TD></TR><TR><TD CLASS="l">143</TD><TD>    public DataNeededListener getDataNeededListener() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="35">144</A></TD><TD>        return dataNeededListener;</TD></TR><TR><TD CLASS="l">145</TD><TD>    }</TD></TR><TR><TD CLASS="l">146</TD><TD> </TD></TR><TR><TD CLASS="l">147</TD><TD>    public void setDataNeededListener(DataNeededListener dataNeededListener) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1b">148</A></TD><TD>        this.dataNeededListener = dataNeededListener;</TD></TR><TR CLASS="z"><TD CLASS="l">149</TD><TD>    }</TD></TR><TR><TD CLASS="l">150</TD><TD> </TD></TR><TR><TD CLASS="l">151</TD><TD>    public OnErrorListener getOnErrorListener() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="38">152</A></TD><TD>        return onErrorListener;</TD></TR><TR><TD CLASS="l">153</TD><TD>    }</TD></TR><TR><TD CLASS="l">154</TD><TD> </TD></TR><TR><TD CLASS="l">155</TD><TD>    public void setOnErrorListener(OnErrorListener onErrorListener) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="f">156</A></TD><TD>        this.onErrorListener = onErrorListener;</TD></TR><TR CLASS="z"><TD CLASS="l">157</TD><TD>    }</TD></TR><TR><TD CLASS="l">158</TD><TD> </TD></TR><TR><TD CLASS="l">159</TD><TD>    public GraphObjectCursor&lt;T&gt; getCursor() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8">160</A></TD><TD>        return cursor;</TD></TR><TR><TD CLASS="l">161</TD><TD>    }</TD></TR><TR><TD CLASS="l">162</TD><TD> </TD></TR><TR><TD CLASS="l">163</TD><TD>    public boolean changeCursor(GraphObjectCursor&lt;T&gt; cursor) {</TD></TR><TR CLASS="z"><TD CLASS="l">164</TD><TD>        if (this.cursor == cursor) {</TD></TR><TR CLASS="z"><TD CLASS="l">165</TD><TD>            return false;</TD></TR><TR><TD CLASS="l">166</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">167</TD><TD>        if (this.cursor != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">168</TD><TD>            this.cursor.close();</TD></TR><TR><TD CLASS="l">169</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">170</TD><TD>        this.cursor = cursor;</TD></TR><TR><TD CLASS="l">171</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">172</TD><TD>        rebuildAndNotify();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="33">173</A></TD><TD>        return true;</TD></TR><TR><TD CLASS="l">174</TD><TD>    }</TD></TR><TR><TD CLASS="l">175</TD><TD> </TD></TR><TR><TD CLASS="l">176</TD><TD>    public void rebuildAndNotify() {</TD></TR><TR CLASS="z"><TD CLASS="l">177</TD><TD>        rebuildSections();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="31">178</A></TD><TD>        notifyDataSetChanged();</TD></TR><TR CLASS="z"><TD CLASS="l">179</TD><TD>    }</TD></TR><TR><TD CLASS="l">180</TD><TD> </TD></TR><TR><TD CLASS="l">181</TD><TD>    public void prioritizeViewRange(int firstVisibleItem, int lastVisibleItem, int prefetchBuffer) {</TD></TR><TR CLASS="z"><TD CLASS="l">182</TD><TD>        if ((lastVisibleItem &lt; firstVisibleItem) || (sectionKeys.size() == 0)) {</TD></TR><TR CLASS="z"><TD CLASS="l">183</TD><TD>            return;</TD></TR><TR><TD CLASS="l">184</TD><TD>        }</TD></TR><TR><TD CLASS="l">185</TD><TD> </TD></TR><TR><TD CLASS="l">186</TD><TD>        // We want to prioritize requests for items which are visible but do not have pictures</TD></TR><TR><TD CLASS="l">187</TD><TD>        // loaded yet. We also want to pre-fetch pictures for items which are not yet visible</TD></TR><TR><TD CLASS="l">188</TD><TD>        // but are within a buffer on either side of the visible items, on the assumption that</TD></TR><TR><TD CLASS="l">189</TD><TD>        // they will be visible soon. For these latter items, we'll store the images in memory</TD></TR><TR><TD CLASS="l">190</TD><TD>        // in the hopes we can immediately populate their image view when needed.</TD></TR><TR><TD CLASS="l">191</TD><TD> </TD></TR><TR><TD CLASS="l">192</TD><TD>        // Prioritize the requests in reverse order since each call to prioritizeRequest will just</TD></TR><TR><TD CLASS="l">193</TD><TD>        // move it to the front of the queue. And we want the earliest ones in the range to be at</TD></TR><TR><TD CLASS="l">194</TD><TD>        // the front of the queue, so all else being equal, the list will appear to populate from</TD></TR><TR><TD CLASS="l">195</TD><TD>        // the top down.</TD></TR><TR CLASS="z"><TD CLASS="l">196</TD><TD>        for (int i = lastVisibleItem; i &gt;= 0; i--) {</TD></TR><TR CLASS="z"><TD CLASS="l">197</TD><TD>            SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(i);</TD></TR><TR CLASS="z"><TD CLASS="l">198</TD><TD>            if (sectionAndItem.graphObject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">199</TD><TD>                String id = getIdOfGraphObject(sectionAndItem.graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">200</TD><TD>                ImageRequest request = pendingRequests.get(id);</TD></TR><TR CLASS="z"><TD CLASS="l">201</TD><TD>                if (request != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">202</TD><TD>                    ImageDownloader.prioritizeRequest(request);</TD></TR><TR><TD CLASS="l">203</TD><TD>                }</TD></TR><TR><TD CLASS="l">204</TD><TD>            }</TD></TR><TR><TD CLASS="l">205</TD><TD>        }</TD></TR><TR><TD CLASS="l">206</TD><TD> </TD></TR><TR><TD CLASS="l">207</TD><TD>        // For items which are not visible, but within the buffer on either side, we want to</TD></TR><TR><TD CLASS="l">208</TD><TD>        // fetch those items and store them in a small in-memory cache of bitmaps.</TD></TR><TR CLASS="z"><TD CLASS="l">209</TD><TD>        int start = Math.max(0, firstVisibleItem - prefetchBuffer);</TD></TR><TR CLASS="z"><TD CLASS="l">210</TD><TD>        int end = Math.min(lastVisibleItem + prefetchBuffer, getCount() - 1);</TD></TR><TR CLASS="z"><TD CLASS="l">211</TD><TD>        ArrayList&lt;T&gt; graphObjectsToPrefetchPicturesFor = new ArrayList&lt;T&gt;();</TD></TR><TR><TD CLASS="l">212</TD><TD>        // Add the IDs before and after the visible range.</TD></TR><TR CLASS="z"><TD CLASS="l">213</TD><TD>        for (int i = start; i &lt; firstVisibleItem; ++i) {</TD></TR><TR CLASS="z"><TD CLASS="l">214</TD><TD>            SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(i);</TD></TR><TR CLASS="z"><TD CLASS="l">215</TD><TD>            if (sectionAndItem.graphObject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">216</TD><TD>                graphObjectsToPrefetchPicturesFor.add(sectionAndItem.graphObject);</TD></TR><TR><TD CLASS="l">217</TD><TD>            }</TD></TR><TR><TD CLASS="l">218</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">219</TD><TD>        for (int i = lastVisibleItem + 1; i &lt;= end; ++i) {</TD></TR><TR CLASS="z"><TD CLASS="l">220</TD><TD>            SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(i);</TD></TR><TR CLASS="z"><TD CLASS="l">221</TD><TD>            if (sectionAndItem.graphObject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">222</TD><TD>                graphObjectsToPrefetchPicturesFor.add(sectionAndItem.graphObject);</TD></TR><TR><TD CLASS="l">223</TD><TD>            }</TD></TR><TR><TD CLASS="l">224</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">225</TD><TD>        for (T graphObject : graphObjectsToPrefetchPicturesFor) {</TD></TR><TR CLASS="z"><TD CLASS="l">226</TD><TD>            URI uri = getPictureUriOfGraphObject(graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">227</TD><TD>            final String id = getIdOfGraphObject(graphObject);</TD></TR><TR><TD CLASS="l">228</TD><TD> </TD></TR><TR><TD CLASS="l">229</TD><TD>            // This URL already have been requested for pre-fetching, but we want to act in an LRU manner, so move</TD></TR><TR><TD CLASS="l">230</TD><TD>            // it to the end of the list regardless.</TD></TR><TR CLASS="z"><TD CLASS="l">231</TD><TD>            boolean alreadyPrefetching = prefetchedProfilePictureIds.remove(id);</TD></TR><TR CLASS="z"><TD CLASS="l">232</TD><TD>            prefetchedProfilePictureIds.add(id);</TD></TR><TR><TD CLASS="l">233</TD><TD> </TD></TR><TR><TD CLASS="l">234</TD><TD>            // If we've already requested it for pre-fetching, no need to do so again.</TD></TR><TR CLASS="z"><TD CLASS="l">235</TD><TD>            if (!alreadyPrefetching) {</TD></TR><TR CLASS="z"><TD CLASS="l">236</TD><TD>                downloadProfilePicture(id, uri, null);</TD></TR><TR><TD CLASS="l">237</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="23">238</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">239</TD><TD>    }</TD></TR><TR><TD CLASS="l">240</TD><TD> </TD></TR><TR><TD CLASS="l">241</TD><TD>    protected String getSectionKeyOfGraphObject(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">242</TD><TD>        String result = null;</TD></TR><TR><TD CLASS="l">243</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">244</TD><TD>        if (groupByField != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">245</TD><TD>            result = (String) graphObject.getProperty(groupByField);</TD></TR><TR CLASS="z"><TD CLASS="l">246</TD><TD>            if (result != null &amp;&amp; result.length() &gt; 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">247</TD><TD>                result = result.substring(0, 1).toUpperCase();</TD></TR><TR><TD CLASS="l">248</TD><TD>            }</TD></TR><TR><TD CLASS="l">249</TD><TD>        }</TD></TR><TR><TD CLASS="l">250</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="29">251</A></TD><TD>        return (result != null) ? result : &#34;&#34;;</TD></TR><TR><TD CLASS="l">252</TD><TD>    }</TD></TR><TR><TD CLASS="l">253</TD><TD> </TD></TR><TR><TD CLASS="l">254</TD><TD>    protected CharSequence getTitleOfGraphObject(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="28">255</A></TD><TD>        return (String) graphObject.getProperty(NAME);</TD></TR><TR><TD CLASS="l">256</TD><TD>    }</TD></TR><TR><TD CLASS="l">257</TD><TD> </TD></TR><TR><TD CLASS="l">258</TD><TD>    protected CharSequence getSubTitleOfGraphObject(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1d">259</A></TD><TD>        return null;</TD></TR><TR><TD CLASS="l">260</TD><TD>    }</TD></TR><TR><TD CLASS="l">261</TD><TD> </TD></TR><TR><TD CLASS="l">262</TD><TD>    protected URI getPictureUriOfGraphObject(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">263</TD><TD>        String uri = null;</TD></TR><TR CLASS="z"><TD CLASS="l">264</TD><TD>        Object o = graphObject.getProperty(PICTURE);</TD></TR><TR CLASS="z"><TD CLASS="l">265</TD><TD>        if (o instanceof String) {</TD></TR><TR CLASS="z"><TD CLASS="l">266</TD><TD>            uri = (String) o;</TD></TR><TR CLASS="z"><TD CLASS="l">267</TD><TD>        } else if (o instanceof JSONObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">268</TD><TD>            ItemPicture itemPicture = GraphObject.Factory.create((JSONObject) o).cast(ItemPicture.class);</TD></TR><TR CLASS="z"><TD CLASS="l">269</TD><TD>            ItemPictureData data = itemPicture.getData();</TD></TR><TR CLASS="z"><TD CLASS="l">270</TD><TD>            if (data != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">271</TD><TD>                uri = data.getUrl();</TD></TR><TR><TD CLASS="l">272</TD><TD>            }</TD></TR><TR><TD CLASS="l">273</TD><TD>        }</TD></TR><TR><TD CLASS="l">274</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">275</TD><TD>        if (uri != null) {</TD></TR><TR><TD CLASS="l">276</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">277</TD><TD>                return new URI(uri);</TD></TR><TR CLASS="z"><TD CLASS="l">278</TD><TD>            } catch (URISyntaxException e) {</TD></TR><TR><TD CLASS="l">279</TD><TD>            }</TD></TR><TR><TD CLASS="l">280</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="22">281</A></TD><TD>        return null;</TD></TR><TR><TD CLASS="l">282</TD><TD>    }</TD></TR><TR><TD CLASS="l">283</TD><TD> </TD></TR><TR><TD CLASS="l">284</TD><TD>    protected View getSectionHeaderView(String sectionHeader, View convertView, ViewGroup parent) {</TD></TR><TR CLASS="z"><TD CLASS="l">285</TD><TD>        TextView result = (TextView) convertView;</TD></TR><TR><TD CLASS="l">286</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">287</TD><TD>        if (result == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">288</TD><TD>            result = (TextView) inflater.inflate(R.layout.com_facebook_picker_list_section_header, null);</TD></TR><TR><TD CLASS="l">289</TD><TD>        }</TD></TR><TR><TD CLASS="l">290</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">291</TD><TD>        result.setText(sectionHeader);</TD></TR><TR><TD CLASS="l">292</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="14">293</A></TD><TD>        return result;</TD></TR><TR><TD CLASS="l">294</TD><TD>    }</TD></TR><TR><TD CLASS="l">295</TD><TD> </TD></TR><TR><TD CLASS="l">296</TD><TD>    protected View getGraphObjectView(T graphObject, View convertView, ViewGroup parent) {</TD></TR><TR CLASS="z"><TD CLASS="l">297</TD><TD>        View result = convertView;</TD></TR><TR><TD CLASS="l">298</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">299</TD><TD>        if (result == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">300</TD><TD>            result = createGraphObjectView(graphObject);</TD></TR><TR><TD CLASS="l">301</TD><TD>        }</TD></TR><TR><TD CLASS="l">302</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">303</TD><TD>        populateGraphObjectView(result, graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="d">304</A></TD><TD>        return result;</TD></TR><TR><TD CLASS="l">305</TD><TD>    }</TD></TR><TR><TD CLASS="l">306</TD><TD> </TD></TR><TR><TD CLASS="l">307</TD><TD>    private View getActivityCircleView(View convertView, ViewGroup parent) {</TD></TR><TR CLASS="z"><TD CLASS="l">308</TD><TD>        View result = convertView;</TD></TR><TR><TD CLASS="l">309</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">310</TD><TD>        if (result == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">311</TD><TD>            result = inflater.inflate(R.layout.com_facebook_picker_activity_circle_row, null);</TD></TR><TR><TD CLASS="l">312</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">313</TD><TD>        ProgressBar activityCircle = (ProgressBar) result.findViewById(R.id.com_facebook_picker_row_activity_circle);</TD></TR><TR CLASS="z"><TD CLASS="l">314</TD><TD>        activityCircle.setVisibility(View.VISIBLE);</TD></TR><TR><TD CLASS="l">315</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="13">316</A></TD><TD>        return result;</TD></TR><TR><TD CLASS="l">317</TD><TD>    }</TD></TR><TR><TD CLASS="l">318</TD><TD> </TD></TR><TR><TD CLASS="l">319</TD><TD>    protected int getGraphObjectRowLayoutId(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="11">320</A></TD><TD>        return R.layout.com_facebook_picker_list_row;</TD></TR><TR><TD CLASS="l">321</TD><TD>    }</TD></TR><TR><TD CLASS="l">322</TD><TD> </TD></TR><TR><TD CLASS="l">323</TD><TD>    protected int getDefaultPicture() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="a">324</A></TD><TD>        return R.drawable.com_facebook_profile_default_icon;</TD></TR><TR><TD CLASS="l">325</TD><TD>    }</TD></TR><TR><TD CLASS="l">326</TD><TD> </TD></TR><TR><TD CLASS="l">327</TD><TD>    protected View createGraphObjectView(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">328</TD><TD>        View result = inflater.inflate(getGraphObjectRowLayoutId(graphObject), null);</TD></TR><TR><TD CLASS="l">329</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">330</TD><TD>        ViewStub checkboxStub = (ViewStub) result.findViewById(R.id.com_facebook_picker_checkbox_stub);</TD></TR><TR CLASS="z"><TD CLASS="l">331</TD><TD>        if (checkboxStub != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">332</TD><TD>            if (!getShowCheckbox()) {</TD></TR><TR CLASS="z"><TD CLASS="l">333</TD><TD>                checkboxStub.setVisibility(View.GONE);</TD></TR><TR><TD CLASS="l">334</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">335</TD><TD>                CheckBox checkBox = (CheckBox) checkboxStub.inflate();</TD></TR><TR CLASS="z"><TD CLASS="l">336</TD><TD>                updateCheckboxState(checkBox, false);</TD></TR><TR><TD CLASS="l">337</TD><TD>            }</TD></TR><TR><TD CLASS="l">338</TD><TD>        }</TD></TR><TR><TD CLASS="l">339</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">340</TD><TD>        ViewStub profilePicStub = (ViewStub) result.findViewById(R.id.com_facebook_picker_profile_pic_stub);</TD></TR><TR CLASS="z"><TD CLASS="l">341</TD><TD>        if (!getShowPicture()) {</TD></TR><TR CLASS="z"><TD CLASS="l">342</TD><TD>            profilePicStub.setVisibility(View.GONE);</TD></TR><TR><TD CLASS="l">343</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">344</TD><TD>            ImageView imageView = (ImageView) profilePicStub.inflate();</TD></TR><TR CLASS="z"><TD CLASS="l">345</TD><TD>            imageView.setVisibility(View.VISIBLE);</TD></TR><TR><TD CLASS="l">346</TD><TD>        }</TD></TR><TR><TD CLASS="l">347</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="30">348</A></TD><TD>        return result;</TD></TR><TR><TD CLASS="l">349</TD><TD>    }</TD></TR><TR><TD CLASS="l">350</TD><TD> </TD></TR><TR><TD CLASS="l">351</TD><TD>    protected void populateGraphObjectView(View view, T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">352</TD><TD>        String id = getIdOfGraphObject(graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">353</TD><TD>        view.setTag(id);</TD></TR><TR><TD CLASS="l">354</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">355</TD><TD>        CharSequence title = getTitleOfGraphObject(graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">356</TD><TD>        TextView titleView = (TextView) view.findViewById(R.id.com_facebook_picker_title);</TD></TR><TR CLASS="z"><TD CLASS="l">357</TD><TD>        if (titleView != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">358</TD><TD>            titleView.setText(title, TextView.BufferType.SPANNABLE);</TD></TR><TR><TD CLASS="l">359</TD><TD>        }</TD></TR><TR><TD CLASS="l">360</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">361</TD><TD>        CharSequence subtitle = getSubTitleOfGraphObject(graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">362</TD><TD>        TextView subtitleView = (TextView) view.findViewById(R.id.picker_subtitle);</TD></TR><TR CLASS="z"><TD CLASS="l">363</TD><TD>        if (subtitleView != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">364</TD><TD>            if (subtitle != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">365</TD><TD>                subtitleView.setText(subtitle, TextView.BufferType.SPANNABLE);</TD></TR><TR CLASS="z"><TD CLASS="l">366</TD><TD>                subtitleView.setVisibility(View.VISIBLE);</TD></TR><TR><TD CLASS="l">367</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">368</TD><TD>                subtitleView.setVisibility(View.GONE);</TD></TR><TR><TD CLASS="l">369</TD><TD>            }</TD></TR><TR><TD CLASS="l">370</TD><TD>        }</TD></TR><TR><TD CLASS="l">371</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">372</TD><TD>        if (getShowCheckbox()) {</TD></TR><TR CLASS="z"><TD CLASS="l">373</TD><TD>            CheckBox checkBox = (CheckBox) view.findViewById(R.id.com_facebook_picker_checkbox);</TD></TR><TR CLASS="z"><TD CLASS="l">374</TD><TD>            updateCheckboxState(checkBox, isGraphObjectSelected(id));</TD></TR><TR><TD CLASS="l">375</TD><TD>        }</TD></TR><TR><TD CLASS="l">376</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">377</TD><TD>        if (getShowPicture()) {</TD></TR><TR CLASS="z"><TD CLASS="l">378</TD><TD>            URI pictureURI = getPictureUriOfGraphObject(graphObject);</TD></TR><TR><TD CLASS="l">379</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">380</TD><TD>            if (pictureURI != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">381</TD><TD>                ImageView profilePic = (ImageView) view.findViewById(R.id.com_facebook_picker_image);</TD></TR><TR><TD CLASS="l">382</TD><TD> </TD></TR><TR><TD CLASS="l">383</TD><TD>                // See if we have already pre-fetched this; if not, download it.</TD></TR><TR CLASS="z"><TD CLASS="l">384</TD><TD>                if (prefetchedPictureCache.containsKey(id)) {</TD></TR><TR CLASS="z"><TD CLASS="l">385</TD><TD>                    ImageResponse response = prefetchedPictureCache.get(id);</TD></TR><TR CLASS="z"><TD CLASS="l">386</TD><TD>                    profilePic.setImageBitmap(response.getBitmap());</TD></TR><TR CLASS="z"><TD CLASS="l">387</TD><TD>                    profilePic.setTag(response.getRequest().getImageUri());</TD></TR><TR CLASS="z"><TD CLASS="l">388</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">389</TD><TD>                    downloadProfilePicture(id, pictureURI, profilePic);</TD></TR><TR><TD CLASS="l">390</TD><TD>                }</TD></TR><TR><TD CLASS="l">391</TD><TD>            }</TD></TR><TR><TD CLASS="l">392</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">393</TD><TD>    }</TD></TR><TR><TD CLASS="l">394</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="17">395</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">396</TD><TD>     * @throws FacebookException if the GraphObject doesn't have an ID.</TD></TR><TR><TD CLASS="l">397</TD><TD>     */</TD></TR><TR><TD CLASS="l">398</TD><TD>    String getIdOfGraphObject(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">399</TD><TD>        if (graphObject.asMap().containsKey(ID)) {</TD></TR><TR CLASS="z"><TD CLASS="l">400</TD><TD>            Object obj = graphObject.getProperty(ID);</TD></TR><TR CLASS="z"><TD CLASS="l">401</TD><TD>            if (obj instanceof String) {</TD></TR><TR CLASS="z"><TD CLASS="l">402</TD><TD>                return (String) obj;</TD></TR><TR><TD CLASS="l">403</TD><TD>            }</TD></TR><TR><TD CLASS="l">404</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="c">405</A></TD><TD>        throw new FacebookException(&#34;Received an object without an ID.&#34;);</TD></TR><TR><TD CLASS="l">406</TD><TD>    }</TD></TR><TR><TD CLASS="l">407</TD><TD> </TD></TR><TR><TD CLASS="l">408</TD><TD>    boolean filterIncludesItem(T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="12">409</A></TD><TD>        return filter == null || filter.includeItem(graphObject);</TD></TR><TR><TD CLASS="l">410</TD><TD>    }</TD></TR><TR><TD CLASS="l">411</TD><TD> </TD></TR><TR><TD CLASS="l">412</TD><TD>    Filter&lt;T&gt; getFilter() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="36">413</A></TD><TD>        return filter;</TD></TR><TR><TD CLASS="l">414</TD><TD>    }</TD></TR><TR><TD CLASS="l">415</TD><TD> </TD></TR><TR><TD CLASS="l">416</TD><TD>    void setFilter(Filter&lt;T&gt; filter) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2f">417</A></TD><TD>        this.filter = filter;</TD></TR><TR CLASS="z"><TD CLASS="l">418</TD><TD>    }</TD></TR><TR><TD CLASS="l">419</TD><TD> </TD></TR><TR><TD CLASS="l">420</TD><TD>    boolean isGraphObjectSelected(String graphObjectId) {</TD></TR><TR CLASS="z"><TD CLASS="l">421</TD><TD>        return false;</TD></TR><TR><TD CLASS="l"><A NAME="3d">422</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">423</TD><TD> </TD></TR><TR><TD CLASS="l">424</TD><TD>    void updateCheckboxState(CheckBox checkBox, boolean graphObjectSelected) {</TD></TR><TR><TD CLASS="l">425</TD><TD>        // Default is no-op</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1c">426</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">427</TD><TD> </TD></TR><TR><TD CLASS="l">428</TD><TD>    String getPictureFieldSpecifier() {</TD></TR><TR><TD CLASS="l">429</TD><TD>        // How big is our image?</TD></TR><TR CLASS="z"><TD CLASS="l">430</TD><TD>        View view = createGraphObjectView(null);</TD></TR><TR CLASS="z"><TD CLASS="l">431</TD><TD>        ImageView picture = (ImageView) view.findViewById(R.id.com_facebook_picker_image);</TD></TR><TR CLASS="z"><TD CLASS="l">432</TD><TD>        if (picture == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">433</TD><TD>            return null;</TD></TR><TR><TD CLASS="l">434</TD><TD>        }</TD></TR><TR><TD CLASS="l">435</TD><TD> </TD></TR><TR><TD CLASS="l">436</TD><TD>        // Note: these dimensions are in pixels, not dips</TD></TR><TR CLASS="z"><TD CLASS="l">437</TD><TD>        ViewGroup.LayoutParams layoutParams = picture.getLayoutParams();</TD></TR><TR CLASS="z"><TD CLASS="l">438</TD><TD>        return String.format(&#34;picture.height(%d).width(%d)&#34;, layoutParams.height, layoutParams.width);</TD></TR><TR><TD CLASS="l">439</TD><TD>    }</TD></TR><TR><TD CLASS="l">440</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="3c">441</A></TD><TD> </TD></TR><TR><TD CLASS="l">442</TD><TD>    private boolean shouldShowActivityCircleCell() {</TD></TR><TR><TD CLASS="l">443</TD><TD>        // We show the &#34;more data&#34; activity circle cell if we have a listener to request more data,</TD></TR><TR><TD CLASS="l">444</TD><TD>        // we are expecting more data, and we have some data already (i.e., not on a fresh query).</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="34">445</A></TD><TD>        return (cursor != null) &amp;&amp; cursor.areMoreObjectsAvailable() &amp;&amp; (dataNeededListener != null) &amp;&amp; !isEmpty();</TD></TR><TR><TD CLASS="l">446</TD><TD>    }</TD></TR><TR><TD CLASS="l">447</TD><TD> </TD></TR><TR><TD CLASS="l">448</TD><TD>    private void rebuildSections() {</TD></TR><TR CLASS="z"><TD CLASS="l">449</TD><TD>        sectionKeys = new ArrayList&lt;String&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">450</TD><TD>        graphObjectsBySection = new HashMap&lt;String, ArrayList&lt;T&gt;&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">451</TD><TD>        graphObjectsById = new HashMap&lt;String, T&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">452</TD><TD>        displaySections = false;</TD></TR><TR><TD CLASS="l">453</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">454</TD><TD>        if (cursor == null || cursor.getCount() == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">455</TD><TD>            return;</TD></TR><TR><TD CLASS="l">456</TD><TD>        }</TD></TR><TR><TD CLASS="l">457</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">458</TD><TD>        int objectsAdded = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">459</TD><TD>        cursor.moveToFirst();</TD></TR><TR><TD CLASS="l">460</TD><TD>        do {</TD></TR><TR CLASS="z"><TD CLASS="l">461</TD><TD>            T graphObject = cursor.getGraphObject();</TD></TR><TR><TD CLASS="l">462</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">463</TD><TD>            if (!filterIncludesItem(graphObject)) {</TD></TR><TR CLASS="z"><TD CLASS="l">464</TD><TD>                continue;</TD></TR><TR><TD CLASS="l">465</TD><TD>            }</TD></TR><TR><TD CLASS="l">466</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">467</TD><TD>            objectsAdded++;</TD></TR><TR><TD CLASS="l">468</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">469</TD><TD>            String sectionKeyOfItem = getSectionKeyOfGraphObject(graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">470</TD><TD>            if (!graphObjectsBySection.containsKey(sectionKeyOfItem)) {</TD></TR><TR CLASS="z"><TD CLASS="l">471</TD><TD>                sectionKeys.add(sectionKeyOfItem);</TD></TR><TR CLASS="z"><TD CLASS="l">472</TD><TD>                graphObjectsBySection.put(sectionKeyOfItem, new ArrayList&lt;T&gt;());</TD></TR><TR><TD CLASS="l">473</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">474</TD><TD>            List&lt;T&gt; section = graphObjectsBySection.get(sectionKeyOfItem);</TD></TR><TR CLASS="z"><TD CLASS="l">475</TD><TD>            section.add(graphObject);</TD></TR><TR><TD CLASS="l">476</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">477</TD><TD>            graphObjectsById.put(getIdOfGraphObject(graphObject), graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">478</TD><TD>        } while (cursor.moveToNext());</TD></TR><TR><TD CLASS="l"><A NAME="3e">479</A></TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">480</TD><TD>        if (sortFields != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">481</TD><TD>            final Collator collator = Collator.getInstance();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="40">482</A></TD><TD>            for (List&lt;T&gt; section : graphObjectsBySection.values()) {</TD></TR><TR CLASS="z"><TD CLASS="l">483</TD><TD>                Collections.sort(section, new Comparator&lt;GraphObject&gt;() {</TD></TR><TR><TD CLASS="l">484</TD><TD>                    @Override</TD></TR><TR><TD CLASS="l">485</TD><TD>                    public int compare(GraphObject a, GraphObject b) {</TD></TR><TR CLASS="z"><TD CLASS="l">486</TD><TD>                        return compareGraphObjects(a, b, sortFields, collator);</TD></TR><TR><TD CLASS="l">487</TD><TD>                    }</TD></TR><TR><TD CLASS="l">488</TD><TD>                });</TD></TR><TR CLASS="z"><TD CLASS="l">489</TD><TD>            }</TD></TR><TR><TD CLASS="l">490</TD><TD>        }</TD></TR><TR><TD CLASS="l">491</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">492</TD><TD>        Collections.sort(sectionKeys, Collator.getInstance());</TD></TR><TR><TD CLASS="l">493</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="20">494</A></TD><TD>        displaySections = sectionKeys.size() &gt; 1 &amp;&amp; objectsAdded &gt; DISPLAY_SECTIONS_THRESHOLD;</TD></TR><TR CLASS="z"><TD CLASS="l">495</TD><TD>    }</TD></TR><TR><TD CLASS="l">496</TD><TD> </TD></TR><TR><TD CLASS="l">497</TD><TD>    SectionAndItem&lt;T&gt; getSectionAndItem(int position) {</TD></TR><TR CLASS="z"><TD CLASS="l">498</TD><TD>        if (sectionKeys.size() == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">499</TD><TD>            return null;</TD></TR><TR><TD CLASS="l">500</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">501</TD><TD>        String sectionKey = null;</TD></TR><TR CLASS="z"><TD CLASS="l">502</TD><TD>        T graphObject = null;</TD></TR><TR><TD CLASS="l">503</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">504</TD><TD>        if (!displaySections) {</TD></TR><TR CLASS="z"><TD CLASS="l">505</TD><TD>            sectionKey = sectionKeys.get(0);</TD></TR><TR CLASS="z"><TD CLASS="l">506</TD><TD>            List&lt;T&gt; section = graphObjectsBySection.get(sectionKey);</TD></TR><TR CLASS="z"><TD CLASS="l">507</TD><TD>            if (position &gt;= 0 &amp;&amp; position &lt; section.size()) {</TD></TR><TR CLASS="z"><TD CLASS="l">508</TD><TD>                graphObject = graphObjectsBySection.get(sectionKey).get(position);</TD></TR><TR><TD CLASS="l">509</TD><TD>            } else {</TD></TR><TR><TD CLASS="l">510</TD><TD>                // We are off the end; we must be adding an activity circle to indicate more data is coming.</TD></TR><TR CLASS="z"><TD CLASS="l">511</TD><TD>                assert dataNeededListener != null &amp;&amp; cursor.areMoreObjectsAvailable();</TD></TR><TR><TD CLASS="l">512</TD><TD>                // We return null for both to indicate this.</TD></TR><TR CLASS="z"><TD CLASS="l">513</TD><TD>                return new SectionAndItem&lt;T&gt;(null, null);</TD></TR><TR><TD CLASS="l">514</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">515</TD><TD>        } else {</TD></TR><TR><TD CLASS="l">516</TD><TD>            // Count through the sections; the &#34;0&#34; position in each section is the header. We decrement</TD></TR><TR><TD CLASS="l">517</TD><TD>            // position each time we skip forward a certain number of elements, including the header.</TD></TR><TR CLASS="z"><TD CLASS="l">518</TD><TD>            for (String key : sectionKeys) {</TD></TR><TR><TD CLASS="l">519</TD><TD>                // Decrement if we skip over the header</TD></TR><TR CLASS="z"><TD CLASS="l">520</TD><TD>                if (position-- == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">521</TD><TD>                    sectionKey = key;</TD></TR><TR CLASS="z"><TD CLASS="l">522</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">523</TD><TD>                }</TD></TR><TR><TD CLASS="l">524</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">525</TD><TD>                List&lt;T&gt; section = graphObjectsBySection.get(key);</TD></TR><TR CLASS="z"><TD CLASS="l">526</TD><TD>                if (position &lt; section.size()) {</TD></TR><TR><TD CLASS="l">527</TD><TD>                    // The position is somewhere in this section. Get the corresponding graph object.</TD></TR><TR CLASS="z"><TD CLASS="l">528</TD><TD>                    sectionKey = key;</TD></TR><TR CLASS="z"><TD CLASS="l">529</TD><TD>                    graphObject = section.get(position);</TD></TR><TR CLASS="z"><TD CLASS="l">530</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">531</TD><TD>                }</TD></TR><TR><TD CLASS="l">532</TD><TD>                // Decrement by as many items as we skipped over</TD></TR><TR CLASS="z"><TD CLASS="l">533</TD><TD>                position -= section.size();</TD></TR><TR CLASS="z"><TD CLASS="l">534</TD><TD>            }</TD></TR><TR><TD CLASS="l">535</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">536</TD><TD>        if (sectionKey != null) {</TD></TR><TR><TD CLASS="l">537</TD><TD>            // Note: graphObject will be null if this represents a section header.</TD></TR><TR CLASS="z"><TD CLASS="l">538</TD><TD>            return new SectionAndItem&lt;T&gt;(sectionKey, graphObject);</TD></TR><TR><TD CLASS="l">539</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">540</TD><TD>            throw new IndexOutOfBoundsException(&#34;position&#34;);</TD></TR><TR><TD CLASS="l"><A NAME="1e">541</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">542</TD><TD>    }</TD></TR><TR><TD CLASS="l">543</TD><TD> </TD></TR><TR><TD CLASS="l">544</TD><TD>    int getPosition(String sectionKey, T graphObject) {</TD></TR><TR CLASS="z"><TD CLASS="l">545</TD><TD>        int position = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">546</TD><TD>        boolean found = false;</TD></TR><TR><TD CLASS="l">547</TD><TD> </TD></TR><TR><TD CLASS="l">548</TD><TD>        // First find the section key and increment position one for each header we will render;</TD></TR><TR><TD CLASS="l">549</TD><TD>        // increment by the size of each section prior to the one we want.</TD></TR><TR CLASS="z"><TD CLASS="l">550</TD><TD>        for (String key : sectionKeys) {</TD></TR><TR CLASS="z"><TD CLASS="l">551</TD><TD>            if (displaySections) {</TD></TR><TR CLASS="z"><TD CLASS="l">552</TD><TD>                position++;</TD></TR><TR><TD CLASS="l">553</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">554</TD><TD>            if (key.equals(sectionKey)) {</TD></TR><TR CLASS="z"><TD CLASS="l">555</TD><TD>                found = true;</TD></TR><TR CLASS="z"><TD CLASS="l">556</TD><TD>                break;</TD></TR><TR><TD CLASS="l">557</TD><TD>            } else {</TD></TR><TR CLASS="z"><TD CLASS="l">558</TD><TD>                position += graphObjectsBySection.get(key).size();</TD></TR><TR><TD CLASS="l">559</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">560</TD><TD>        }</TD></TR><TR><TD CLASS="l">561</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">562</TD><TD>        if (!found) {</TD></TR><TR CLASS="z"><TD CLASS="l">563</TD><TD>            return -1;</TD></TR><TR CLASS="z"><TD CLASS="l">564</TD><TD>        } else if (graphObject == null) {</TD></TR><TR><TD CLASS="l">565</TD><TD>            // null represents the header for a section; we counted this header in position earlier,</TD></TR><TR><TD CLASS="l">566</TD><TD>            // so subtract it back out.</TD></TR><TR CLASS="z"><TD CLASS="l">567</TD><TD>            return position - (displaySections ? 1 : 0);</TD></TR><TR><TD CLASS="l">568</TD><TD>        }</TD></TR><TR><TD CLASS="l">569</TD><TD> </TD></TR><TR><TD CLASS="l">570</TD><TD>        // Now find index of this item within that section.</TD></TR><TR CLASS="z"><TD CLASS="l">571</TD><TD>        for (T t : graphObjectsBySection.get(sectionKey)) {</TD></TR><TR CLASS="z"><TD CLASS="l">572</TD><TD>            if (GraphObject.Factory.hasSameId(t, graphObject)) {</TD></TR><TR CLASS="z"><TD CLASS="l">573</TD><TD>                return position;</TD></TR><TR><TD CLASS="l">574</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">575</TD><TD>            position++;</TD></TR><TR CLASS="z"><TD CLASS="l">576</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">577</TD><TD>        return -1;</TD></TR><TR><TD CLASS="l">578</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="2d">579</A></TD><TD> </TD></TR><TR><TD CLASS="l">580</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">581</TD><TD>    public boolean isEmpty() {</TD></TR><TR><TD CLASS="l">582</TD><TD>        // We'll never populate sectionKeys unless we have at least one object.</TD></TR><TR CLASS="z"><TD CLASS="l">583</TD><TD>        return sectionKeys.size() == 0;</TD></TR><TR><TD CLASS="l"><A NAME="e">584</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">585</TD><TD> </TD></TR><TR><TD CLASS="l">586</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">587</TD><TD>    public int getCount() {</TD></TR><TR CLASS="z"><TD CLASS="l">588</TD><TD>        if (sectionKeys.size() == 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">589</TD><TD>            return 0;</TD></TR><TR><TD CLASS="l">590</TD><TD>        }</TD></TR><TR><TD CLASS="l">591</TD><TD> </TD></TR><TR><TD CLASS="l">592</TD><TD>        // If we are not displaying sections, we don't display a header; otherwise, we have one header per item in</TD></TR><TR><TD CLASS="l">593</TD><TD>        // addition to the actual items.</TD></TR><TR CLASS="z"><TD CLASS="l">594</TD><TD>        int count = (displaySections) ? sectionKeys.size() : 0;</TD></TR><TR CLASS="z"><TD CLASS="l">595</TD><TD>        for (List&lt;T&gt; section : graphObjectsBySection.values()) {</TD></TR><TR CLASS="z"><TD CLASS="l">596</TD><TD>            count += section.size();</TD></TR><TR CLASS="z"><TD CLASS="l">597</TD><TD>        }</TD></TR><TR><TD CLASS="l">598</TD><TD> </TD></TR><TR><TD CLASS="l">599</TD><TD>        // If we should show a cell with an activity circle indicating more data is coming, add it to the count.</TD></TR><TR CLASS="z"><TD CLASS="l">600</TD><TD>        if (shouldShowActivityCircleCell()) {</TD></TR><TR CLASS="z"><TD CLASS="l">601</TD><TD>            ++count;</TD></TR><TR><TD CLASS="l">602</TD><TD>        }</TD></TR><TR><TD CLASS="l">603</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">604</TD><TD>        return count;</TD></TR><TR><TD CLASS="l"><A NAME="6">605</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">606</TD><TD> </TD></TR><TR><TD CLASS="l">607</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">608</TD><TD>    public boolean areAllItemsEnabled() {</TD></TR><TR CLASS="z"><TD CLASS="l">609</TD><TD>        return displaySections;</TD></TR><TR><TD CLASS="l"><A NAME="2c">610</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">611</TD><TD> </TD></TR><TR><TD CLASS="l">612</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">613</TD><TD>    public boolean hasStableIds() {</TD></TR><TR CLASS="z"><TD CLASS="l">614</TD><TD>        return true;</TD></TR><TR><TD CLASS="l"><A NAME="2e">615</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">616</TD><TD> </TD></TR><TR><TD CLASS="l">617</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">618</TD><TD>    public boolean isEnabled(int position) {</TD></TR><TR CLASS="z"><TD CLASS="l">619</TD><TD>        SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(position);</TD></TR><TR CLASS="z"><TD CLASS="l">620</TD><TD>        return sectionAndItem.getType() == SectionAndItem.Type.GRAPH_OBJECT;</TD></TR><TR><TD CLASS="l"><A NAME="18">621</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">622</TD><TD> </TD></TR><TR><TD CLASS="l">623</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">624</TD><TD>    public Object getItem(int position) {</TD></TR><TR CLASS="z"><TD CLASS="l">625</TD><TD>        SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(position);</TD></TR><TR CLASS="z"><TD CLASS="l">626</TD><TD>        return (sectionAndItem.getType() == SectionAndItem.Type.GRAPH_OBJECT) ? sectionAndItem.graphObject : null;</TD></TR><TR><TD CLASS="l">627</TD><TD>    }</TD></TR><TR><TD CLASS="l">628</TD><TD> </TD></TR><TR><TD CLASS="l">629</TD><TD>    @Override</TD></TR><TR><TD CLASS="l"><A NAME="19">630</A></TD><TD>    public long getItemId(int position) {</TD></TR><TR><TD CLASS="l">631</TD><TD>        // We assume IDs that can be converted to longs. If this is not the case for certain types of</TD></TR><TR><TD CLASS="l">632</TD><TD>        // GraphObjects, subclasses should override this to return, e.g., position, and override hasStableIds</TD></TR><TR><TD CLASS="l">633</TD><TD>        // to return false.</TD></TR><TR CLASS="z"><TD CLASS="l">634</TD><TD>        SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(position);</TD></TR><TR CLASS="z"><TD CLASS="l">635</TD><TD>        if (sectionAndItem != null &amp;&amp; sectionAndItem.graphObject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">636</TD><TD>            String id = getIdOfGraphObject(sectionAndItem.graphObject);</TD></TR><TR CLASS="z"><TD CLASS="l">637</TD><TD>            if (id != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">638</TD><TD>                return Long.parseLong(id);</TD></TR><TR><TD CLASS="l">639</TD><TD>            }</TD></TR><TR><TD CLASS="l">640</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">641</TD><TD>        return 0;</TD></TR><TR><TD CLASS="l"><A NAME="2b">642</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">643</TD><TD> </TD></TR><TR><TD CLASS="l">644</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">645</TD><TD>    public int getViewTypeCount() {</TD></TR><TR CLASS="z"><TD CLASS="l">646</TD><TD>        return 3;</TD></TR><TR><TD CLASS="l"><A NAME="1a">647</A></TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="44">648</A></TD><TD> </TD></TR><TR><TD CLASS="l">649</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">650</TD><TD>    public int getItemViewType(int position) {</TD></TR><TR CLASS="z"><TD CLASS="l">651</TD><TD>        SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(position);</TD></TR><TR CLASS="z"><TD CLASS="l">652</TD><TD>        switch (sectionAndItem.getType()) {</TD></TR><TR><TD CLASS="l">653</TD><TD>            case SECTION_HEADER:</TD></TR><TR CLASS="z"><TD CLASS="l">654</TD><TD>                return HEADER_VIEW_TYPE;</TD></TR><TR><TD CLASS="l">655</TD><TD>            case GRAPH_OBJECT:</TD></TR><TR CLASS="z"><TD CLASS="l">656</TD><TD>                return GRAPH_OBJECT_VIEW_TYPE;</TD></TR><TR><TD CLASS="l">657</TD><TD>            case ACTIVITY_CIRCLE:</TD></TR><TR CLASS="z"><TD CLASS="l">658</TD><TD>                return ACTIVITY_CIRCLE_VIEW_TYPE;</TD></TR><TR><TD CLASS="l">659</TD><TD>            default:</TD></TR><TR CLASS="z"><TD CLASS="l">660</TD><TD>                throw new FacebookException(&#34;Unexpected type of section and item.&#34;);</TD></TR><TR><TD CLASS="l">661</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="2a">662</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">663</TD><TD> </TD></TR><TR><TD CLASS="l">664</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">665</TD><TD>    public View getView(int position, View convertView, ViewGroup parent) {</TD></TR><TR CLASS="z"><TD CLASS="l">666</TD><TD>        SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(position);</TD></TR><TR><TD CLASS="l">667</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">668</TD><TD>        switch (sectionAndItem.getType()) {</TD></TR><TR><TD CLASS="l">669</TD><TD>            case SECTION_HEADER:</TD></TR><TR CLASS="z"><TD CLASS="l">670</TD><TD>                return getSectionHeaderView(sectionAndItem.sectionKey, convertView, parent);</TD></TR><TR><TD CLASS="l">671</TD><TD>            case GRAPH_OBJECT:</TD></TR><TR CLASS="z"><TD CLASS="l">672</TD><TD>                return getGraphObjectView(sectionAndItem.graphObject, convertView, parent);</TD></TR><TR><TD CLASS="l">673</TD><TD>            case ACTIVITY_CIRCLE:</TD></TR><TR><TD CLASS="l">674</TD><TD>                // If we get a request for this view, it means we need more data.</TD></TR><TR CLASS="z"><TD CLASS="l">675</TD><TD>                assert cursor.areMoreObjectsAvailable() &amp;&amp; (dataNeededListener != null);</TD></TR><TR CLASS="z"><TD CLASS="l">676</TD><TD>                dataNeededListener.onDataNeeded();</TD></TR><TR CLASS="z"><TD CLASS="l">677</TD><TD>                return getActivityCircleView(convertView, parent);</TD></TR><TR><TD CLASS="l">678</TD><TD>            default:</TD></TR><TR CLASS="z"><TD CLASS="l">679</TD><TD>                throw new FacebookException(&#34;Unexpected type of section and item.&#34;);</TD></TR><TR><TD CLASS="l">680</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="24">681</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">682</TD><TD> </TD></TR><TR><TD CLASS="l">683</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">684</TD><TD>    public Object[] getSections() {</TD></TR><TR CLASS="z"><TD CLASS="l">685</TD><TD>        if (displaySections) {</TD></TR><TR CLASS="z"><TD CLASS="l">686</TD><TD>            return sectionKeys.toArray();</TD></TR><TR><TD CLASS="l">687</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">688</TD><TD>            return new Object[0];</TD></TR><TR><TD CLASS="l">689</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="1f">690</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">691</TD><TD> </TD></TR><TR><TD CLASS="l">692</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">693</TD><TD>    public int getPositionForSection(int section) {</TD></TR><TR CLASS="z"><TD CLASS="l">694</TD><TD>        if (displaySections) {</TD></TR><TR CLASS="z"><TD CLASS="l">695</TD><TD>            section = Math.max(0, Math.min(section, sectionKeys.size() - 1));</TD></TR><TR CLASS="z"><TD CLASS="l">696</TD><TD>            if (section &lt; sectionKeys.size()) {</TD></TR><TR CLASS="z"><TD CLASS="l">697</TD><TD>                return getPosition(sectionKeys.get(section), null);</TD></TR><TR><TD CLASS="l">698</TD><TD>            }</TD></TR><TR><TD CLASS="l">699</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">700</TD><TD>        return 0;</TD></TR><TR><TD CLASS="l"><A NAME="21">701</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">702</TD><TD> </TD></TR><TR><TD CLASS="l">703</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">704</TD><TD>    public int getSectionForPosition(int position) {</TD></TR><TR CLASS="z"><TD CLASS="l">705</TD><TD>        SectionAndItem&lt;T&gt; sectionAndItem = getSectionAndItem(position);</TD></TR><TR CLASS="z"><TD CLASS="l">706</TD><TD>        if (sectionAndItem != null &amp;&amp;</TD></TR><TR><TD CLASS="l">707</TD><TD>                sectionAndItem.getType() != SectionAndItem.Type.ACTIVITY_CIRCLE) {</TD></TR><TR CLASS="z"><TD CLASS="l">708</TD><TD>            return Math.max(0, Math.min(sectionKeys.indexOf(sectionAndItem.sectionKey), sectionKeys.size() - 1));</TD></TR><TR><TD CLASS="l">709</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="15">710</A></TD><TD>        return 0;</TD></TR><TR><TD CLASS="l">711</TD><TD>    }</TD></TR><TR><TD CLASS="l">712</TD><TD> </TD></TR><TR><TD CLASS="l">713</TD><TD>    public List&lt;T&gt; getGraphObjectsById(Collection&lt;String&gt; ids) {</TD></TR><TR CLASS="z"><TD CLASS="l">714</TD><TD>        Set&lt;String&gt; idSet = new HashSet&lt;String&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">715</TD><TD>        idSet.addAll(ids);</TD></TR><TR><TD CLASS="l">716</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">717</TD><TD>        ArrayList&lt;T&gt; result = new ArrayList&lt;T&gt;(idSet.size());</TD></TR><TR CLASS="z"><TD CLASS="l">718</TD><TD>        for (String id : idSet) {</TD></TR><TR CLASS="z"><TD CLASS="l">719</TD><TD>            T graphObject = graphObjectsById.get(id);</TD></TR><TR CLASS="z"><TD CLASS="l">720</TD><TD>            if (graphObject != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">721</TD><TD>                result.add(graphObject);</TD></TR><TR><TD CLASS="l">722</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">723</TD><TD>        }</TD></TR><TR><TD CLASS="l">724</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b">725</A></TD><TD>        return result;</TD></TR><TR><TD CLASS="l">726</TD><TD>    }</TD></TR><TR><TD CLASS="l">727</TD><TD> </TD></TR><TR><TD CLASS="l">728</TD><TD>    private void downloadProfilePicture(final String profileId, URI pictureURI, final ImageView imageView) {</TD></TR><TR CLASS="z"><TD CLASS="l">729</TD><TD>        if (pictureURI == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">730</TD><TD>            return;</TD></TR><TR><TD CLASS="l">731</TD><TD>        }</TD></TR><TR><TD CLASS="l">732</TD><TD> </TD></TR><TR><TD CLASS="l">733</TD><TD>        // If we don't have an imageView, we are pre-fetching this image to store in-memory because we</TD></TR><TR><TD CLASS="l">734</TD><TD>        // think the user might scroll to its corresponding list row. If we do have an imageView, we</TD></TR><TR><TD CLASS="l">735</TD><TD>        // only want to queue a download if the view's tag isn't already set to the URL (which would mean</TD></TR><TR><TD CLASS="l">736</TD><TD>        // it's already got the correct picture).</TD></TR><TR CLASS="z"><TD CLASS="l">737</TD><TD>        boolean prefetching = imageView == null;</TD></TR><TR CLASS="z"><TD CLASS="l">738</TD><TD>        if (prefetching || !pictureURI.equals(imageView.getTag())) {</TD></TR><TR CLASS="z"><TD CLASS="l">739</TD><TD>            if (!prefetching) {</TD></TR><TR><TD CLASS="l">740</TD><TD>                // Setting the tag to the profile ID indicates that we're currently downloading the</TD></TR><TR><TD CLASS="l">741</TD><TD>                // picture for this profile; we'll set it to the actual picture URL when complete.</TD></TR><TR CLASS="z"><TD CLASS="l">742</TD><TD>                imageView.setTag(profileId);</TD></TR><TR CLASS="z"><TD CLASS="l">743</TD><TD>                imageView.setImageResource(getDefaultPicture());</TD></TR><TR><TD CLASS="l">744</TD><TD>            }</TD></TR><TR><TD CLASS="l"><A NAME="41">745</A></TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">746</TD><TD>            ImageRequest.Builder builder = new ImageRequest.Builder(context.getApplicationContext(), pictureURI)</TD></TR><TR><TD CLASS="l">747</TD><TD>                    .setCallerTag(this)</TD></TR><TR><TD CLASS="l"><A NAME="43">748</A></TD><TD>                    .setCallback(</TD></TR><TR CLASS="z"><TD CLASS="l">749</TD><TD>                            new ImageRequest.Callback() {</TD></TR><TR><TD CLASS="l">750</TD><TD>                                @Override</TD></TR><TR><TD CLASS="l">751</TD><TD>                                public void onCompleted(ImageResponse response) {</TD></TR><TR CLASS="z"><TD CLASS="l">752</TD><TD>                                    processImageResponse(response, profileId, imageView);</TD></TR><TR CLASS="z"><TD CLASS="l">753</TD><TD>                                }</TD></TR><TR><TD CLASS="l">754</TD><TD>                            });</TD></TR><TR><TD CLASS="l">755</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">756</TD><TD>            ImageRequest newRequest = builder.build();</TD></TR><TR CLASS="z"><TD CLASS="l">757</TD><TD>            pendingRequests.put(profileId, newRequest);</TD></TR><TR><TD CLASS="l">758</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">759</TD><TD>            ImageDownloader.downloadAsync(newRequest);</TD></TR><TR><TD CLASS="l"><A NAME="7">760</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">761</TD><TD>    }</TD></TR><TR><TD CLASS="l">762</TD><TD> </TD></TR><TR><TD CLASS="l">763</TD><TD>    private void callOnErrorListener(Exception exception) {</TD></TR><TR CLASS="z"><TD CLASS="l">764</TD><TD>        if (onErrorListener != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">765</TD><TD>            if (!(exception instanceof FacebookException)) {</TD></TR><TR CLASS="z"><TD CLASS="l">766</TD><TD>                exception = new FacebookException(exception);</TD></TR><TR><TD CLASS="l">767</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">768</TD><TD>            onErrorListener.onError(this, (FacebookException) exception);</TD></TR><TR><TD CLASS="l"><A NAME="32">769</A></TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">770</TD><TD>    }</TD></TR><TR><TD CLASS="l">771</TD><TD> </TD></TR><TR><TD CLASS="l">772</TD><TD>    private void processImageResponse(ImageResponse response, String graphObjectId, ImageView imageView) {</TD></TR><TR CLASS="z"><TD CLASS="l">773</TD><TD>        pendingRequests.remove(graphObjectId);</TD></TR><TR CLASS="z"><TD CLASS="l">774</TD><TD>        if (response.getError() != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">775</TD><TD>            callOnErrorListener(response.getError());</TD></TR><TR><TD CLASS="l">776</TD><TD>        }</TD></TR><TR><TD CLASS="l">777</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">778</TD><TD>        if (imageView == null) {</TD></TR><TR><TD CLASS="l">779</TD><TD>            // This was a pre-fetch request.</TD></TR><TR CLASS="z"><TD CLASS="l">780</TD><TD>            if (response.getBitmap() != null) {</TD></TR><TR><TD CLASS="l">781</TD><TD>                // Is the cache too big?</TD></TR><TR CLASS="z"><TD CLASS="l">782</TD><TD>                if (prefetchedPictureCache.size() &gt;= MAX_PREFETCHED_PICTURES) {</TD></TR><TR><TD CLASS="l">783</TD><TD>                    // Find the oldest one and remove it.</TD></TR><TR CLASS="z"><TD CLASS="l">784</TD><TD>                    String oldestId = prefetchedProfilePictureIds.remove(0);</TD></TR><TR CLASS="z"><TD CLASS="l">785</TD><TD>                    prefetchedPictureCache.remove(oldestId);</TD></TR><TR><TD CLASS="l">786</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">787</TD><TD>                prefetchedPictureCache.put(graphObjectId, response);</TD></TR><TR><TD CLASS="l">788</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">789</TD><TD>        } else if (graphObjectId.equals(imageView.getTag())) {</TD></TR><TR CLASS="z"><TD CLASS="l">790</TD><TD>            Exception error = response.getError();</TD></TR><TR CLASS="z"><TD CLASS="l">791</TD><TD>            Bitmap bitmap = response.getBitmap();</TD></TR><TR CLASS="z"><TD CLASS="l">792</TD><TD>            if (error == null &amp;&amp; bitmap != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">793</TD><TD>                imageView.setImageBitmap(bitmap);</TD></TR><TR CLASS="z"><TD CLASS="l">794</TD><TD>                imageView.setTag(response.getRequest().getImageUri());</TD></TR><TR><TD CLASS="l">795</TD><TD>            }</TD></TR><TR><TD CLASS="l">796</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="9">797</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">798</TD><TD> </TD></TR><TR><TD CLASS="l">799</TD><TD>    private static int compareGraphObjects(GraphObject a, GraphObject b, Collection&lt;String&gt; sortFields,</TD></TR><TR><TD CLASS="l">800</TD><TD>            Collator collator) {</TD></TR><TR CLASS="z"><TD CLASS="l">801</TD><TD>        for (String sortField : sortFields) {</TD></TR><TR CLASS="z"><TD CLASS="l">802</TD><TD>            String sa = (String) a.getProperty(sortField);</TD></TR><TR CLASS="z"><TD CLASS="l">803</TD><TD>            String sb = (String) b.getProperty(sortField);</TD></TR><TR><TD CLASS="l">804</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">805</TD><TD>            if (sa != null &amp;&amp; sb != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">806</TD><TD>                int result = collator.compare(sa, sb);</TD></TR><TR CLASS="z"><TD CLASS="l">807</TD><TD>                if (result != 0) {</TD></TR><TR CLASS="z"><TD CLASS="l">808</TD><TD>                    return result;</TD></TR><TR><TD CLASS="l">809</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">810</TD><TD>            } else if (!(sa == null &amp;&amp; sb == null)) {</TD></TR><TR CLASS="z"><TD CLASS="l">811</TD><TD>                return (sa == null) ? -1 : 1;</TD></TR><TR><TD CLASS="l">812</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">813</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">814</TD><TD>        return 0;</TD></TR><TR><TD CLASS="l">815</TD><TD>    }</TD></TR><TR><TD CLASS="l">816</TD><TD> </TD></TR><TR><TD CLASS="l">817</TD><TD> </TD></TR><TR><TD CLASS="l">818</TD><TD>    // Graph object type to navigate the JSON that sometimes comes back instead of a URL string</TD></TR><TR><TD CLASS="l">819</TD><TD>    private interface ItemPicture extends GraphObject {</TD></TR><TR><TD CLASS="l">820</TD><TD>        ItemPictureData getData();</TD></TR><TR><TD CLASS="l">821</TD><TD>    }</TD></TR><TR><TD CLASS="l">822</TD><TD> </TD></TR><TR><TD CLASS="l">823</TD><TD>    // Graph object type to navigate the JSON that sometimes comes back instead of a URL string</TD></TR><TR><TD CLASS="l">824</TD><TD>    private interface ItemPictureData extends GraphObject {</TD></TR><TR><TD CLASS="l">825</TD><TD>        String getUrl();</TD></TR><TR><TD CLASS="l">826</TD><TD>    }</TD></TR><TR><TD CLASS="l">827</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="3.html">com.facebook.widget</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>